
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>æ‰©å±•/åµŒå…¥å¸¸è§é—®é¢˜ &#8212; Python 3.7.3 æ–‡æ¡£</title>
    <link rel="stylesheet" href="pydoctheme.css" tppabs="https://docs.python.org/zh-cn/3/_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="pygments.css" tppabs="https://docs.python.org/zh-cn/3/_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="documentation_options.js" tppabs="https://docs.python.org/zh-cn/3/_static/documentation_options.js"></script>
    <script type="text/javascript" src="jquery.js" tppabs="https://docs.python.org/zh-cn/3/_static/jquery.js"></script>
    <script type="text/javascript" src="underscore.js" tppabs="https://docs.python.org/zh-cn/3/_static/underscore.js"></script>
    <script type="text/javascript" src="doctools.js" tppabs="https://docs.python.org/zh-cn/3/_static/doctools.js"></script>
    <script type="text/javascript" src="language_data.js" tppabs="https://docs.python.org/zh-cn/3/_static/language_data.js"></script>
    <script type="text/javascript" src="translations.js" tppabs="https://docs.python.org/zh-cn/3/_static/translations.js"></script>
    
    <script type="text/javascript" src="sidebar.js" tppabs="https://docs.python.org/zh-cn/3/_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="åœ¨ Python 3.7.3 æ–‡æ¡£ ä¸­æœç´¢"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="å…³äºè¿™äº›æ–‡æ¡£" href="../about.html" />
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æœç´¢" href="../search.html" />
    <link rel="copyright" title="ç‰ˆæƒæ‰€æœ‰" href="../copyright.html" />
    <link rel="next" title="Pythonåœ¨Windowsä¸Šçš„å¸¸è§é—®é¢˜" href="windows.html" />
    <link rel="prev" title="ä»£ç åº“å’Œæ’ä»¶ FAQ" href="library.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <link rel="canonical" href="https://docs.python.org/3/faq/extending.html" />
    
    <script type="text/javascript" src="copybutton.js" tppabs="https://docs.python.org/zh-cn/3/_static/copybutton.js"></script>
    <script type="text/javascript" src="switchers.js" tppabs="https://docs.python.org/zh-cn/3/_static/switchers.js"></script>
    
    
    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
 

  </head><body>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             accesskey="I">ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="windows-3.html" tppabs="https://docs.python.org/zh-cn/3/faq/windows.html" title="Pythonåœ¨Windowsä¸Šçš„å¸¸è§é—®é¢˜"
             accesskey="N">ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="library.html" tppabs="https://docs.python.org/zh-cn/3/faq/library.html" title="ä»£ç åº“å’Œæ’ä»¶ FAQ"
             accesskey="P">ä¸Šä¸€é¡µ</a> |</li>
        <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="language_switcher_placeholder">zh_CN</span>
          <span class="version_switcher_placeholder">3.7.3</span>
          <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index-10.html" tppabs="https://docs.python.org/zh-cn/3/faq/index.html" accesskey="U">Python å¸¸è§é—®é¢˜</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="extending-embedding-faq">
<h1><a class="toc-backref" href="#id3">æ‰©å±•/åµŒå…¥å¸¸è§é—®é¢˜</a><a class="headerlink" href="#extending-embedding-faq" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h1>
<div class="contents topic" id="id1">
<p class="topic-title first">ç›®å½•</p>
<ul class="simple">
<li><a class="reference internal" href="#extending-embedding-faq" id="id3">æ‰©å±•/åµŒå…¥å¸¸è§é—®é¢˜</a><ul>
<li><a class="reference internal" href="#can-i-create-my-own-functions-in-c" id="id4">å¯ä»¥ä½¿ç”¨Cè¯­è¨€ä¸­åˆ›å»ºè‡ªå·±çš„å‡½æ•°å—ï¼Ÿ</a></li>
<li><a class="reference internal" href="#id2" id="id5">å¯ä»¥ä½¿ç”¨C++è¯­è¨€ä¸­åˆ›å»ºè‡ªå·±çš„å‡½æ•°å—ï¼Ÿ</a></li>
<li><a class="reference internal" href="#writing-c-is-hard-are-there-any-alternatives" id="id6">Cå¾ˆéš¾å†™ï¼Œæœ‰æ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-can-i-execute-arbitrary-python-statements-from-c" id="id7">å¦‚ä½•ä»Cæ‰§è¡Œä»»æ„Pythonè¯­å¥ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-can-i-evaluate-an-arbitrary-python-expression-from-c" id="id8">å¦‚ä½•ä»Cä¸­è¯„ä¼°ä»»æ„Pythonè¡¨è¾¾å¼ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-extract-c-values-from-a-python-object" id="id9">å¦‚ä½•ä»Pythonå¯¹è±¡ä¸­æå–Cçš„å€¼ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-use-py-buildvalue-to-create-a-tuple-of-arbitrary-length" id="id10">å¦‚ä½•ä½¿ç”¨Py_BuildValue()åˆ›å»ºä»»æ„é•¿åº¦çš„å…ƒç»„ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-call-an-object-s-method-from-c" id="id11">å¦‚ä½•ä»Cè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-catch-the-output-from-pyerr-print-or-anything-that-prints-to-stdout-stderr" id="id12">å¦‚ä½•æ•è·PyErr_Print()ï¼ˆæˆ–æ‰“å°åˆ°stdout / stderrçš„ä»»ä½•å†…å®¹ï¼‰çš„è¾“å‡ºï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-access-a-module-written-in-python-from-c" id="id13">å¦‚ä½•ä»Cè®¿é—®ç”¨Pythonç¼–å†™çš„æ¨¡å—ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-interface-to-c-objects-from-python" id="id14">å¦‚ä½•ä»Pythonæ¥å£åˆ°C ++å¯¹è±¡ï¼Ÿ</a></li>
<li><a class="reference internal" href="#i-added-a-module-using-the-setup-file-and-the-make-fails-why" id="id15">æˆ‘ä½¿ç”¨Setupæ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªæ¨¡å—ï¼Œä¸ºä»€ä¹ˆmakeå¤±è´¥äº†ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-debug-an-extension" id="id16">å¦‚ä½•è°ƒè¯•æ‰©å±•ï¼Ÿ</a></li>
<li><a class="reference internal" href="#i-want-to-compile-a-python-module-on-my-linux-system-but-some-files-are-missing-why" id="id17">æˆ‘æƒ³åœ¨Linuxç³»ç»Ÿä¸Šç¼–è¯‘ä¸€ä¸ªPythonæ¨¡å—ï¼Œä½†æ˜¯ç¼ºå°‘ä¸€äº›æ–‡ä»¶ã€‚ä¸ºä»€ä¹ˆ?</a></li>
<li><a class="reference internal" href="#how-do-i-tell-incomplete-input-from-invalid-input" id="id18">å¦‚ä½•åŒºåˆ†â€œè¾“å…¥ä¸å®Œæ•´â€å’Œâ€œè¾“å…¥æ— æ•ˆâ€ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-find-undefined-g-symbols-builtin-new-or-pure-virtual" id="id19">å¦‚ä½•æ‰¾åˆ°æœªå®šä¹‰çš„g++ç¬¦å·__builtin_newæˆ–__pure_virtualï¼Ÿ</a></li>
<li><a class="reference internal" href="#can-i-create-an-object-class-with-some-methods-implemented-in-c-and-others-in-python-e-g-through-inheritance" id="id20">èƒ½å¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç±»ï¼Œå…¶ä¸­éƒ¨åˆ†æ–¹æ³•åœ¨Cä¸­å®ç°ï¼Œè€Œå…¶ä»–æ–¹æ³•åœ¨Pythonä¸­å®ç°ï¼ˆä¾‹å¦‚é€šè¿‡ç»§æ‰¿ï¼‰ï¼Ÿ</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="can-i-create-my-own-functions-in-c">
<h2><a class="toc-backref" href="#id4">å¯ä»¥ä½¿ç”¨Cè¯­è¨€ä¸­åˆ›å»ºè‡ªå·±çš„å‡½æ•°å—ï¼Ÿ</a><a class="headerlink" href="#can-i-create-my-own-functions-in-c" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>æ˜¯çš„ï¼Œæ‚¨å¯ä»¥åœ¨Cä¸­åˆ›å»ºåŒ…å«å‡½æ•°ã€å˜é‡ã€å¼‚å¸¸ç”šè‡³æ–°ç±»å‹çš„å†…ç½®æ¨¡å—ã€‚åœ¨æ–‡æ¡£ <a class="reference internal" href="index-8.html#extending-index" tppabs="https://docs.python.org/zh-cn/3/extending/index.html#extending-index"><span class="std std-ref">æ‰©å±•å’ŒåµŒå…¥ Python è§£é‡Šå™¨</span></a> ä¸­æœ‰è¯´æ˜ã€‚</p>
<p>å¤§å¤šæ•°ä¸­çº§æˆ–é«˜çº§çš„Pythonä¹¦ç±ä¹Ÿæ¶µç›–è¿™ä¸ªä¸»é¢˜ã€‚</p>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id5">å¯ä»¥ä½¿ç”¨C++è¯­è¨€ä¸­åˆ›å»ºè‡ªå·±çš„å‡½æ•°å—ï¼Ÿ</a><a class="headerlink" href="#id2" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>æ˜¯çš„ï¼Œå¯ä»¥ä½¿ç”¨C ++ä¸­å…¼å®¹Cçš„åŠŸèƒ½ã€‚ åœ¨Python includeæ–‡ä»¶å‘¨å›´æ”¾ç½®` <cite>externâ€œCâ€{...}`</cite> ï¼Œå¹¶åœ¨Pythonè§£é‡Šå™¨è°ƒç”¨çš„æ¯ä¸ªå‡½æ•°ä¹‹å‰æ”¾ç½® <code class="docutils literal notranslate"><span class="pre">externâ€œCâ€</span></code> ã€‚ å…·æœ‰æ„é€ å‡½æ•°çš„å…¨å±€æˆ–é™æ€C ++å¯¹è±¡å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p>
</div>
<div class="section" id="writing-c-is-hard-are-there-any-alternatives">
<span id="c-wrapper-software"></span><h2><a class="toc-backref" href="#id6">Cå¾ˆéš¾å†™ï¼Œæœ‰æ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Ÿ</a><a class="headerlink" href="#writing-c-is-hard-are-there-any-alternatives" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>ç¼–å†™è‡ªå·±çš„Cæ‰©å±•æœ‰å¾ˆå¤šé€‰æ‹©ï¼Œå…·ä½“å–å†³äºæ‚¨è¦åšçš„äº‹æƒ…ã€‚</p>
<p><a class="reference external" href="javascript:if(confirm('http://cython.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://cython.org/'" tppabs="http://cython.org/">Cython</a> åŠå…¶ç›¸å…³çš„ <a class="reference external" href="javascript:if(confirm('https://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/'" tppabs="https://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/">Pyrex</a> æ˜¯æ¥å—ç¨å¾®ä¿®æ”¹è¿‡çš„Pythonå½¢å¼å¹¶ç”Ÿæˆç›¸åº”Cä»£ç çš„ç¼–è¯‘å™¨ã€‚ Cythonå’ŒPyrexå¯ä»¥ç¼–å†™æ‰©å±•è€Œæ— éœ€å­¦ä¹ Pythonçš„C APIã€‚</p>
<p>å¦‚æœéœ€è¦è¿æ¥åˆ°æŸäº›å½“å‰ä¸å­˜åœ¨Pythonæ‰©å±•çš„Cæˆ–C ++åº“ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ <a class="reference external" href="javascript:if(confirm('http://www.swig.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.swig.org/'" tppabs="http://www.swig.org/">SWIG</a> ç­‰å·¥å…·åŒ…è£…åº“çš„æ•°æ®ç±»å‹å’Œå‡½æ•°ã€‚  <a class="reference external" href="javascript:if(confirm('https://riverbankcomputing.com/software/sip/intro  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://riverbankcomputing.com/software/sip/intro'" tppabs="https://riverbankcomputing.com/software/sip/intro">SIP</a> ï¼Œ <a class="reference external" href="javascript:if(confirm('http://cxx.sourceforge.net/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://cxx.sourceforge.net/'" tppabs="http://cxx.sourceforge.net/">CXX</a> <a class="reference external" href="javascript:if(confirm('http://www.boost.org/libs/python/doc/index.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.boost.org/libs/python/doc/index.html'" tppabs="http://www.boost.org/libs/python/doc/index.html">Boost</a> , æˆ– <a class="reference external" href="javascript:if(confirm('https://github.com/scipy/issue24870  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/scipy/issue24870'" tppabs="https://github.com/scipy/weave">Weave</a> ä¹Ÿæ˜¯åŒ…è£…C ++åº“çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>
</div>
<div class="section" id="how-can-i-execute-arbitrary-python-statements-from-c">
<h2><a class="toc-backref" href="#id7">å¦‚ä½•ä»Cæ‰§è¡Œä»»æ„Pythonè¯­å¥ï¼Ÿ</a><a class="headerlink" href="#how-can-i-execute-arbitrary-python-statements-from-c" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>The highest-level function to do this is <a class="reference internal" href="veryhigh.html#c.PyRun_SimpleString" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyRun_SimpleString" title="PyRun_SimpleString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRun_SimpleString()</span></code></a> which takes
a single string argument to be executed in the context of the module
<code class="docutils literal notranslate"><span class="pre">__main__</span></code> and returns <code class="docutils literal notranslate"><span class="pre">0</span></code> for success and <code class="docutils literal notranslate"><span class="pre">-1</span></code> when an exception occurred
(including <a class="reference internal" href="exceptions.html#SyntaxError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a>).  If you want more control, use
<a class="reference internal" href="veryhigh.html#c.PyRun_String" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyRun_String" title="PyRun_String"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRun_String()</span></code></a>; see the source for <a class="reference internal" href="veryhigh.html#c.PyRun_SimpleString" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyRun_SimpleString" title="PyRun_SimpleString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRun_SimpleString()</span></code></a> in
<code class="docutils literal notranslate"><span class="pre">Python/pythonrun.c</span></code>.</p>
</div>
<div class="section" id="how-can-i-evaluate-an-arbitrary-python-expression-from-c">
<h2><a class="toc-backref" href="#id8">å¦‚ä½•ä»Cä¸­è¯„ä¼°ä»»æ„Pythonè¡¨è¾¾å¼ï¼Ÿ</a><a class="headerlink" href="#how-can-i-evaluate-an-arbitrary-python-expression-from-c" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>Call the function <a class="reference internal" href="veryhigh.html#c.PyRun_String" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyRun_String" title="PyRun_String"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRun_String()</span></code></a> from the previous question with the
start symbol <a class="reference internal" href="veryhigh.html#c.Py_eval_input" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.Py_eval_input" title="Py_eval_input"><code class="xref c c-data docutils literal notranslate"><span class="pre">Py_eval_input</span></code></a>; it parses an expression, evaluates it and
returns its value.</p>
</div>
<div class="section" id="how-do-i-extract-c-values-from-a-python-object">
<h2><a class="toc-backref" href="#id9">å¦‚ä½•ä»Pythonå¯¹è±¡ä¸­æå–Cçš„å€¼ï¼Ÿ</a><a class="headerlink" href="#how-do-i-extract-c-values-from-a-python-object" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>That depends on the object's type.  If it's a tuple, <a class="reference internal" href="tuple.html#c.PyTuple_Size" tppabs="https://docs.python.org/zh-cn/3/c-api/tuple.html#c.PyTuple_Size" title="PyTuple_Size"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTuple_Size()</span></code></a>
returns its length and <a class="reference internal" href="tuple.html#c.PyTuple_GetItem" tppabs="https://docs.python.org/zh-cn/3/c-api/tuple.html#c.PyTuple_GetItem" title="PyTuple_GetItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTuple_GetItem()</span></code></a> returns the item at a specified
index.  Lists have similar functions, <code class="xref c c-func docutils literal notranslate"><span class="pre">PyListSize()</span></code> and
<a class="reference internal" href="list.html#c.PyList_GetItem" tppabs="https://docs.python.org/zh-cn/3/c-api/list.html#c.PyList_GetItem" title="PyList_GetItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_GetItem()</span></code></a>.</p>
<p>For bytes, <a class="reference internal" href="bytes.html#c.PyBytes_Size" tppabs="https://docs.python.org/zh-cn/3/c-api/bytes.html#c.PyBytes_Size" title="PyBytes_Size"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBytes_Size()</span></code></a> returns its length and
<a class="reference internal" href="bytes.html#c.PyBytes_AsStringAndSize" tppabs="https://docs.python.org/zh-cn/3/c-api/bytes.html#c.PyBytes_AsStringAndSize" title="PyBytes_AsStringAndSize"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBytes_AsStringAndSize()</span></code></a> provides a pointer to its value and its
length.  Note that Python bytes objects may contain null bytes so C's
<code class="xref c c-func docutils literal notranslate"><span class="pre">strlen()</span></code> should not be used.</p>
<p>è¦æµ‹è¯•å¯¹è±¡çš„ç±»å‹ï¼Œé¦–å…ˆè¦ç¡®ä¿å®ƒä¸æ˜¯ <em>NULL</em> ï¼Œç„¶åä½¿ç”¨ <a class="reference internal" href="bytes.html#c.PyBytes_Check" tppabs="https://docs.python.org/zh-cn/3/c-api/bytes.html#c.PyBytes_Check" title="PyBytes_Check"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBytes_Check()</span></code></a> , <a class="reference internal" href="tuple.html#c.PyTuple_Check" tppabs="https://docs.python.org/zh-cn/3/c-api/tuple.html#c.PyTuple_Check" title="PyTuple_Check"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTuple_Check()</span></code></a> ï¼Œ <a class="reference internal" href="list.html#c.PyList_Check" tppabs="https://docs.python.org/zh-cn/3/c-api/list.html#c.PyList_Check" title="PyList_Check"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_Check()</span></code></a> ç­‰</p>
<p>There is also a high-level API to Python objects which is provided by the
so-called 'abstract' interface -- read <code class="docutils literal notranslate"><span class="pre">Include/abstract.h</span></code> for further
details.  It allows interfacing with any kind of Python sequence using calls
like <a class="reference internal" href="sequence.html#c.PySequence_Length" tppabs="https://docs.python.org/zh-cn/3/c-api/sequence.html#c.PySequence_Length" title="PySequence_Length"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySequence_Length()</span></code></a>, <a class="reference internal" href="sequence.html#c.PySequence_GetItem" tppabs="https://docs.python.org/zh-cn/3/c-api/sequence.html#c.PySequence_GetItem" title="PySequence_GetItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySequence_GetItem()</span></code></a>, etc. as well
as many other useful protocols such as numbers (<a class="reference internal" href="number.html#c.PyNumber_Index" tppabs="https://docs.python.org/zh-cn/3/c-api/number.html#c.PyNumber_Index" title="PyNumber_Index"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyNumber_Index()</span></code></a> et
al.) and mappings in the PyMapping APIs.</p>
</div>
<div class="section" id="how-do-i-use-py-buildvalue-to-create-a-tuple-of-arbitrary-length">
<h2><a class="toc-backref" href="#id10">å¦‚ä½•ä½¿ç”¨Py_BuildValue()åˆ›å»ºä»»æ„é•¿åº¦çš„å…ƒç»„ï¼Ÿ</a><a class="headerlink" href="#how-do-i-use-py-buildvalue-to-create-a-tuple-of-arbitrary-length" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>ä¸å¯ä»¥ã€‚åº”è¯¥ä½¿ç”¨ <a class="reference internal" href="tuple.html#c.PyTuple_Pack" tppabs="https://docs.python.org/zh-cn/3/c-api/tuple.html#c.PyTuple_Pack" title="PyTuple_Pack"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTuple_Pack()</span></code></a> ã€‚</p>
</div>
<div class="section" id="how-do-i-call-an-object-s-method-from-c">
<h2><a class="toc-backref" href="#id11">å¦‚ä½•ä»Cè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Ÿ</a><a class="headerlink" href="#how-do-i-call-an-object-s-method-from-c" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>The <a class="reference internal" href="object.html#c.PyObject_CallMethod" tppabs="https://docs.python.org/zh-cn/3/c-api/object.html#c.PyObject_CallMethod" title="PyObject_CallMethod"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CallMethod()</span></code></a> function can be used to call an arbitrary
method of an object.  The parameters are the object, the name of the method to
call, a format string like that used with <a class="reference internal" href="arg.html#c.Py_BuildValue" tppabs="https://docs.python.org/zh-cn/3/c-api/arg.html#c.Py_BuildValue" title="Py_BuildValue"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_BuildValue()</span></code></a>, and the
argument values:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">PyObject</span> <span class="o">*</span>
<span class="nf">PyObject_CallMethod</span><span class="p">(</span><span class="n">PyObject</span> <span class="o">*</span><span class="n">object</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">method_name</span><span class="p">,</span>
                    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">arg_format</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
</div>
<p>This works for any object that has methods -- whether built-in or user-defined.
You are responsible for eventually <a class="reference internal" href="refcounting.html#c.Py_DECREF" tppabs="https://docs.python.org/zh-cn/3/c-api/refcounting.html#c.Py_DECREF" title="Py_DECREF"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_DECREF()</span></code></a>'ing the return value.</p>
<p>To call, e.g., a file object's &quot;seek&quot; method with arguments 10, 0 (assuming the
file object pointer is &quot;f&quot;):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">PyObject_CallMethod</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&quot;seek&quot;</span><span class="p">,</span> <span class="s">&quot;(ii)&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">...</span> <span class="n">an</span> <span class="n">exception</span> <span class="n">occurred</span> <span class="p">...</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
        <span class="n">Py_DECREF</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that since <a class="reference internal" href="object.html#c.PyObject_CallObject" tppabs="https://docs.python.org/zh-cn/3/c-api/object.html#c.PyObject_CallObject" title="PyObject_CallObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CallObject()</span></code></a> <em>always</em> wants a tuple for the
argument list, to call a function without arguments, pass &quot;()&quot; for the format,
and to call a function with one argument, surround the argument in parentheses,
e.g. &quot;(i)&quot;.</p>
</div>
<div class="section" id="how-do-i-catch-the-output-from-pyerr-print-or-anything-that-prints-to-stdout-stderr">
<h2><a class="toc-backref" href="#id12">å¦‚ä½•æ•è·PyErr_Print()ï¼ˆæˆ–æ‰“å°åˆ°stdout / stderrçš„ä»»ä½•å†…å®¹ï¼‰çš„è¾“å‡ºï¼Ÿ</a><a class="headerlink" href="#how-do-i-catch-the-output-from-pyerr-print-or-anything-that-prints-to-stdout-stderr" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>In Python code, define an object that supports the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method.  Assign
this object to <a class="reference internal" href="sys.html#sys.stdout" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#sys.stdout" title="sys.stdout"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stdout</span></code></a> and <a class="reference internal" href="sys.html#sys.stderr" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#sys.stderr" title="sys.stderr"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a>.  Call print_error, or
just allow the standard traceback mechanism to work. Then, the output will go
wherever your <code class="docutils literal notranslate"><span class="pre">write()</span></code> method sends it.</p>
<p>The easiest way to do this is to use the <a class="reference internal" href="io.html#io.StringIO" tppabs="https://docs.python.org/zh-cn/3/library/io.html#io.StringIO" title="io.StringIO"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.StringIO</span></code></a> class:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">io</span><span class="o">,</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;hello world!&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
<span class="go">foo</span>
<span class="go">hello world!</span>
</pre></div>
</div>
<p>A custom object to do the same would look like this:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">io</span><span class="o">,</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">StdoutCatcher</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stuff</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stuff</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">StdoutCatcher</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;hello world!&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="go">foo</span>
<span class="go">hello world!</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-access-a-module-written-in-python-from-c">
<h2><a class="toc-backref" href="#id13">å¦‚ä½•ä»Cè®¿é—®ç”¨Pythonç¼–å†™çš„æ¨¡å—ï¼Ÿ</a><a class="headerlink" href="#how-do-i-access-a-module-written-in-python-from-c" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>You can get a pointer to the module object as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="o">=</span> <span class="n">PyImport_ImportModule</span><span class="p">(</span><span class="s">&quot;&lt;modulename&gt;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>If the module hasn't been imported yet (i.e. it is not yet present in
<a class="reference internal" href="sys.html#sys.modules" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>), this initializes the module; otherwise it simply returns
the value of <code class="docutils literal notranslate"><span class="pre">sys.modules[&quot;&lt;modulename&gt;&quot;]</span></code>.  Note that it doesn't enter the
module into any namespace -- it only ensures it has been initialized and is
stored in <a class="reference internal" href="sys.html#sys.modules" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#sys.modules" title="sys.modules"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.modules</span></code></a>.</p>
<p>You can then access the module's attributes (i.e. any name defined in the
module) as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">attr</span> <span class="o">=</span> <span class="n">PyObject_GetAttrString</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s">&quot;&lt;attrname&gt;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Calling <a class="reference internal" href="object.html#c.PyObject_SetAttrString" tppabs="https://docs.python.org/zh-cn/3/c-api/object.html#c.PyObject_SetAttrString" title="PyObject_SetAttrString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_SetAttrString()</span></code></a> to assign to variables in the module
also works.</p>
</div>
<div class="section" id="how-do-i-interface-to-c-objects-from-python">
<h2><a class="toc-backref" href="#id14">å¦‚ä½•ä»Pythonæ¥å£åˆ°C ++å¯¹è±¡ï¼Ÿ</a><a class="headerlink" href="#how-do-i-interface-to-c-objects-from-python" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>Depending on your requirements, there are many approaches.  To do this manually,
begin by reading <a class="reference internal" href="index-8.html#extending-index" tppabs="https://docs.python.org/zh-cn/3/extending/index.html#extending-index"><span class="std std-ref">the &quot;Extending and Embedding&quot; document</span></a>.  Realize that for the Python run-time system, there isn't a
whole lot of difference between C and C++ -- so the strategy of building a new
Python type around a C structure (pointer) type will also work for C++ objects.</p>
<p>For C++ libraries, see <a class="reference internal" href="#c-wrapper-software"><span class="std std-ref">Cå¾ˆéš¾å†™ï¼Œæœ‰æ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Ÿ</span></a>.</p>
</div>
<div class="section" id="i-added-a-module-using-the-setup-file-and-the-make-fails-why">
<h2><a class="toc-backref" href="#id15">æˆ‘ä½¿ç”¨Setupæ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªæ¨¡å—ï¼Œä¸ºä»€ä¹ˆmakeå¤±è´¥äº†ï¼Ÿ</a><a class="headerlink" href="#i-added-a-module-using-the-setup-file-and-the-make-fails-why" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>å®‰è£…ç¨‹åºå¿…é¡»ä»¥æ¢è¡Œç¬¦ç»“æŸï¼Œå¦‚æœæ²¡æœ‰æ¢è¡Œç¬¦ï¼Œåˆ™æ„å»ºè¿‡ç¨‹å°†å¤±è´¥ã€‚ ï¼ˆä¿®å¤è¿™ä¸ªéœ€è¦ä¸€äº›ä¸‘é™‹çš„shellè„šæœ¬ç¼–ç¨‹ï¼Œè€Œä¸”è¿™ä¸ªbugå¾ˆå°ï¼Œçœ‹èµ·æ¥ä¸å€¼å¾—èŠ±è¿™ä¹ˆå¤§åŠ›æ°”ã€‚)</p>
</div>
<div class="section" id="how-do-i-debug-an-extension">
<h2><a class="toc-backref" href="#id16">å¦‚ä½•è°ƒè¯•æ‰©å±•ï¼Ÿ</a><a class="headerlink" href="#how-do-i-debug-an-extension" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>å°†GDBä¸åŠ¨æ€åŠ è½½çš„æ‰©å±•åä¸€èµ·ä½¿ç”¨æ—¶ï¼Œåœ¨åŠ è½½æ‰©å±•åä¹‹å‰ï¼Œä¸èƒ½åœ¨æ‰©å±•åä¸­è®¾ç½®æ–­ç‚¹ã€‚</p>
<p>åœ¨æ‚¨çš„ <code class="docutils literal notranslate"><span class="pre">.gdbinit</span></code> æ–‡ä»¶ä¸­ï¼ˆæˆ–äº¤äº’å¼ï¼‰æ·»åŠ å‘½ä»¤ï¼š</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>br _PyImport_LoadDynamicModule
</pre></div>
</div>
<p>ç„¶åè¿è¡ŒGDBï¼š</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> gdb /local/bin/python
<span class="go">gdb) run myscript.py</span>
<span class="go">gdb) continue # repeat until your extension is loaded</span>
<span class="go">gdb) finish   # so that your extension is loaded</span>
<span class="go">gdb) br myfunction.c:50</span>
<span class="go">gdb) continue</span>
</pre></div>
</div>
</div>
<div class="section" id="i-want-to-compile-a-python-module-on-my-linux-system-but-some-files-are-missing-why">
<h2><a class="toc-backref" href="#id17">æˆ‘æƒ³åœ¨Linuxç³»ç»Ÿä¸Šç¼–è¯‘ä¸€ä¸ªPythonæ¨¡å—ï¼Œä½†æ˜¯ç¼ºå°‘ä¸€äº›æ–‡ä»¶ã€‚ä¸ºä»€ä¹ˆ?</a><a class="headerlink" href="#i-want-to-compile-a-python-module-on-my-linux-system-but-some-files-are-missing-why" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>å¤§å¤šæ•°æ‰“åŒ…çš„Pythonç‰ˆæœ¬ä¸åŒ…å« <code class="file docutils literal notranslate"><span class="pre">/usr/lib/python2.</span><em><span class="pre">x</span></em><span class="pre">/config/</span></code> ç›®å½•ï¼Œè¯¥ç›®å½•ä¸­åŒ…å«ç¼–è¯‘Pythonæ‰©å±•æ‰€éœ€çš„å„ç§æ–‡ä»¶ã€‚</p>
<p>å¯¹äºRed Hatï¼Œå®‰è£…python-devel RPMä»¥è·å–å¿…è¦çš„æ–‡ä»¶ã€‚</p>
<p>å¯¹äºDebianï¼Œè¿è¡Œ <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">python-dev</span></code> ã€‚</p>
</div>
<div class="section" id="how-do-i-tell-incomplete-input-from-invalid-input">
<h2><a class="toc-backref" href="#id18">å¦‚ä½•åŒºåˆ†â€œè¾“å…¥ä¸å®Œæ•´â€å’Œâ€œè¾“å…¥æ— æ•ˆâ€ï¼Ÿ</a><a class="headerlink" href="#how-do-i-tell-incomplete-input-from-invalid-input" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>æœ‰æ—¶ï¼Œå¸Œæœ›æ¨¡ä»¿Pythonäº¤äº’å¼è§£é‡Šå™¨çš„è¡Œä¸ºï¼Œåœ¨è¾“å…¥ä¸å®Œæ•´æ—¶(ä¾‹å¦‚ï¼Œæ‚¨é”®å…¥äº†â€œifâ€è¯­å¥çš„å¼€å¤´ï¼Œæˆ–è€…æ²¡æœ‰å…³é—­æ‹¬å·æˆ–ä¸‰ä¸ªå­—ç¬¦ä¸²å¼•å·)ï¼Œç»™å‡ºä¸€ä¸ªå»¶ç»­æç¤ºï¼Œä½†å½“è¾“å…¥æ— æ•ˆæ—¶ï¼Œç«‹å³ç»™å‡ºä¸€æ¡è¯­æ³•é”™è¯¯æ¶ˆæ¯ã€‚</p>
<p>åœ¨Pythonä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <a class="reference internal" href="codeop.html#module-codeop" tppabs="https://docs.python.org/zh-cn/3/library/codeop.html#module-codeop" title="codeop: Compile (possibly incomplete) Python code."><code class="xref py py-mod docutils literal notranslate"><span class="pre">codeop</span></code></a> æ¨¡å—ï¼Œè¯¥æ¨¡å—éå¸¸æ¥è¿‘è§£æå™¨çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼ŒIDLEå°±ä½¿ç”¨äº†è¿™ä¸ªã€‚</p>
<p>åœ¨Cä¸­æ‰§è¡Œæ­¤æ“ä½œçš„æœ€ç®€å•æ–¹æ³•æ˜¯è°ƒç”¨ <a class="reference internal" href="veryhigh.html#c.PyRun_InteractiveLoop" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyRun_InteractiveLoop" title="PyRun_InteractiveLoop"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRun_InteractiveLoop()</span></code></a> ï¼ˆå¯èƒ½åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­ï¼‰å¹¶è®©Pythonè§£é‡Šå™¨ä¸ºæ‚¨å¤„ç†è¾“å…¥ã€‚æ‚¨è¿˜å¯ä»¥è®¾ç½® <a class="reference internal" href="veryhigh.html#c.PyOS_ReadlineFunctionPointer" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyOS_ReadlineFunctionPointer" title="PyOS_ReadlineFunctionPointer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyOS_ReadlineFunctionPointer()</span></code></a> æŒ‡å‘æ‚¨çš„è‡ªå®šä¹‰è¾“å…¥å‡½æ•°ã€‚æœ‰å…³æ›´å¤šæç¤ºï¼Œè¯·å‚é˜… <code class="docutils literal notranslate"><span class="pre">Modules/readline.c</span></code> å’Œ <code class="docutils literal notranslate"><span class="pre">Parser/myreadline.c</span></code> ã€‚</p>
<p>ä½†æ˜¯ï¼Œæœ‰æ—¶å¿…é¡»åœ¨ä¸å…¶ä»–åº”ç”¨ç¨‹åºç›¸åŒçš„çº¿ç¨‹ä¸­è¿è¡ŒåµŒå…¥å¼Pythonè§£é‡Šå™¨ï¼Œå¹¶ä¸”ä¸èƒ½å…è®¸ <a class="reference internal" href="veryhigh.html#c.PyRun_InteractiveLoop" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyRun_InteractiveLoop" title="PyRun_InteractiveLoop"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRun_InteractiveLoop()</span></code></a> åœ¨ç­‰å¾…ç”¨æˆ·è¾“å…¥æ—¶åœæ­¢ã€‚é‚£ä¹ˆå¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯è°ƒç”¨ <code class="xref c c-func docutils literal notranslate"><span class="pre">PyParser_ParseString()</span></code> å¹¶æµ‹è¯• <code class="docutils literal notranslate"><span class="pre">e.error</span></code> ç­‰äº <code class="docutils literal notranslate"><span class="pre">E_EOF</span></code> ï¼Œå¦‚æœç­‰äºï¼Œå°±æ„å‘³ç€è¾“å…¥ä¸å®Œæ•´ã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ç‰‡æ®µï¼Œæœªç»æµ‹è¯•ï¼Œçµæ„Ÿæ¥è‡ªAlex Farberçš„ä»£ç :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define PY_SSIZE_T_CLEAN</span>
<span class="cp">#include</span> <span class="cpf">&lt;Python.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;node.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;errcode.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;grammar.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;parsetok.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;compile.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">testcomplete</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">code</span><span class="p">)</span>
  <span class="cm">/* code should end in \n */</span>
  <span class="cm">/* return -1 for error, 0 for incomplete, 1 for complete */</span>
<span class="p">{</span>
  <span class="n">node</span> <span class="o">*</span><span class="n">n</span><span class="p">;</span>
  <span class="n">perrdetail</span> <span class="n">e</span><span class="p">;</span>

  <span class="n">n</span> <span class="o">=</span> <span class="n">PyParser_ParseString</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">_PyParser_Grammar</span><span class="p">,</span>
                           <span class="n">Py_file_input</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">e</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">error</span> <span class="o">==</span> <span class="n">E_EOF</span><span class="p">)</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">PyNode_Free</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Another solution is trying to compile the received string with
<a class="reference internal" href="veryhigh.html#c.Py_CompileString" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.Py_CompileString" title="Py_CompileString"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_CompileString()</span></code></a>. If it compiles without errors, try to execute the
returned code object by calling <a class="reference internal" href="veryhigh.html#c.PyEval_EvalCode" tppabs="https://docs.python.org/zh-cn/3/c-api/veryhigh.html#c.PyEval_EvalCode" title="PyEval_EvalCode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_EvalCode()</span></code></a>. Otherwise save the
input for later. If the compilation fails, find out if it's an error or just
more input is required - by extracting the message string from the exception
tuple and comparing it to the string &quot;unexpected EOF while parsing&quot;.  Here is a
complete example using the GNU readline library (you may want to ignore
<strong>SIGINT</strong> while calling readline()):</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;readline.h&gt;</span><span class="cp"></span>

<span class="cp">#define PY_SSIZE_T_CLEAN</span>
<span class="cp">#include</span> <span class="cpf">&lt;Python.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;object.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;compile.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;eval.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                          <span class="cm">/* lengths of line, code */</span>
  <span class="kt">char</span> <span class="n">ps1</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;&gt;&gt;&gt; &quot;</span><span class="p">;</span>
  <span class="kt">char</span> <span class="n">ps2</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;... &quot;</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">prompt</span> <span class="o">=</span> <span class="n">ps1</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">line</span><span class="p">,</span> <span class="o">*</span><span class="n">code</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
  <span class="n">PyObject</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="o">*</span><span class="n">glb</span><span class="p">,</span> <span class="o">*</span><span class="n">loc</span><span class="p">;</span>
  <span class="n">PyObject</span> <span class="o">*</span><span class="n">exc</span><span class="p">,</span> <span class="o">*</span><span class="n">val</span><span class="p">,</span> <span class="o">*</span><span class="n">trb</span><span class="p">,</span> <span class="o">*</span><span class="n">obj</span><span class="p">,</span> <span class="o">*</span><span class="n">dum</span><span class="p">;</span>

  <span class="n">Py_Initialize</span> <span class="p">();</span>
  <span class="n">loc</span> <span class="o">=</span> <span class="n">PyDict_New</span> <span class="p">();</span>
  <span class="n">glb</span> <span class="o">=</span> <span class="n">PyDict_New</span> <span class="p">();</span>
  <span class="n">PyDict_SetItemString</span> <span class="p">(</span><span class="n">glb</span><span class="p">,</span> <span class="s">&quot;__builtins__&quot;</span><span class="p">,</span> <span class="n">PyEval_GetBuiltins</span> <span class="p">());</span>

  <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">done</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">readline</span> <span class="p">(</span><span class="n">prompt</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">==</span> <span class="n">line</span><span class="p">)</span>                          <span class="cm">/* Ctrl-D pressed */</span>
    <span class="p">{</span>
      <span class="n">done</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="n">i</span> <span class="o">=</span> <span class="n">strlen</span> <span class="p">(</span><span class="n">line</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">add_history</span> <span class="p">(</span><span class="n">line</span><span class="p">);</span>                    <span class="cm">/* save non-empty lines */</span>

      <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">==</span> <span class="n">code</span><span class="p">)</span>                        <span class="cm">/* nothing in code yet */</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">strlen</span> <span class="p">(</span><span class="n">code</span><span class="p">);</span>

      <span class="n">code</span> <span class="o">=</span> <span class="n">realloc</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">==</span> <span class="n">code</span><span class="p">)</span>                        <span class="cm">/* out of memory */</span>
        <span class="n">exit</span> <span class="p">(</span><span class="mi">1</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span>                              <span class="cm">/* code was empty, so */</span>
        <span class="n">code</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>                        <span class="cm">/* keep strncat happy */</span>

      <span class="n">strncat</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>                 <span class="cm">/* append line to code */</span>
      <span class="n">code</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>                      <span class="cm">/* append &#39;\n&#39; to code */</span>
      <span class="n">code</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>

      <span class="n">src</span> <span class="o">=</span> <span class="n">Py_CompileString</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="s">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">Py_single_input</span><span class="p">);</span>

      <span class="k">if</span> <span class="p">(</span><span class="nb">NULL</span> <span class="o">!=</span> <span class="n">src</span><span class="p">)</span>                         <span class="cm">/* compiled just fine - */</span>
      <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">ps1</span>  <span class="o">==</span> <span class="n">prompt</span> <span class="o">||</span>                  <span class="cm">/* &quot;&gt;&gt;&gt; &quot; or */</span>
            <span class="sc">&#39;\n&#39;</span> <span class="o">==</span> <span class="n">code</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>           <span class="cm">/* &quot;... &quot; and double &#39;\n&#39; */</span>
        <span class="p">{</span>                                               <span class="cm">/* so execute it */</span>
          <span class="n">dum</span> <span class="o">=</span> <span class="n">PyEval_EvalCode</span> <span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">glb</span><span class="p">,</span> <span class="n">loc</span><span class="p">);</span>
          <span class="n">Py_XDECREF</span> <span class="p">(</span><span class="n">dum</span><span class="p">);</span>
          <span class="n">Py_XDECREF</span> <span class="p">(</span><span class="n">src</span><span class="p">);</span>
          <span class="n">free</span> <span class="p">(</span><span class="n">code</span><span class="p">);</span>
          <span class="n">code</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">PyErr_Occurred</span> <span class="p">())</span>
            <span class="n">PyErr_Print</span> <span class="p">();</span>
          <span class="n">prompt</span> <span class="o">=</span> <span class="n">ps1</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>                                        <span class="cm">/* syntax error or E_EOF? */</span>
      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">PyErr_ExceptionMatches</span> <span class="p">(</span><span class="n">PyExc_SyntaxError</span><span class="p">))</span>
      <span class="p">{</span>
        <span class="n">PyErr_Fetch</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">exc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">trb</span><span class="p">);</span>        <span class="cm">/* clears exception! */</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">PyArg_ParseTuple</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="s">&quot;sO&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">msg</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">obj</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
            <span class="o">!</span><span class="n">strcmp</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s">&quot;unexpected EOF while parsing&quot;</span><span class="p">))</span> <span class="cm">/* E_EOF */</span>
        <span class="p">{</span>
          <span class="n">Py_XDECREF</span> <span class="p">(</span><span class="n">exc</span><span class="p">);</span>
          <span class="n">Py_XDECREF</span> <span class="p">(</span><span class="n">val</span><span class="p">);</span>
          <span class="n">Py_XDECREF</span> <span class="p">(</span><span class="n">trb</span><span class="p">);</span>
          <span class="n">prompt</span> <span class="o">=</span> <span class="n">ps2</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>                                   <span class="cm">/* some other syntax error */</span>
        <span class="p">{</span>
          <span class="n">PyErr_Restore</span> <span class="p">(</span><span class="n">exc</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">trb</span><span class="p">);</span>
          <span class="n">PyErr_Print</span> <span class="p">();</span>
          <span class="n">free</span> <span class="p">(</span><span class="n">code</span><span class="p">);</span>
          <span class="n">code</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
          <span class="n">prompt</span> <span class="o">=</span> <span class="n">ps1</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">else</span>                                     <span class="cm">/* some non-syntax error */</span>
      <span class="p">{</span>
        <span class="n">PyErr_Print</span> <span class="p">();</span>
        <span class="n">free</span> <span class="p">(</span><span class="n">code</span><span class="p">);</span>
        <span class="n">code</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="n">ps1</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="n">free</span> <span class="p">(</span><span class="n">line</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">Py_XDECREF</span><span class="p">(</span><span class="n">glb</span><span class="p">);</span>
  <span class="n">Py_XDECREF</span><span class="p">(</span><span class="n">loc</span><span class="p">);</span>
  <span class="n">Py_Finalize</span><span class="p">();</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-find-undefined-g-symbols-builtin-new-or-pure-virtual">
<h2><a class="toc-backref" href="#id19">å¦‚ä½•æ‰¾åˆ°æœªå®šä¹‰çš„g++ç¬¦å·__builtin_newæˆ–__pure_virtualï¼Ÿ</a><a class="headerlink" href="#how-do-i-find-undefined-g-symbols-builtin-new-or-pure-virtual" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>è¦åŠ¨æ€åŠ è½½g ++æ‰©å±•æ¨¡å—ï¼Œå¿…é¡»é‡æ–°ç¼–è¯‘Pythonï¼Œè¦ä½¿ç”¨g ++é‡æ–°é“¾æ¥ï¼ˆåœ¨Python Modules Makefileä¸­æ›´æ”¹LINKCCï¼‰ï¼ŒåŠé“¾æ¥æ‰©å±•æ¨¡å—ï¼ˆä¾‹å¦‚ï¼š <code class="docutils literal notranslate"><span class="pre">g++</span> <span class="pre">-shared</span> <span class="pre">-o</span> <span class="pre">mymodule.so</span> <span class="pre">mymodule.o</span></code> ï¼‰ã€‚</p>
</div>
<div class="section" id="can-i-create-an-object-class-with-some-methods-implemented-in-c-and-others-in-python-e-g-through-inheritance">
<h2><a class="toc-backref" href="#id20">èƒ½å¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç±»ï¼Œå…¶ä¸­éƒ¨åˆ†æ–¹æ³•åœ¨Cä¸­å®ç°ï¼Œè€Œå…¶ä»–æ–¹æ³•åœ¨Pythonä¸­å®ç°ï¼ˆä¾‹å¦‚é€šè¿‡ç»§æ‰¿ï¼‰ï¼Ÿ</a><a class="headerlink" href="#can-i-create-an-object-class-with-some-methods-implemented-in-c-and-others-in-python-e-g-through-inheritance" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>æ˜¯çš„ï¼Œæ‚¨å¯ä»¥ç»§æ‰¿å†…ç½®ç±»ï¼Œä¾‹å¦‚ <a class="reference internal" href="functions.html#int" tppabs="https://docs.python.org/zh-cn/3/library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> ï¼Œ <a class="reference internal" href="stdtypes.html#list" tppabs="https://docs.python.org/zh-cn/3/library/stdtypes.html#list" title="list"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> ï¼Œ <a class="reference internal" href="stdtypes.html#dict" tppabs="https://docs.python.org/zh-cn/3/library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> ç­‰ã€‚</p>
<p>Boost Pythonåº“ï¼ˆBPLï¼Œhttpï¼š//www.boost.org/libs/python/doc/index.htmlï¼‰æä¾›äº†ä¸€ç§ä»C ++æ‰§è¡Œæ­¤æ“ä½œçš„æ–¹æ³•ï¼ˆå³ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨BPLç»§æ‰¿è‡ªC ++ç¼–å†™çš„æ‰©å±•ç±» ï¼‰ã€‚</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html" tppabs="https://docs.python.org/zh-cn/3/contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">æ‰©å±•/åµŒå…¥å¸¸è§é—®é¢˜</a><ul>
<li><a class="reference internal" href="#can-i-create-my-own-functions-in-c">å¯ä»¥ä½¿ç”¨Cè¯­è¨€ä¸­åˆ›å»ºè‡ªå·±çš„å‡½æ•°å—ï¼Ÿ</a></li>
<li><a class="reference internal" href="#id2">å¯ä»¥ä½¿ç”¨C++è¯­è¨€ä¸­åˆ›å»ºè‡ªå·±çš„å‡½æ•°å—ï¼Ÿ</a></li>
<li><a class="reference internal" href="#writing-c-is-hard-are-there-any-alternatives">Cå¾ˆéš¾å†™ï¼Œæœ‰æ²¡æœ‰å…¶ä»–é€‰æ‹©ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-can-i-execute-arbitrary-python-statements-from-c">å¦‚ä½•ä»Cæ‰§è¡Œä»»æ„Pythonè¯­å¥ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-can-i-evaluate-an-arbitrary-python-expression-from-c">å¦‚ä½•ä»Cä¸­è¯„ä¼°ä»»æ„Pythonè¡¨è¾¾å¼ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-extract-c-values-from-a-python-object">å¦‚ä½•ä»Pythonå¯¹è±¡ä¸­æå–Cçš„å€¼ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-use-py-buildvalue-to-create-a-tuple-of-arbitrary-length">å¦‚ä½•ä½¿ç”¨Py_BuildValue()åˆ›å»ºä»»æ„é•¿åº¦çš„å…ƒç»„ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-call-an-object-s-method-from-c">å¦‚ä½•ä»Cè°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-catch-the-output-from-pyerr-print-or-anything-that-prints-to-stdout-stderr">å¦‚ä½•æ•è·PyErr_Print()ï¼ˆæˆ–æ‰“å°åˆ°stdout / stderrçš„ä»»ä½•å†…å®¹ï¼‰çš„è¾“å‡ºï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-access-a-module-written-in-python-from-c">å¦‚ä½•ä»Cè®¿é—®ç”¨Pythonç¼–å†™çš„æ¨¡å—ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-interface-to-c-objects-from-python">å¦‚ä½•ä»Pythonæ¥å£åˆ°C ++å¯¹è±¡ï¼Ÿ</a></li>
<li><a class="reference internal" href="#i-added-a-module-using-the-setup-file-and-the-make-fails-why">æˆ‘ä½¿ç”¨Setupæ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªæ¨¡å—ï¼Œä¸ºä»€ä¹ˆmakeå¤±è´¥äº†ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-debug-an-extension">å¦‚ä½•è°ƒè¯•æ‰©å±•ï¼Ÿ</a></li>
<li><a class="reference internal" href="#i-want-to-compile-a-python-module-on-my-linux-system-but-some-files-are-missing-why">æˆ‘æƒ³åœ¨Linuxç³»ç»Ÿä¸Šç¼–è¯‘ä¸€ä¸ªPythonæ¨¡å—ï¼Œä½†æ˜¯ç¼ºå°‘ä¸€äº›æ–‡ä»¶ã€‚ä¸ºä»€ä¹ˆ?</a></li>
<li><a class="reference internal" href="#how-do-i-tell-incomplete-input-from-invalid-input">å¦‚ä½•åŒºåˆ†â€œè¾“å…¥ä¸å®Œæ•´â€å’Œâ€œè¾“å…¥æ— æ•ˆâ€ï¼Ÿ</a></li>
<li><a class="reference internal" href="#how-do-i-find-undefined-g-symbols-builtin-new-or-pure-virtual">å¦‚ä½•æ‰¾åˆ°æœªå®šä¹‰çš„g++ç¬¦å·__builtin_newæˆ–__pure_virtualï¼Ÿ</a></li>
<li><a class="reference internal" href="#can-i-create-an-object-class-with-some-methods-implemented-in-c-and-others-in-python-e-g-through-inheritance">èƒ½å¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç±»ï¼Œå…¶ä¸­éƒ¨åˆ†æ–¹æ³•åœ¨Cä¸­å®ç°ï¼Œè€Œå…¶ä»–æ–¹æ³•åœ¨Pythonä¸­å®ç°ï¼ˆä¾‹å¦‚é€šè¿‡ç»§æ‰¿ï¼‰ï¼Ÿ</a></li>
</ul>
</li>
</ul>

  <h4>ä¸Šä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="library.html" tppabs="https://docs.python.org/zh-cn/3/faq/library.html"
                        title="ä¸Šä¸€ç« ">ä»£ç åº“å’Œæ’ä»¶ FAQ</a></p>
  <h4>ä¸‹ä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="windows-3.html" tppabs="https://docs.python.org/zh-cn/3/faq/windows.html"
                        title="ä¸‹ä¸€ç« ">Pythonåœ¨Windowsä¸Šçš„å¸¸è§é—®é¢˜</a></p>
  <div role="note" aria-label="source link">
    <h3>æœ¬é¡µ</h3>
    <ul class="this-page-menu">
      <li><a href="bugs.html" tppabs="https://docs.python.org/zh-cn/3/bugs.html">æäº¤ Bug</a></li>
      <li>
        <a href="javascript:if(confirm('https://github.com/python/cpython/blob/3.7/Doc/faq/extending.rst  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/python/cpython/blob/3.7/Doc/faq/extending.rst'" tppabs="https://github.com/python/cpython/blob/3.7/Doc/faq/extending.rst"
            rel="nofollow">æ˜¾ç¤ºæºä»£ç 
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             >ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="windows-3.html" tppabs="https://docs.python.org/zh-cn/3/faq/windows.html" title="Pythonåœ¨Windowsä¸Šçš„å¸¸è§é—®é¢˜"
             >ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="library.html" tppabs="https://docs.python.org/zh-cn/3/faq/library.html" title="ä»£ç åº“å’Œæ’ä»¶ FAQ"
             >ä¸Šä¸€é¡µ</a> |</li>
        <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="language_switcher_placeholder">zh_CN</span>
          <span class="version_switcher_placeholder">3.7.3</span>
          <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index-10.html" tppabs="https://docs.python.org/zh-cn/3/faq/index.html" >Python å¸¸è§é—®é¢˜</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="copyright.html" tppabs="https://docs.python.org/zh-cn/3/copyright.html">ç‰ˆæƒæ‰€æœ‰</a> 2001-2019, Python Software Foundation.
    <br />
    Python è½¯ä»¶åŸºé‡‘ä¼šæ˜¯ä¸€ä¸ªéç›ˆåˆ©ç»„ç»‡ã€‚
    <a href="javascript:if(confirm('https://www.python.org/psf/donations/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/psf/donations/'" tppabs="https://www.python.org/psf/donations/">è¯·æåŠ©ã€‚</a>
    <br />
    æœ€åæ›´æ–°äº 4æœˆ 22, 2019.
    <a href="bugs.html" tppabs="https://docs.python.org/zh-cn/3/bugs.html">å‘ç°äº†é—®é¢˜</a>ï¼Ÿ
    <br />
    ä½¿ç”¨<a href="javascript:if(confirm('http://sphinx.pocoo.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://sphinx.pocoo.org/'" tppabs="http://sphinx.pocoo.org/">Sphinx</a>1.8.4 åˆ›å»ºã€‚
    </div>

  </body>
</html>