
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <title>Python Profilers åˆ†æå™¨ &#8212; Python 3.8.2 æ–‡æ¡£</title>
    <link rel="stylesheet" href="pydoctheme.css" tppabs="https://docs.python.org/zh-cn/3/_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="pygments.css" tppabs="https://docs.python.org/zh-cn/3/_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="documentation_options.js" tppabs="https://docs.python.org/zh-cn/3/_static/documentation_options.js"></script>
    <script type="text/javascript" src="jquery.js" tppabs="https://docs.python.org/zh-cn/3/_static/jquery.js"></script>
    <script type="text/javascript" src="underscore.js" tppabs="https://docs.python.org/zh-cn/3/_static/underscore.js"></script>
    <script type="text/javascript" src="doctools.js" tppabs="https://docs.python.org/zh-cn/3/_static/doctools.js"></script>
    <script type="text/javascript" src="language_data.js" tppabs="https://docs.python.org/zh-cn/3/_static/language_data.js"></script>
    <script type="text/javascript" src="translations.js" tppabs="https://docs.python.org/zh-cn/3/_static/translations.js"></script>
    
    <script type="text/javascript" src="sidebar.js" tppabs="https://docs.python.org/zh-cn/3/_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="åœ¨ Python 3.8.2 æ–‡æ¡£ ä¸­æœç´¢"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="å…³äºè¿™äº›æ–‡æ¡£" href="../about.html" />
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æœç´¢" href="../search.html" />
    <link rel="copyright" title="ç‰ˆæƒæ‰€æœ‰" href="../copyright.html" />
    <link rel="next" title="timeit --- æµ‹é‡å°ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´" href="timeit.html" />
    <link rel="prev" title="pdb --- Pythonçš„è°ƒè¯•å™¨" href="pdb.html" />
    <link rel="canonical" href="https://docs.python.org/3/library/profile.html" />
    
      
      <script type="text/javascript" src="switchers.js" tppabs="https://docs.python.org/zh-cn/3/_static/switchers.js"></script>
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>

    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    
    <script type="text/javascript" src="copybutton.js" tppabs="https://docs.python.org/zh-cn/3/_static/copybutton.js"></script>
    
     


  </head><body>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             accesskey="I">ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="timeit.html" tppabs="https://docs.python.org/zh-cn/3/library/timeit.html" title="timeit --- æµ‹é‡å°ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´"
             accesskey="N">ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="pdb.html" tppabs="https://docs.python.org/zh-cn/3/library/pdb.html" title="pdb --- Pythonçš„è°ƒè¯•å™¨"
             accesskey="P">ä¸Šä¸€é¡µ</a> |</li>

    <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
    

    <li>
      <span class="language_switcher_placeholder">zh_CN</span>
      <span class="version_switcher_placeholder">3.8.2</span>
      <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index-2.html" tppabs="https://docs.python.org/zh-cn/3/library/index.html" >Python æ ‡å‡†åº“</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="debug.html" tppabs="https://docs.python.org/zh-cn/3/library/debug.html" accesskey="U">è°ƒè¯•å’Œåˆ†æ</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-python-profilers">
<span id="profile"></span><h1>Python Profilers åˆ†æå™¨<a class="headerlink" href="#the-python-profilers" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h1>
<p><strong>æºä»£ç ï¼š</strong> <a class="reference external" href="javascript:if(confirm('https://github.com/python/cpython/tree/3.8/Lib/profile.py  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/python/cpython/tree/3.8/Lib/profile.py'" tppabs="https://github.com/python/cpython/tree/3.8/Lib/profile.py">Lib/profile.py</a> å’Œ <a class="reference external" href="javascript:if(confirm('https://github.com/python/cpython/tree/3.8/Lib/pstats.py  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/python/cpython/tree/3.8/Lib/pstats.py'" tppabs="https://github.com/python/cpython/tree/3.8/Lib/pstats.py">Lib/pstats.py</a></p>
<hr class="docutils" />
<div class="section" id="introduction-to-the-profilers">
<span id="profiler-introduction"></span><h2>profileåˆ†æå™¨ç®€ä»‹<a class="headerlink" href="#introduction-to-the-profilers" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p id="index-0"><a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> å’Œ <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> æä¾›äº† Python ç¨‹åºçš„ <em class="dfn">ç¡®å®šæ€§æ€§èƒ½åˆ†æ</em> ã€‚ <em class="dfn">profile</em> æ˜¯ä¸€ç»„ç»Ÿè®¡æ•°æ®ï¼Œæè¿°ç¨‹åºçš„å„ä¸ªéƒ¨åˆ†æ‰§è¡Œçš„é¢‘ç‡å’Œæ—¶é—´ã€‚è¿™äº›ç»Ÿè®¡æ•°æ®å¯ä»¥é€šè¿‡ <a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a> æ¨¡å—æ ¼å¼åŒ–ä¸ºæŠ¥è¡¨ã€‚</p>
<p>Python æ ‡å‡†åº“æä¾›äº†åŒä¸€åˆ†ææ¥å£çš„ä¸¤ç§ä¸åŒå®ç°ï¼š</p>
<ol class="arabic simple">
<li><p>å¯¹äºå¤§å¤šæ•°ç”¨æˆ·ï¼Œå»ºè®®ä½¿ç”¨ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> ï¼›è¿™æ˜¯ä¸€ä¸ª C æ‰©å±•æ’ä»¶ï¼Œå› ä¸ºå…¶åˆç†çš„è¿è¡Œå¼€é”€ï¼Œæ‰€ä»¥é€‚åˆäºåˆ†æé•¿æ—¶é—´è¿è¡Œçš„ç¨‹åºã€‚è¯¥æ’ä»¶åŸºäº <code class="xref py py-mod docutils literal notranslate"><span class="pre">lsprof</span></code> ï¼Œç”± Brett Rosen å’Œ Ted Chaotter è´¡çŒ®ã€‚</p></li>
<li><p><a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> æ˜¯ä¸€ä¸ªçº¯ Python æ¨¡å—ï¼ˆ<a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> å°±æ˜¯æ¨¡æ‹Ÿå…¶æ¥å£çš„ C è¯­è¨€å®ç°ï¼‰ï¼Œä½†å®ƒä¼šæ˜¾è‘—å¢åŠ é…ç½®ç¨‹åºçš„å¼€é”€ã€‚å¦‚æœä½ æ­£åœ¨å°è¯•ä»¥æŸç§æ–¹å¼æ‰©å±•åˆ†æå™¨ï¼Œåˆ™ä½¿ç”¨æ­¤æ¨¡å—å¯èƒ½ä¼šæ›´å®¹æ˜“å®Œæˆä»»åŠ¡ã€‚è¯¥æ¨¡å—æœ€åˆç”± Jim Roskind  è®¾è®¡å’Œç¼–å†™ã€‚</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">æ³¨è§£</p>
<p>profiler åˆ†æå™¨æ¨¡å—è¢«è®¾è®¡ä¸ºç»™æŒ‡å®šçš„ç¨‹åºæä¾›æ‰§è¡Œæ¦‚è¦æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç”¨äºåŸºå‡†æµ‹è¯•ç›®çš„ï¼ˆ <a class="reference internal" href="timeit.html#module-timeit" tppabs="https://docs.python.org/zh-cn/3/library/timeit.html#module-timeit" title="timeit: Measure the execution time of small code snippets."><code class="xref py py-mod docutils literal notranslate"><span class="pre">timeit</span></code></a> æ‰æ˜¯ç”¨äºæ­¤ç›®æ ‡çš„ï¼Œå®ƒèƒ½è·å¾—åˆç†å‡†ç¡®çš„ç»“æœï¼‰ã€‚è¿™ç‰¹åˆ«é€‚ç”¨äºå°† Python ä»£ç ä¸ C ä»£ç è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼šåˆ†æå™¨ä¸ºPython ä»£ç å¼•å…¥å¼€é”€ï¼Œä½†ä¸ä¼šä¸º Cçº§åˆ«çš„å‡½æ•°å¼•å…¥å¼€é”€ï¼Œå› æ­¤ C ä»£ç ä¼¼ä¹æ¯”ä»»ä½•Python ä»£ç éƒ½æ›´å¿«ã€‚</p>
</div>
</div>
<div class="section" id="instant-user-s-manual">
<span id="profile-instant"></span><h2>å®æ—¶ç”¨æˆ·æ‰‹å†Œ<a class="headerlink" href="#instant-user-s-manual" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>æœ¬èŠ‚æ˜¯ä¸º â€œä¸æƒ³é˜…è¯»æ‰‹å†Œâ€ çš„ç”¨æˆ·æä¾›çš„ã€‚å®ƒæä¾›äº†éå¸¸ç®€çŸ­çš„æ¦‚è¿°ï¼Œå¹¶å…è®¸ç”¨æˆ·å¿«é€Ÿå¯¹ç°æœ‰åº”ç”¨ç¨‹åºæ‰§è¡Œè¯„æµ‹ã€‚</p>
<p>è¦åˆ†æé‡‡ç”¨å•ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">cProfile</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;re.compile(&quot;foo|bar&quot;)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>ï¼ˆå¦‚æœ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> åœ¨æ‚¨çš„ç³»ç»Ÿä¸Šä¸å¯ç”¨ï¼Œè¯·ä½¿ç”¨ <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> ã€‚ï¼‰</p>
<p>ä¸Šè¿°æ“ä½œå°†è¿è¡Œ <a class="reference internal" href="re.html#re.compile" tppabs="https://docs.python.org/zh-cn/3/library/re.html#re.compile" title="re.compile"><code class="xref py py-func docutils literal notranslate"><span class="pre">re.compile()</span></code></a> å¹¶æ‰“å°åˆ†æç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>      <span class="mi">197</span> <span class="n">function</span> <span class="n">calls</span> <span class="p">(</span><span class="mi">192</span> <span class="n">primitive</span> <span class="n">calls</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.002</span> <span class="n">seconds</span>

<span class="n">Ordered</span> <span class="n">by</span><span class="p">:</span> <span class="n">standard</span> <span class="n">name</span>

<span class="n">ncalls</span>  <span class="n">tottime</span>  <span class="n">percall</span>  <span class="n">cumtime</span>  <span class="n">percall</span> <span class="n">filename</span><span class="p">:</span><span class="n">lineno</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
     <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.001</span>    <span class="mf">0.001</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span><span class="p">(</span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">)</span>
     <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.001</span>    <span class="mf">0.001</span> <span class="n">re</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">212</span><span class="p">(</span><span class="nb">compile</span><span class="p">)</span>
     <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.001</span>    <span class="mf">0.001</span> <span class="n">re</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">268</span><span class="p">(</span><span class="n">_compile</span><span class="p">)</span>
     <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span> <span class="n">sre_compile</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">172</span><span class="p">(</span><span class="n">_compile_charset</span><span class="p">)</span>
     <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span> <span class="n">sre_compile</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">201</span><span class="p">(</span><span class="n">_optimize_charset</span><span class="p">)</span>
     <span class="mi">4</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span> <span class="n">sre_compile</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">25</span><span class="p">(</span><span class="n">_identityfunction</span><span class="p">)</span>
   <span class="mi">3</span><span class="o">/</span><span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span> <span class="n">sre_compile</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">33</span><span class="p">(</span><span class="n">_compile</span><span class="p">)</span>
</pre></div>
</div>
<p>ç¬¬ä¸€è¡Œæ˜¾ç¤ºç›‘å¬äº†197ä¸ªè°ƒç”¨ã€‚åœ¨è¿™äº›è°ƒç”¨ä¸­ï¼Œæœ‰192ä¸ªæ˜¯ <em class="dfn">åŸå§‹çš„</em> ï¼Œè¿™æ„å‘³ç€è°ƒç”¨ä¸æ˜¯é€šè¿‡é€’å½’å¼•å‘çš„ã€‚ä¸‹ä¸€è¡Œ: <code class="docutils literal notranslate"><span class="pre">Ordered</span> <span class="pre">by:</span> <span class="pre">standard</span> <span class="pre">name</span></code> ï¼Œè¡¨ç¤ºæœ€å³è¾¹åˆ—ä¸­çš„æ–‡æœ¬å­—ç¬¦ä¸²ç”¨äºå¯¹è¾“å‡ºè¿›è¡Œæ’åºã€‚åˆ—æ ‡é¢˜åŒ…æ‹¬ï¼š</p>
<dl class="simple">
<dt>ncalls</dt><dd><p>è°ƒç”¨æ¬¡æ•°</p>
</dd>
<dt>tottime</dt><dd><p>åœ¨æŒ‡å®šå‡½æ•°ä¸­æ¶ˆè€—çš„æ€»æ—¶é—´ï¼ˆä¸åŒ…æ‹¬è°ƒç”¨å­å‡½æ•°çš„æ—¶é—´ï¼‰</p>
</dd>
<dt>percall</dt><dd><p>æ˜¯ <code class="docutils literal notranslate"><span class="pre">tottime</span></code> é™¤ä»¥ <code class="docutils literal notranslate"><span class="pre">ncalls</span></code> çš„å•†</p>
</dd>
<dt>cumtime</dt><dd><p>æŒ‡å®šçš„å‡½æ•°åŠå…¶æ‰€æœ‰å­å‡½æ•°ï¼ˆä»è°ƒç”¨åˆ°é€€å‡ºï¼‰æ¶ˆè€—çš„ç´¯ç§¯æ—¶é—´ã€‚è¿™ä¸ªæ•°å­—å¯¹äºé€’å½’å‡½æ•°æ¥è¯´æ˜¯å‡†ç¡®çš„ã€‚</p>
</dd>
<dt>percall</dt><dd><p>æ˜¯ <code class="docutils literal notranslate"><span class="pre">cumtime</span></code> é™¤ä»¥åŸå§‹è°ƒç”¨ï¼ˆæ¬¡æ•°ï¼‰çš„å•†ï¼ˆå³ï¼šå‡½æ•°è¿è¡Œä¸€æ¬¡çš„å¹³å‡æ—¶é—´ï¼‰</p>
</dd>
<dt>filename:lineno(function)</dt><dd><p>æä¾›ç›¸åº”æ•°æ®çš„æ¯ä¸ªå‡½æ•°</p>
</dd>
</dl>
<p>å¦‚æœç¬¬ä¸€åˆ—ä¸­æœ‰ä¸¤ä¸ªæ•°å­—ï¼ˆä¾‹å¦‚3/1ï¼‰ï¼Œåˆ™è¡¨ç¤ºå‡½æ•°é€’å½’ã€‚ç¬¬äºŒä¸ªå€¼æ˜¯åŸå§‹è°ƒç”¨æ¬¡æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è°ƒç”¨çš„æ€»æ¬¡æ•°ã€‚è¯·æ³¨æ„ï¼Œå½“å‡½æ•°ä¸é€’å½’æ—¶ï¼Œè¿™ä¸¤ä¸ªå€¼æ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”åªæ‰“å°å•ä¸ªæ•°å­—ã€‚</p>
<p>profile è¿è¡Œç»“æŸæ—¶ï¼Œæ‰“å°è¾“å‡ºä¸æ˜¯å¿…é¡»çš„ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ä¸º <code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code> å‡½æ•°æŒ‡å®šæ–‡ä»¶åï¼Œå°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼š</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">cProfile</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;re.compile(&quot;foo|bar&quot;)&#39;</span><span class="p">,</span> <span class="s1">&#39;restats&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstats.Stats</span></code></a> ç±»ä»æ–‡ä»¶ä¸­è¯»å– profile ç»“æœï¼Œå¹¶ä»¥å„ç§æ–¹å¼å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ã€‚</p>
<p><a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> å’Œ <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> æ–‡ä»¶ä¹Ÿå¯ä»¥ä½œä¸ºè„šæœ¬è°ƒç”¨ï¼Œä»¥åˆ†æå¦ä¸€ä¸ªè„šæœ¬ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">cProfile</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">output_file</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">sort_order</span><span class="p">]</span> <span class="p">(</span><span class="o">-</span><span class="n">m</span> <span class="n">module</span> <span class="o">|</span> <span class="n">myscript</span><span class="o">.</span><span class="n">py</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">-o</span></code> å°†profile ç»“æœå†™å…¥æ–‡ä»¶è€Œä¸æ˜¯æ ‡å‡†è¾“å‡º</p>
<p><code class="docutils literal notranslate"><span class="pre">-s</span></code> æŒ‡å®š <a class="reference internal" href="#pstats.Stats.sort_stats" title="pstats.Stats.sort_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">sort_stats()</span></code></a> æ’åºå€¼ä¹‹ä¸€ä»¥å¯¹è¾“å‡ºè¿›è¡Œæ’åºã€‚è¿™ä»…é€‚ç”¨äºæœªæä¾› <code class="docutils literal notranslate"><span class="pre">-o</span></code> çš„æƒ…å†µ</p>
<p><code class="docutils literal notranslate"><span class="pre">-m</span></code> æŒ‡å®šè¦åˆ†æçš„æ˜¯æ¨¡å—è€Œä¸æ˜¯è„šæœ¬ã€‚</p>
<blockquote>
<div><div class="versionadded">
<p><span class="versionmodified added">3.7 æ–°ç‰ˆåŠŸèƒ½: </span><a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> æ·»åŠ  <code class="docutils literal notranslate"><span class="pre">-m</span></code> é€‰é¡¹</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">3.8 æ–°ç‰ˆåŠŸèƒ½: </span><a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> æ·»åŠ  <code class="docutils literal notranslate"><span class="pre">-m</span></code> é€‰é¡¹</p>
</div>
</div></blockquote>
<p>The <a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a> module's <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class has a variety of methods
for manipulating and printing the data saved into a profile results file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pstats</span>
<span class="kn">from</span> <span class="nn">pstats</span> <span class="kn">import</span> <span class="n">SortKey</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="s1">&#39;restats&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">strip_dirs</span><span class="p">()</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#pstats.Stats.strip_dirs" title="pstats.Stats.strip_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strip_dirs()</span></code></a> method removed the extraneous path from all
the module names. The <a class="reference internal" href="#pstats.Stats.sort_stats" title="pstats.Stats.sort_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_stats()</span></code></a> method sorted all the
entries according to the standard module/line/name string that is printed. The
<a class="reference internal" href="#pstats.Stats.print_stats" title="pstats.Stats.print_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_stats()</span></code></a> method printed out all the statistics.  You
might try the following sort calls:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">NAME</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</pre></div>
</div>
<p>The first call will actually sort the list by function name, and the second call
will print out the statistics.  The following are some interesting calls to
experiment with:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">CUMULATIVE</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This sorts the profile by cumulative time in a function, and then only prints
the ten most significant lines.  If you want to understand what algorithms are
taking time, the above line is what you would use.</p>
<p>If you were looking to see what functions were looping a lot, and taking a lot
of time, you would do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">TIME</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>to sort according to time spent within each function, and then print the
statistics for the top ten functions.</p>
<p>ä½ ä¹Ÿå¯ä»¥å°è¯•ï¼š</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">FILENAME</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="s1">&#39;__init__&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will sort all the statistics by file name, and then print out statistics
for only the class init methods (since they are spelled with <code class="docutils literal notranslate"><span class="pre">__init__</span></code> in
them).  As one final example, you could try:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span> <span class="n">SortKey</span><span class="o">.</span><span class="n">CUMULATIVE</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This line sorts statistics with a primary key of time, and a secondary key of
cumulative time, and then prints out some of the statistics. To be specific, the
list is first culled down to 50% (re: <code class="docutils literal notranslate"><span class="pre">.5</span></code>) of its original size, then only
lines containing <code class="docutils literal notranslate"><span class="pre">init</span></code> are maintained, and that sub-sub-list is printed.</p>
<p>If you wondered what functions called the above functions, you could now (<code class="docutils literal notranslate"><span class="pre">p</span></code>
is still sorted according to the last criteria) do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">print_callers</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and you would get a list of callers for each of the listed functions.</p>
<p>If you want more functionality, you're going to have to read the manual, or
guess what the following functions do:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">print_callees</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;restats&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Invoked as a script, the <a class="reference internal" href="#module-pstats" title="pstats: Statistics object for use with the profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstats</span></code></a> module is a statistics browser for
reading and examining profile dumps.  It has a simple line-oriented interface
(implemented using <a class="reference internal" href="cmd.html#module-cmd" tppabs="https://docs.python.org/zh-cn/3/library/cmd.html#module-cmd" title="cmd: Build line-oriented command interpreters."><code class="xref py py-mod docutils literal notranslate"><span class="pre">cmd</span></code></a>) and interactive help.</p>
</div>
<div class="section" id="module-cProfile">
<span id="profile-and-cprofile-module-reference"></span><h2><a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> å’Œ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> æ¨¡å—å‚è€ƒ<a class="headerlink" href="#module-cProfile" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<span class="target" id="module-profile"></span><p><a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> å’Œ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> æ¨¡å—éƒ½æä¾›ä¸‹åˆ—å‡½æ•°ï¼š</p>
<dl class="function">
<dt id="profile.run">
<code class="sig-prename descclassname">profile.</code><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">command</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">sort=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.run" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This function takes a single argument that can be passed to the <a class="reference internal" href="functions.html#exec" tppabs="https://docs.python.org/zh-cn/3/library/functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>
function, and an optional file name.  In all cases this routine executes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">__main__</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span> <span class="n">__main__</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</pre></div>
</div>
<p>and gathers profiling statistics from the execution. If no file name is
present, then this function automatically creates a <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a>
instance and prints a simple profiling report. If the sort value is specified,
it is passed to this <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> instance to control how the
results are sorted.</p>
</dd></dl>

<dl class="function">
<dt id="profile.runctx">
<code class="sig-prename descclassname">profile.</code><code class="sig-name descname">runctx</code><span class="sig-paren">(</span><em class="sig-param">command</em>, <em class="sig-param">globals</em>, <em class="sig-param">locals</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">sort=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.runctx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This function is similar to <a class="reference internal" href="#profile.run" title="profile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a>, with added arguments to supply the
globals and locals dictionaries for the <em>command</em> string. This routine
executes:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">exec</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="nb">globals</span><span class="p">,</span> <span class="nb">locals</span><span class="p">)</span>
</pre></div>
</div>
<p>and gathers profiling statistics as in the <a class="reference internal" href="#profile.run" title="profile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> function above.</p>
</dd></dl>

<dl class="class">
<dt id="profile.Profile">
<em class="property">class </em><code class="sig-prename descclassname">profile.</code><code class="sig-name descname">Profile</code><span class="sig-paren">(</span><em class="sig-param">timer=None</em>, <em class="sig-param">timeunit=0.0</em>, <em class="sig-param">subcalls=True</em>, <em class="sig-param">builtins=True</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This class is normally only used if more precise control over profiling is
needed than what the <code class="xref py py-func docutils literal notranslate"><span class="pre">cProfile.run()</span></code> function provides.</p>
<p>A custom timer can be supplied for measuring how long code takes to run via
the <em>timer</em> argument. This must be a function that returns a single number
representing the current time. If the number is an integer, the <em>timeunit</em>
specifies a multiplier that specifies the duration of each unit of time. For
example, if the timer returns times measured in thousands of seconds, the
time unit would be <code class="docutils literal notranslate"><span class="pre">.001</span></code>.</p>
<p>Directly using the <a class="reference internal" href="#profile.Profile" title="profile.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code></a> class allows formatting profile results
without writing the profile data to a file:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span><span class="o">,</span> <span class="nn">pstats</span><span class="o">,</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">pstats</span> <span class="kn">import</span> <span class="n">SortKey</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="c1"># ... do something ...</span>
<span class="n">pr</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
<span class="n">sortby</span> <span class="o">=</span> <span class="n">SortKey</span><span class="o">.</span><span class="n">CUMULATIVE</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">sortby</span><span class="p">)</span>
<span class="n">ps</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#profile.Profile" title="profile.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code></a> class can also be used as a context manager (supported
only in <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> module. see <a class="reference internal" href="stdtypes.html#typecontextmanager" tppabs="https://docs.python.org/zh-cn/3/library/stdtypes.html#typecontextmanager"><span class="std std-ref">ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç±»å‹</span></a>):</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cProfile</span>

<span class="k">with</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span> <span class="k">as</span> <span class="n">pr</span><span class="p">:</span>
    <span class="c1"># ... do something ...</span>

<span class="n">pr</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.8 ç‰ˆæ›´æ”¹: </span>æ·»åŠ äº†ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ”¯æŒã€‚</p>
</div>
<dl class="method">
<dt id="profile.Profile.enable">
<code class="sig-name descname">enable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.enable" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å¼€å§‹æ”¶é›†åˆ†ææ•°æ®ã€‚ä»…åœ¨ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> å¯ç”¨ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.disable">
<code class="sig-name descname">disable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.disable" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åœæ­¢æ”¶é›†åˆ†ææ•°æ®ã€‚ä»…åœ¨ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> å¯ç”¨ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.create_stats">
<code class="sig-name descname">create_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.create_stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åœæ­¢æ”¶é›†åˆ†ææ•°æ®ï¼Œå¹¶åœ¨å†…éƒ¨å°†ç»“æœè®°å½•ä¸ºå½“å‰ profileã€‚</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.print_stats">
<code class="sig-name descname">print_stats</code><span class="sig-paren">(</span><em class="sig-param">sort=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.print_stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object based on the current
profile and print the results to stdout.</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.dump_stats">
<code class="sig-name descname">dump_stats</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.dump_stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å°†å½“å‰profile çš„ç»“æœå†™å…¥ <em>filename</em> ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">cmd</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.run" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Profile the cmd via <a class="reference internal" href="functions.html#exec" tppabs="https://docs.python.org/zh-cn/3/library/functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.runctx">
<code class="sig-name descname">runctx</code><span class="sig-paren">(</span><em class="sig-param">cmd</em>, <em class="sig-param">globals</em>, <em class="sig-param">locals</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.runctx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Profile the cmd via <a class="reference internal" href="functions.html#exec" tppabs="https://docs.python.org/zh-cn/3/library/functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a> with the specified global and
local environment.</p>
</dd></dl>

<dl class="method">
<dt id="profile.Profile.runcall">
<code class="sig-name descname">runcall</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#profile.Profile.runcall" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Profile <code class="docutils literal notranslate"><span class="pre">func(*args,</span> <span class="pre">**kwargs)</span></code></p>
</dd></dl>

</dd></dl>

<p>Note that profiling will only work if the called command/function actually
returns.  If the interpreter is terminated (e.g. via a <a class="reference internal" href="sys.html#sys.exit" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#sys.exit" title="sys.exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exit()</span></code></a> call
during the called command/function execution) no profiling results will be
printed.</p>
</div>
<div class="section" id="the-stats-class">
<span id="profile-stats"></span><h2><a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> ç±»<a class="headerlink" href="#the-stats-class" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>Analysis of the profiler data is done using the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class.</p>
<span class="target" id="module-pstats"></span><dl class="class">
<dt id="pstats.Stats">
<em class="property">class </em><code class="sig-prename descclassname">pstats.</code><code class="sig-name descname">Stats</code><span class="sig-paren">(</span><em class="sig-param">*filenames or profile</em>, <em class="sig-param">stream=sys.stdout</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This class constructor creates an instance of a &quot;statistics object&quot; from a
<em>filename</em> (or list of filenames) or from a <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> instance. Output
will be printed to the stream specified by <em>stream</em>.</p>
<p>The file selected by the above constructor must have been created by the
corresponding version of <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> or <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>.  To be specific,
there is <em>no</em> file compatibility guaranteed with future versions of this
profiler, and there is no compatibility with files produced by other
profilers, or the same profiler run on a different operating system.  If
several files are provided, all the statistics for identical functions will
be coalesced, so that an overall view of several processes can be considered
in a single report.  If additional files need to be combined with data in an
existing <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object, the <a class="reference internal" href="#pstats.Stats.add" title="pstats.Stats.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> method
can be used.</p>
<p>Instead of reading the profile data from a file, a <code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code>
or <a class="reference internal" href="#profile.Profile" title="profile.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">profile.Profile</span></code></a> object can be used as the profile data source.</p>
<p><a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> å¯¹è±¡æœ‰ä»¥ä¸‹æ–¹æ³•:</p>
<dl class="method">
<dt id="pstats.Stats.strip_dirs">
<code class="sig-name descname">strip_dirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.strip_dirs" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class removes all leading path
information from file names.  It is very useful in reducing the size of
the printout to fit within (close to) 80 columns.  This method modifies
the object, and the stripped information is lost.  After performing a
strip operation, the object is considered to have its entries in a
&quot;random&quot; order, as it was just after object initialization and loading.
If <a class="reference internal" href="#pstats.Stats.strip_dirs" title="pstats.Stats.strip_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strip_dirs()</span></code></a> causes two function names to be
indistinguishable (they are on the same line of the same filename, and
have the same function name), then the statistics for these two entries
are accumulated into a single entry.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param">*filenames</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.add" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method of the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class accumulates additional profiling
information into the current profiling object.  Its arguments should refer
to filenames created by the corresponding version of <a class="reference internal" href="#profile.run" title="profile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">profile.run()</span></code></a>
or <code class="xref py py-func docutils literal notranslate"><span class="pre">cProfile.run()</span></code>. Statistics for identically named (re: file, line,
name) functions are automatically accumulated into single function
statistics.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.dump_stats">
<code class="sig-name descname">dump_stats</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.dump_stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Save the data loaded into the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object to a file named
<em>filename</em>.  The file is created if it does not exist, and is overwritten
if it already exists.  This is equivalent to the method of the same name
on the <a class="reference internal" href="#profile.Profile" title="profile.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">profile.Profile</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code> classes.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.sort_stats">
<code class="sig-name descname">sort_stats</code><span class="sig-paren">(</span><em class="sig-param">*keys</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.sort_stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method modifies the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> object by sorting it according to
the supplied criteria.  The argument can be either a string or a SortKey
enum identifying the basis of a sort (example: <code class="docutils literal notranslate"><span class="pre">'time'</span></code>, <code class="docutils literal notranslate"><span class="pre">'name'</span></code>,
<code class="docutils literal notranslate"><span class="pre">SortKey.TIME</span></code> or <code class="docutils literal notranslate"><span class="pre">SortKey.NAME</span></code>). The SortKey enums argument have
advantage over the string argument in that it is more robust and less
error prone.</p>
<p>When more than one key is provided, then additional keys are used as
secondary criteria when there is equality in all keys selected before
them.  For example, <code class="docutils literal notranslate"><span class="pre">sort_stats(SortKey.NAME,</span> <span class="pre">SortKey.FILE)</span></code> will sort
all the entries according to their function name, and resolve all ties
(identical function names) by sorting by file name.</p>
<p>For the string argument, abbreviations can be used for any key names, as
long as the abbreviation is unambiguous.</p>
<p>The following are the valid string and SortKey:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 34%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>æœ‰æ•ˆå­—ç¬¦ä¸²å‚æ•°</p></th>
<th class="head"><p>æœ‰æ•ˆæšä¸¾å‚æ•°</p></th>
<th class="head"><p>å«ä¹‰</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'calls'</span></code></p></td>
<td><p>SortKey.CALLS</p></td>
<td><p>è°ƒç”¨æ¬¡æ•°</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'cumulative'</span></code></p></td>
<td><p>SortKey.CUMULATIVE</p></td>
<td><p>ç´¯ç§¯æ—¶é—´</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'cumtime'</span></code></p></td>
<td><p>N/A</p></td>
<td><p>ç´¯ç§¯æ—¶é—´</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'file'</span></code></p></td>
<td><p>N/A</p></td>
<td><p>æ–‡ä»¶å</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'filename'</span></code></p></td>
<td><p>SortKey.FILENAME</p></td>
<td><p>æ–‡ä»¶å</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'module'</span></code></p></td>
<td><p>N/A</p></td>
<td><p>æ–‡ä»¶å</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'ncalls'</span></code></p></td>
<td><p>N/A</p></td>
<td><p>è°ƒç”¨æ¬¡æ•°</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'pcalls'</span></code></p></td>
<td><p>SortKey.PCALLS</p></td>
<td><p>åŸå§‹è°ƒç”¨è®¡æ•°</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'line'</span></code></p></td>
<td><p>SortKey.LINE</p></td>
<td><p>è¡Œå·</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'name'</span></code></p></td>
<td><p>SortKey.NAME</p></td>
<td><p>å‡½æ•°åç§°</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'nfl'</span></code></p></td>
<td><p>SortKey.NFL</p></td>
<td><p>åç§°/æ–‡ä»¶/è¡Œ</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'stdname'</span></code></p></td>
<td><p>SortKey.STDNAME</p></td>
<td><p>æ ‡å‡†åç§°</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'time'</span></code></p></td>
<td><p>SortKey.TIME</p></td>
<td><p>å†…éƒ¨æ—¶é—´</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'tottime'</span></code></p></td>
<td><p>N/A</p></td>
<td><p>å†…éƒ¨æ—¶é—´</p></td>
</tr>
</tbody>
</table>
<p>Note that all sorts on statistics are in descending order (placing most
time consuming items first), where as name, file, and line number searches
are in ascending order (alphabetical). The subtle distinction between
<code class="docutils literal notranslate"><span class="pre">SortKey.NFL</span></code> and <code class="docutils literal notranslate"><span class="pre">SortKey.STDNAME</span></code> is that the standard name is a
sort of the name as printed, which means that the embedded line numbers
get compared in an odd way.  For example, lines 3, 20, and 40 would (if
the file names were the same) appear in the string order 20, 3 and 40.
In contrast, <code class="docutils literal notranslate"><span class="pre">SortKey.NFL</span></code> does a numeric compare of the line numbers.
In fact, <code class="docutils literal notranslate"><span class="pre">sort_stats(SortKey.NFL)</span></code> is the same as
<code class="docutils literal notranslate"><span class="pre">sort_stats(SortKey.NAME,</span> <span class="pre">SortKey.FILENAME,</span> <span class="pre">SortKey.LINE)</span></code>.</p>
<p>For backward-compatibility reasons, the numeric arguments <code class="docutils literal notranslate"><span class="pre">-1</span></code>, <code class="docutils literal notranslate"><span class="pre">0</span></code>,
<code class="docutils literal notranslate"><span class="pre">1</span></code>, and <code class="docutils literal notranslate"><span class="pre">2</span></code> are permitted.  They are interpreted as <code class="docutils literal notranslate"><span class="pre">'stdname'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'calls'</span></code>, <code class="docutils literal notranslate"><span class="pre">'time'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'cumulative'</span></code> respectively.  If this old
style format (numeric) is used, only one sort key (the numeric key) will
be used, and additional arguments will be silently ignored.</p>
<div class="versionadded">
<p><span class="versionmodified added">3.7 æ–°ç‰ˆåŠŸèƒ½: </span>Added the SortKey enum.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.reverse_order">
<code class="sig-name descname">reverse_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.reverse_order" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class reverses the ordering of the
basic list within the object.  Note that by default ascending vs
descending order is properly selected based on the sort key of choice.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.print_stats">
<code class="sig-name descname">print_stats</code><span class="sig-paren">(</span><em class="sig-param">*restrictions</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.print_stats" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class prints out a report as described
in the <a class="reference internal" href="#profile.run" title="profile.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">profile.run()</span></code></a> definition.</p>
<p>The order of the printing is based on the last
<a class="reference internal" href="#pstats.Stats.sort_stats" title="pstats.Stats.sort_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sort_stats()</span></code></a> operation done on the object (subject to
caveats in <a class="reference internal" href="#pstats.Stats.add" title="pstats.Stats.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> and
<a class="reference internal" href="#pstats.Stats.strip_dirs" title="pstats.Stats.strip_dirs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strip_dirs()</span></code></a>).</p>
<p>The arguments provided (if any) can be used to limit the list down to the
significant entries.  Initially, the list is taken to be the complete set
of profiled functions.  Each restriction is either an integer (to select a
count of lines), or a decimal fraction between 0.0 and 1.0 inclusive (to
select a percentage of lines), or a string that will interpreted as a
regular expression (to pattern match the standard name that is printed).
If several restrictions are provided, then they are applied sequentially.
For example:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_stats</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;foo:&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>would first limit the printing to first 10% of list, and then only print
functions that were part of filename <code class="file docutils literal notranslate"><span class="pre">.*foo:</span></code>.  In contrast, the
command:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_stats</span><span class="p">(</span><span class="s1">&#39;foo:&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>would limit the list to all functions having file names <code class="file docutils literal notranslate"><span class="pre">.*foo:</span></code>,
and then proceed to only print the first 10% of them.</p>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.print_callers">
<code class="sig-name descname">print_callers</code><span class="sig-paren">(</span><em class="sig-param">*restrictions</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.print_callers" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class prints a list of all functions
that called each function in the profiled database.  The ordering is
identical to that provided by <a class="reference internal" href="#pstats.Stats.print_stats" title="pstats.Stats.print_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_stats()</span></code></a>, and the
definition of the restricting argument is also identical.  Each caller is
reported on its own line.  The format differs slightly depending on the
profiler that produced the stats:</p>
<ul class="simple">
<li><p>With <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a>, a number is shown in parentheses after each caller
to show how many times this specific call was made.  For convenience, a
second non-parenthesized number repeats the cumulative time spent in the
function at the right.</p></li>
<li><p>With <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a>, each caller is preceded by three numbers: the
number of times this specific call was made, and the total and
cumulative times spent in the current function while it was invoked by
this specific caller.</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="pstats.Stats.print_callees">
<code class="sig-name descname">print_callees</code><span class="sig-paren">(</span><em class="sig-param">*restrictions</em><span class="sig-paren">)</span><a class="headerlink" href="#pstats.Stats.print_callees" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This method for the <a class="reference internal" href="#pstats.Stats" title="pstats.Stats"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code></a> class prints a list of all function
that were called by the indicated function.  Aside from this reversal of
direction of calls (re: called vs was called by), the arguments and
ordering are identical to the <a class="reference internal" href="#pstats.Stats.print_callers" title="pstats.Stats.print_callers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print_callers()</span></code></a> method.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="what-is-deterministic-profiling">
<span id="deterministic-profiling"></span><h2>ä»€ä¹ˆæ˜¯ç¡®å®šæ€§æ€§èƒ½åˆ†æï¼Ÿ<a class="headerlink" href="#what-is-deterministic-profiling" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p><em class="dfn">ç¡®å®šæ€§æ€§èƒ½åˆ†æ</em> æ—¨åœ¨åæ˜ è¿™æ ·ä¸€ä¸ªäº‹å®ï¼šå³æ‰€æœ‰ <em>å‡½æ•°è°ƒç”¨</em> ã€ <em>å‡½æ•°è¿”å›</em> å’Œ <em>å¼‚å¸¸</em> äº‹ä»¶éƒ½è¢«ç›‘æ§ï¼Œå¹¶ä¸”å¯¹è¿™äº›äº‹ä»¶ä¹‹é—´çš„é—´éš”ï¼ˆåœ¨æ­¤æœŸé—´ç”¨æˆ·çš„ä»£ç æ­£åœ¨æ‰§è¡Œï¼‰è¿›è¡Œç²¾ç¡®è®¡æ—¶ã€‚ç›¸åï¼Œç»Ÿè®¡åˆ†æï¼ˆä¸æ˜¯ç”±è¯¥æ¨¡å—å®Œæˆï¼‰éšæœºé‡‡æ ·æœ‰æ•ˆæŒ‡ä»¤æŒ‡é’ˆï¼Œå¹¶æ¨æ–­æ—¶é—´èŠ±è´¹åœ¨å“ªé‡Œã€‚åä¸€ç§æŠ€æœ¯ä¼ ç»Ÿä¸Šæ¶‰åŠè¾ƒå°‘çš„å¼€é”€ï¼ˆå› ä¸ºä»£ç ä¸éœ€è¦æ£€æµ‹ï¼‰ï¼Œä½†åªæä¾›äº†æ—¶é—´èŠ±åœ¨å“ªé‡Œçš„ç›¸å¯¹æŒ‡ç¤ºã€‚</p>
<p>åœ¨Pythonä¸­ï¼Œç”±äºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ€»æœ‰ä¸€ä¸ªæ´»åŠ¨çš„è§£é‡Šå™¨ï¼Œå› æ­¤æ‰§è¡Œç¡®å®šæ€§è¯„æµ‹ä¸éœ€è¦æ’å…¥æŒ‡ä»¤çš„ä»£ç ã€‚Python è‡ªåŠ¨ä¸ºæ¯ä¸ªäº‹ä»¶æä¾›ä¸€ä¸ª:dfn:<cite>é’©å­</cite> ï¼ˆå¯é€‰å›è°ƒï¼‰ã€‚æ­¤å¤–ï¼ŒPython çš„è§£é‡Šç‰¹æ€§å¾€å¾€ä¼šç»™æ‰§è¡Œå¢åŠ å¤ªå¤šå¼€é”€ï¼Œä»¥è‡³äºåœ¨å…¸å‹çš„åº”ç”¨ç¨‹åºä¸­ï¼Œç¡®å®šæ€§åˆ†æå¾€å¾€åªä¼šå¢åŠ å¾ˆå°çš„å¤„ç†å¼€é”€ã€‚ç»“æœæ˜¯ï¼Œç¡®å®šæ€§åˆ†æå¹¶æ²¡æœ‰é‚£ä¹ˆä»£ä»·é«˜æ˜‚ï¼Œä½†æ˜¯å®ƒæä¾›äº†æœ‰å…³ Python ç¨‹åºæ‰§è¡Œçš„å¤§é‡è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<p>è°ƒç”¨è®¡æ•°ç»Ÿè®¡ä¿¡æ¯å¯ç”¨äºè¯†åˆ«ä»£ç ä¸­çš„é”™è¯¯ï¼ˆæ„å¤–è®¡æ•°ï¼‰ï¼Œå¹¶è¯†åˆ«å¯èƒ½çš„å†…è”æ‰©å±•ç‚¹ï¼ˆé«˜é¢‘è°ƒç”¨ï¼‰ã€‚å†…éƒ¨æ—¶é—´ç»Ÿè®¡å¯ç”¨äºè¯†åˆ«åº”ä»”ç»†ä¼˜åŒ–çš„ &quot;çƒ­å¾ªç¯&quot; ã€‚ç´¯ç§¯æ—¶é—´ç»Ÿè®¡å¯ç”¨äºè¯†åˆ«ç®—æ³•é€‰æ‹©ä¸Šçš„é«˜çº§åˆ«é”™è¯¯ã€‚è¯·æ³¨æ„ï¼Œè¯¥åˆ†æå™¨ä¸­å¯¹ç´¯ç§¯æ—¶é—´çš„å¼‚å¸¸å¤„ç†ï¼Œå…è®¸ç›´æ¥æ¯”è¾ƒç®—æ³•çš„é€’å½’å®ç°ä¸è¿­ä»£å®ç°çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p>
</div>
<div class="section" id="limitations">
<span id="profile-limitations"></span><h2>å±€é™æ€§<a class="headerlink" href="#limitations" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>ä¸€ä¸ªé™åˆ¶æ˜¯å…³äºæ—¶é—´ä¿¡æ¯çš„å‡†ç¡®æ€§ã€‚ç¡®å®šæ€§æ€§èƒ½åˆ†æå­˜åœ¨ä¸€ä¸ªæ¶‰åŠç²¾åº¦çš„åŸºæœ¬é—®é¢˜ã€‚æœ€æ˜æ˜¾çš„é™åˆ¶æ˜¯ï¼Œåº•å±‚çš„ &quot;æ—¶é’Ÿ&quot; å‘¨æœŸå¤§çº¦ä¸º0.001ç§’ï¼ˆé€šå¸¸ï¼‰ã€‚å› æ­¤ï¼Œæ²¡æœ‰ä»€ä¹ˆæµ‹é‡ä¼šæ¯”åº•å±‚æ—¶é’Ÿæ›´ç²¾ç¡®ã€‚å¦‚æœè¿›è¡Œäº†è¶³å¤Ÿçš„æµ‹é‡ï¼Œé‚£ä¹ˆ &quot;è¯¯å·®&quot; å°†è¶‹äºå¹³å‡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªé”™è¯¯ä¼šå¯¼è‡´ç¬¬äºŒä¸ªé”™è¯¯æ¥æºã€‚</p>
<p>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œä»è°ƒåº¦äº‹ä»¶åˆ°åˆ†æå™¨è°ƒç”¨è·å–æ—¶é—´å‡½æ•°å®é™… <em>è·å–</em> æ—¶é’ŸçŠ¶æ€ï¼Œè¿™éœ€è¦ &quot;ä¸€æ®µæ—¶é—´&quot; ã€‚ç±»ä¼¼åœ°ï¼Œä»è·å–æ—¶é’Ÿå€¼ï¼ˆç„¶åä¿å­˜ï¼‰å¼€å§‹ï¼Œç›´åˆ°å†æ¬¡æ‰§è¡Œç”¨æˆ·ä»£ç ä¸ºæ­¢ï¼Œé€€å‡ºåˆ†æå™¨äº‹ä»¶å¥æŸ„æ—¶ä¹Ÿå­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿã€‚å› æ­¤ï¼Œå¤šæ¬¡è°ƒç”¨å•ä¸ªå‡½æ•°æˆ–è°ƒç”¨å¤šä¸ªå‡½æ•°é€šå¸¸ä¼šç´¯ç§¯æ­¤é”™è¯¯ã€‚å°½ç®¡è¿™ç§æ–¹å¼çš„è¯¯å·®é€šå¸¸å°äºæ—¶é’Ÿçš„ç²¾åº¦ï¼ˆå°äºä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼‰ï¼Œä½†å®ƒ <em>å¯ä»¥</em> ç´¯ç§¯å¹¶å˜å¾—éå¸¸å¯è§‚ã€‚</p>
<p>ä¸å¼€é”€è¾ƒä½çš„ <a class="reference internal" href="#module-cProfile" title="cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code></a> ç›¸æ¯”ï¼Œ <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> çš„é—®é¢˜æ›´ä¸ºä¸¥é‡ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œ <a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> æä¾›äº†ä¸€ç§é’ˆå¯¹æŒ‡å®šå¹³å°çš„è‡ªæˆ‘æ ¡å‡†æ–¹æ³•ï¼Œä»¥ä¾¿å¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šï¼ˆå¹³å‡åœ°ï¼‰æ¶ˆé™¤æ­¤è¯¯å·®ã€‚  æ ¡å‡†åï¼Œç»“æœå°†æ›´å‡†ç¡®ï¼ˆåœ¨æœ€å°äºŒä¹˜æ„ä¹‰ä¸Šï¼‰ï¼Œä½†å®ƒæœ‰æ—¶ä¼šäº§ç”Ÿè´Ÿæ•°ï¼ˆå½“è°ƒç”¨è®¡æ•°å¼‚å¸¸ä½ï¼Œä¸”æ¦‚ç‡ä¹‹ç¥å¯¹æ‚¨ä¸åˆ©æ—¶ï¼š-ï¼‰ã€‚å› æ­¤ <em>ä¸è¦</em> å¯¹äº§ç”Ÿçš„è´Ÿæ•°æ„Ÿåˆ°æƒŠæ…Œã€‚å®ƒä»¬åº”è¯¥åªåœ¨ä½ æ‰‹å·¥æ ¡å‡†åˆ†æå™¨çš„æƒ…å†µä¸‹æ‰ä¼šå‡ºç°ï¼Œå®é™…ä¸Šç»“æœæ¯”æ²¡æœ‰æ ¡å‡†çš„æƒ…å†µè¦å¥½ã€‚</p>
</div>
<div class="section" id="calibration">
<span id="profile-calibration"></span><h2>å‡†ç¡®ä¼°é‡<a class="headerlink" href="#calibration" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p><a class="reference internal" href="#module-profile" title="profile: Python source profiler."><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code></a> æ¨¡å—çš„ profiler ä¼šä»æ¯ä¸ªäº‹ä»¶å¤„ç†æ—¶é—´ä¸­å‡å»ä¸€ä¸ªå¸¸é‡ï¼Œä»¥è¡¥å¿è°ƒç”¨ time å‡½æ•°å’Œå­˜å‚¨ç»“æœçš„å¼€é”€ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¸¸æ•°ä¸º0ã€‚å¯¹äºç‰¹å®šçš„å¹³å°ï¼Œå¯ç”¨ä»¥ä¸‹ç¨‹åºè·å¾—æ›´å¥½ä¿®æ­£å¸¸æ•°ï¼ˆ <a class="reference internal" href="#profile-limitations"><span class="std std-ref">å±€é™æ€§</span></a> ï¼‰ã€‚</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">profile</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pr</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
</pre></div>
</div>
<p>The method executes the number of Python calls given by the argument, directly
and again under the profiler, measuring the time for both. It then computes the
hidden overhead per profiler event, and returns that as a float.  For example,
on a 1.8Ghz Intel Core i5 running Mac OS X, and using Python's time.process_time() as
the timer, the magical number is about 4.04e-6.</p>
<p>The object of this exercise is to get a fairly consistent result. If your
computer is <em>very</em> fast, or your timer function has poor resolution, you might
have to pass 100000, or even 1000000, to get consistent results.</p>
<p>å½“ä½ æœ‰ä¸€ä¸ªä¸€è‡´çš„ç­”æ¡ˆæ—¶ï¼Œæœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ï¼š</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">profile</span>

<span class="c1"># 1. Apply computed bias to all Profile instances created hereafter.</span>
<span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">your_computed_bias</span>

<span class="c1"># 2. Apply computed bias to a specific Profile instance.</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="n">pr</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">your_computed_bias</span>

<span class="c1"># 3. Specify computed bias in instance constructor.</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="n">your_computed_bias</span><span class="p">)</span>
</pre></div>
</div>
<p>If you have a choice, you are better off choosing a smaller constant, and then
your results will &quot;less often&quot; show up as negative in profile statistics.</p>
</div>
<div class="section" id="using-a-custom-timer">
<span id="profile-timers"></span><h2>ä½¿ç”¨è‡ªå®šä¹‰è®¡æ—¶å™¨<a class="headerlink" href="#using-a-custom-timer" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>If you want to change how current time is determined (for example, to force use
of wall-clock time or elapsed process time), pass the timing function you want
to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> class constructor:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">your_time_func</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting profiler will then call <code class="docutils literal notranslate"><span class="pre">your_time_func</span></code>. Depending on whether
you are using <a class="reference internal" href="#profile.Profile" title="profile.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">profile.Profile</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code>,
<code class="docutils literal notranslate"><span class="pre">your_time_func</span></code>'s return value will be interpreted differently:</p>
<dl>
<dt><a class="reference internal" href="#profile.Profile" title="profile.Profile"><code class="xref py py-class docutils literal notranslate"><span class="pre">profile.Profile</span></code></a></dt><dd><p><code class="docutils literal notranslate"><span class="pre">your_time_func</span></code> should return a single number, or a list of numbers whose
sum is the current time (like what <a class="reference internal" href="os.html#os.times" tppabs="https://docs.python.org/zh-cn/3/library/os.html#os.times" title="os.times"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.times()</span></code></a> returns).  If the
function returns a single time number, or the list of returned numbers has
length 2, then you will get an especially fast version of the dispatch
routine.</p>
<p>Be warned that you should calibrate the profiler class for the timer function
that you choose (see <a class="reference internal" href="#profile-calibration"><span class="std std-ref">å‡†ç¡®ä¼°é‡</span></a>).  For most machines, a timer
that returns a lone integer value will provide the best results in terms of
low overhead during profiling.  (<a class="reference internal" href="os.html#os.times" tppabs="https://docs.python.org/zh-cn/3/library/os.html#os.times" title="os.times"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.times()</span></code></a> is <em>pretty</em> bad, as it
returns a tuple of floating point values).  If you want to substitute a
better timer in the cleanest fashion, derive a class and hardwire a
replacement dispatch method that best handles your timer call, along with the
appropriate calibration constant.</p>
</dd>
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">your_time_func</span></code> should return a single number.  If it returns integers,
you can also invoke the class constructor with a second argument specifying
the real duration of one unit of time.  For example, if
<code class="docutils literal notranslate"><span class="pre">your_integer_time_func</span></code> returns times measured in thousands of seconds,
you would construct the <code class="xref py py-class docutils literal notranslate"><span class="pre">Profile</span></code> instance as follows:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">(</span><span class="n">your_integer_time_func</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<p>As the <code class="xref py py-class docutils literal notranslate"><span class="pre">cProfile.Profile</span></code> class cannot be calibrated, custom timer
functions should be used with care and should be as fast as possible.  For
the best results with a custom timer, it might be necessary to hard-code it
in the C source of the internal <code class="xref py py-mod docutils literal notranslate"><span class="pre">_lsprof</span></code> module.</p>
</dd>
</dl>
<p>Python 3.3 adds several new functions in <a class="reference internal" href="time.html#module-time" tppabs="https://docs.python.org/zh-cn/3/library/time.html#module-time" title="time: Time access and conversions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">time</span></code></a> that can be used to make
precise measurements of process or wall-clock time. For example, see
<a class="reference internal" href="time.html#time.perf_counter" tppabs="https://docs.python.org/zh-cn/3/library/time.html#time.perf_counter" title="time.perf_counter"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.perf_counter()</span></code></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html" tppabs="https://docs.python.org/zh-cn/3/contents.html">ç›®å½•</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python Profilers åˆ†æå™¨</a><ul>
<li><a class="reference internal" href="#introduction-to-the-profilers">profileåˆ†æå™¨ç®€ä»‹</a></li>
<li><a class="reference internal" href="#instant-user-s-manual">å®æ—¶ç”¨æˆ·æ‰‹å†Œ</a></li>
<li><a class="reference internal" href="#module-cProfile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">profile</span></code> å’Œ <code class="xref py py-mod docutils literal notranslate"><span class="pre">cProfile</span></code> æ¨¡å—å‚è€ƒ</a></li>
<li><a class="reference internal" href="#the-stats-class"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code> ç±»</a></li>
<li><a class="reference internal" href="#what-is-deterministic-profiling">ä»€ä¹ˆæ˜¯ç¡®å®šæ€§æ€§èƒ½åˆ†æï¼Ÿ</a></li>
<li><a class="reference internal" href="#limitations">å±€é™æ€§</a></li>
<li><a class="reference internal" href="#calibration">å‡†ç¡®ä¼°é‡</a></li>
<li><a class="reference internal" href="#using-a-custom-timer">ä½¿ç”¨è‡ªå®šä¹‰è®¡æ—¶å™¨</a></li>
</ul>
</li>
</ul>

  <h4>ä¸Šä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="pdb.html" tppabs="https://docs.python.org/zh-cn/3/library/pdb.html"
                        title="ä¸Šä¸€ç« "><code class="xref py py-mod docutils literal notranslate"><span class="pre">pdb</span></code> --- Pythonçš„è°ƒè¯•å™¨</a></p>
  <h4>ä¸‹ä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="timeit.html" tppabs="https://docs.python.org/zh-cn/3/library/timeit.html"
                        title="ä¸‹ä¸€ç« "><code class="xref py py-mod docutils literal notranslate"><span class="pre">timeit</span></code> --- æµ‹é‡å°ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´</a></p>
  <div role="note" aria-label="source link">
    <h3>æœ¬é¡µ</h3>
    <ul class="this-page-menu">
      <li><a href="bugs.html" tppabs="https://docs.python.org/zh-cn/3/bugs.html">æäº¤ Bug</a></li>
      <li>
        <a href="javascript:if(confirm('https://github.com/python/cpython/blob/3.8/Doc/library/profile.rst  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/python/cpython/blob/3.8/Doc/library/profile.rst'" tppabs="https://github.com/python/cpython/blob/3.8/Doc/library/profile.rst"
            rel="nofollow">æ˜¾ç¤ºæºä»£ç 
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             >ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="timeit.html" tppabs="https://docs.python.org/zh-cn/3/library/timeit.html" title="timeit --- æµ‹é‡å°ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´"
             >ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="pdb.html" tppabs="https://docs.python.org/zh-cn/3/library/pdb.html" title="pdb --- Pythonçš„è°ƒè¯•å™¨"
             >ä¸Šä¸€é¡µ</a> |</li>

    <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
    

    <li>
      <span class="language_switcher_placeholder">zh_CN</span>
      <span class="version_switcher_placeholder">3.8.2</span>
      <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index-2.html" tppabs="https://docs.python.org/zh-cn/3/library/index.html" >Python æ ‡å‡†åº“</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="debug.html" tppabs="https://docs.python.org/zh-cn/3/library/debug.html" >è°ƒè¯•å’Œåˆ†æ</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="copyright.html" tppabs="https://docs.python.org/zh-cn/3/copyright.html">ç‰ˆæƒæ‰€æœ‰</a> 2001-2020, Python Software Foundation.
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="javascript:if(confirm('https://www.python.org/psf/donations/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/psf/donations/'" tppabs="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    æœ€åæ›´æ–°äº 3æœˆ 26, 2020.
    <a href="javascript:if(confirm('https://docs.python.org/3/bugs.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.python.org/3/bugs.html'" tppabs="https://docs.python.org/3/bugs.html">Found a bug</a>?
    <br />

    Created using <a href="javascript:if(confirm('https://www.sphinx-doc.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.sphinx-doc.org/'" tppabs="https://www.sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>

  </body>
</html>