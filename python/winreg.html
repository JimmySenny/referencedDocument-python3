
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <title>winreg --- Windows æ³¨å†Œè¡¨è®¿é—® &#8212; Python 3.8.2 æ–‡æ¡£</title>
    <link rel="stylesheet" href="pydoctheme.css" tppabs="https://docs.python.org/zh-cn/3/_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="pygments.css" tppabs="https://docs.python.org/zh-cn/3/_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="documentation_options.js" tppabs="https://docs.python.org/zh-cn/3/_static/documentation_options.js"></script>
    <script type="text/javascript" src="jquery.js" tppabs="https://docs.python.org/zh-cn/3/_static/jquery.js"></script>
    <script type="text/javascript" src="underscore.js" tppabs="https://docs.python.org/zh-cn/3/_static/underscore.js"></script>
    <script type="text/javascript" src="doctools.js" tppabs="https://docs.python.org/zh-cn/3/_static/doctools.js"></script>
    <script type="text/javascript" src="language_data.js" tppabs="https://docs.python.org/zh-cn/3/_static/language_data.js"></script>
    <script type="text/javascript" src="translations.js" tppabs="https://docs.python.org/zh-cn/3/_static/translations.js"></script>
    
    <script type="text/javascript" src="sidebar.js" tppabs="https://docs.python.org/zh-cn/3/_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="åœ¨ Python 3.8.2 æ–‡æ¡£ ä¸­æœç´¢"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="å…³äºè¿™äº›æ–‡æ¡£" href="../about.html" />
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æœç´¢" href="../search.html" />
    <link rel="copyright" title="ç‰ˆæƒæ‰€æœ‰" href="../copyright.html" />
    <link rel="next" title="winsound --- Sound-playing interface for Windows" href="winsound.html" />
    <link rel="prev" title="msvcrt --- Useful routines from the MS VC++ runtime" href="msvcrt.html" />
    <link rel="canonical" href="https://docs.python.org/3/library/winreg.html" />
    
      
      <script type="text/javascript" src="switchers.js" tppabs="https://docs.python.org/zh-cn/3/_static/switchers.js"></script>
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>

    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    
    <script type="text/javascript" src="copybutton.js" tppabs="https://docs.python.org/zh-cn/3/_static/copybutton.js"></script>
    
     


  </head><body>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             accesskey="I">ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="winsound.html" tppabs="https://docs.python.org/zh-cn/3/library/winsound.html" title="winsound --- Sound-playing interface for Windows"
             accesskey="N">ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="msvcrt.html" tppabs="https://docs.python.org/zh-cn/3/library/msvcrt.html" title="msvcrt --- Useful routines from the MS VC++ runtime"
             accesskey="P">ä¸Šä¸€é¡µ</a> |</li>

    <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
    

    <li>
      <span class="language_switcher_placeholder">zh_CN</span>
      <span class="version_switcher_placeholder">3.8.2</span>
      <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index-2.html" tppabs="https://docs.python.org/zh-cn/3/library/index.html" >Python æ ‡å‡†åº“</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="windows-1.html" tppabs="https://docs.python.org/zh-cn/3/library/windows.html" accesskey="U">Windowsç³»ç»Ÿç›¸å…³æ¨¡å—</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-winreg">
<span id="winreg-windows-registry-access"></span><h1><a class="reference internal" href="#module-winreg" title="winreg: Routines and objects for manipulating the Windows registry. (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">winreg</span></code></a> --- Windows æ³¨å†Œè¡¨è®¿é—®<a class="headerlink" href="#module-winreg" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h1>
<hr class="docutils" />
<p>è¿™äº›å‡½æ•°å°† Windows æ³¨å†Œè¡¨ API æš´éœ²ç»™ Pythonã€‚ä¸ºäº†ç¡®ä¿å³ä¾¿ç¨‹åºå‘˜å¿½ç•¥äº†æ˜¾å¼å…³é—­å¥æŸ„ï¼Œè¯¥å¥æŸ„ä¾ç„¶èƒ½å¤Ÿæ­£ç¡®å…³é—­ï¼Œå®ƒä½¿ç”¨äº†ä¸€ä¸ª <a class="reference internal" href="#handle-object"><span class="std std-ref">handle å¯¹è±¡</span></a> è€Œä¸æ˜¯æ•´æ•°æ¥ä½œä¸ºæ³¨å†Œè¡¨å¥æŸ„ã€‚</p>
<div class="versionchanged" id="exception-changed">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>è¯¥æ¨¡å—ä¸­çš„å‡ ä¸ªå‡½æ•°è¢«ç”¨äºå¼•å‘ <a class="reference internal" href="exceptions.html#WindowsError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#WindowsError" title="WindowsError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">WindowsError</span></code></a>ï¼Œè¯¥å¼‚å¸¸ç°åœ¨æ˜¯ <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> çš„åˆ«åã€‚</p>
</div>
<div class="section" id="functions">
<span id="id1"></span><h2>å‡½æ•°<a class="headerlink" href="#functions" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>è¯¥æ¨¡å—æä¾›äº†ä¸‹åˆ—å‡½æ•°ï¼š</p>
<dl class="function">
<dt id="winreg.CloseKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">CloseKey</code><span class="sig-paren">(</span><em class="sig-param">hkey</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CloseKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å…³é—­ä¹‹å‰æ‰“å¼€çš„æ³¨å†Œè¡¨é”®ã€‚å‚æ•° <em>hkey</em> æŒ‡ä¹‹å‰æ‰“å¼€çš„é”®ã€‚</p>
<div class="admonition note">
<p class="admonition-title">æ³¨è§£</p>
<p>å¦‚æœæ²¡æœ‰ä½¿ç”¨è¯¥æ–¹æ³•å…³é—­ <em>hkey</em> (æˆ–è€…é€šè¿‡ <a class="reference internal" href="#winreg.PyHKEY.Close" title="winreg.PyHKEY.Close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hkey.Close()</span></code></a>)ï¼Œåœ¨å¯¹è±¡ <em>hkey</em> è¢« Python é”€æ¯æ—¶ä¼šå°†å…¶å…³é—­ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.ConnectRegistry">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">ConnectRegistry</code><span class="sig-paren">(</span><em class="sig-param">computer_name</em>, <em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.ConnectRegistry" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å»ºç«‹åˆ°å¦ä¸€å°è®¡ç®—ä¸Šä¸Šçš„é¢„å®šä¹‰æ³¨å†Œè¡¨å¥æŸ„çš„è¿æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ª <a class="reference internal" href="#handle-object"><span class="std std-ref">handle å¯¹è±¡</span></a>.</p>
<p><em>computer_name</em> æ˜¯è¿œç¨‹è®¡ç®—æœºçš„åç§°ï¼Œä»¥ <code class="docutils literal notranslate"><span class="pre">r&quot;\\computername&quot;</span></code> çš„å½¢å¼ã€‚å¦‚æœæ˜¯ <code class="docutils literal notranslate"><span class="pre">None</span></code> ï¼Œå°†ä¼šä½¿ç”¨æœ¬åœ°è®¡ç®—æœºã€‚</p>
<p><em>key</em> æ˜¯æ‰€è¿æ¥åˆ°çš„é¢„å®šä¹‰å¥æŸ„ã€‚</p>
<p>è¿”å›å€¼æ˜¯æ‰€å¼€æ‰“é”®çš„å¥æŸ„ã€‚å¦‚æœå‡½æ•°å¤±è´¥ï¼Œåˆ™å¼•å‘ä¸€ä¸ª <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.ConnectRegistry</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">computer_name</span></code>, <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.CreateKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">CreateKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CreateKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åˆ›å»ºæˆ–æ‰“å¼€ç‰¹å®šçš„é”®ï¼Œè¿”å›ä¸€ä¸ª <a class="reference internal" href="#handle-object"><span class="std std-ref">handle å¯¹è±¡</span></a>ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> æ˜¯ç”¨äºå‘½åè¯¥æ–¹æ³•æ‰€æ‰“å¼€æˆ–åˆ›å»ºçš„é”®çš„å­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœ <em>key</em> æ˜¯é¢„å®šä¹‰é”®ä¹‹ä¸€ï¼Œ<em>sub_key</em> å¯èƒ½ä¼šæ˜¯ <code class="docutils literal notranslate"><span class="pre">None</span></code>ã€‚è¯¥æƒ…å†µä¸‹ï¼Œè¿”å›çš„å¥æŸ„å°±æ˜¯ä¼ å…¥å‡½æ•°çš„å¥æŸ„ã€‚</p>
<p>å¦‚æœé”®å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¥å‡½æ•°æ‰“å¼€å·²ç»å­˜åœ¨çš„è¯¥é”®ã€‚</p>
<p>è¿”å›å€¼æ˜¯æ‰€å¼€æ‰“é”®çš„å¥æŸ„ã€‚å¦‚æœå‡½æ•°å¤±è´¥ï¼Œåˆ™å¼•å‘ä¸€ä¸ª <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.CreateKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey/result</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.CreateKeyEx">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">CreateKeyEx</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em>, <em class="sig-param">reserved=0</em>, <em class="sig-param">access=KEY_WRITE</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.CreateKeyEx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åˆ›å»ºæˆ–æ‰“å¼€ç‰¹å®šçš„é”®ï¼Œè¿”å›ä¸€ä¸ª <a class="reference internal" href="#handle-object"><span class="std std-ref">handle å¯¹è±¡</span></a>ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> æ˜¯ç”¨äºå‘½åè¯¥æ–¹æ³•æ‰€æ‰“å¼€æˆ–åˆ›å»ºçš„é”®çš„å­—ç¬¦ä¸²ã€‚</p>
<p><em>reserved</em> æ˜¯ä¸€ä¸ªä¿ç•™çš„è¯ä¹¦ï¼Œå¿…é¡»æ˜¯é›¶ã€‚é»˜è®¤å€¼ä¸ºé›¶ã€‚</p>
<p><em>access</em> ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºç»™é”®çš„é¢„æœŸå®‰å…¨è®¿é—®æŒ‡å®šè®¿é—®æ©ç ã€‚é»˜è®¤å€¼ä¸º <a class="reference internal" href="#winreg.KEY_WRITE" title="winreg.KEY_WRITE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_WRITE</span></code></a>ã€‚ å‚é˜… <a class="reference internal" href="#access-rights"><span class="std std-ref">Access Rights</span></a>  äº†è§£å…¶å®ƒå…è®¸å€¼ã€‚</p>
<p>å¦‚æœ <em>key</em> æ˜¯é¢„å®šä¹‰é”®ä¹‹ä¸€ï¼Œ<em>sub_key</em> å¯èƒ½ä¼šæ˜¯ <code class="docutils literal notranslate"><span class="pre">None</span></code>ã€‚è¯¥æƒ…å†µä¸‹ï¼Œè¿”å›çš„å¥æŸ„å°±æ˜¯ä¼ å…¥å‡½æ•°çš„å¥æŸ„ã€‚</p>
<p>å¦‚æœé”®å·²ç»å­˜åœ¨ï¼Œåˆ™è¯¥å‡½æ•°æ‰“å¼€å·²ç»å­˜åœ¨çš„è¯¥é”®ã€‚</p>
<p>è¿”å›å€¼æ˜¯æ‰€å¼€æ‰“é”®çš„å¥æŸ„ã€‚å¦‚æœå‡½æ•°å¤±è´¥ï¼Œåˆ™å¼•å‘ä¸€ä¸ª <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.CreateKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey/result</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
<div class="versionadded">
<p><span class="versionmodified added">3.2 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">DeleteKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åˆ é™¤æŒ‡å®šçš„é”®ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> è¿™ä¸ªå­—ç¬¦ä¸²å¿…é¡»æ˜¯ç”± <em>key</em> å‚æ•°æ‰€æŒ‡å®šé”®çš„ä¸€ä¸ªå­é¡¹ã€‚è¯¥å€¼é¡¹ä¸å¯ä»¥æ˜¯ <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼ŒåŒæ—¶é”®ä¹Ÿä¸å¯ä»¥æœ‰å­é¡¹ã€‚</p>
<p><em>è¯¥æ–¹æ³•ä¸èƒ½åˆ é™¤å¸¦æœ‰å­é¡¹çš„é”®ã€‚</em></p>
<p>å¦‚æœæ–¹æ³•æˆåŠŸï¼Œåˆ™æ•´ä¸ªé”®ï¼ŒåŒ…æ‹¬å…¶æ‰€æœ‰å€¼é¡¹éƒ½ä¼šè¢«ç§»é™¤ã€‚å¦‚æœæ–¹æ³•å¤±è´¥ï¼Œåˆ™å¼•å‘ä¸€ä¸ª <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DeleteKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteKeyEx">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">DeleteKeyEx</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em>, <em class="sig-param">access=KEY_WOW64_64KEY</em>, <em class="sig-param">reserved=0</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteKeyEx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åˆ é™¤æŒ‡å®šçš„é”®ã€‚</p>
<div class="admonition note">
<p class="admonition-title">æ³¨è§£</p>
<p>å‡½æ•° <a class="reference internal" href="#winreg.DeleteKeyEx" title="winreg.DeleteKeyEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">DeleteKeyEx()</span></code></a> é€šè¿‡ RegDeleteKeyEx è¿™ä¸ª Windows API å‡½æ•°å®ç°ï¼Œè¯¥å‡½æ•°ä¸º Windows çš„64ä½ç‰ˆæœ¬ä¸“å±ã€‚ å‚é˜… <a class="reference external" href="javascript:if(confirm('https://msdn.microsoft.com/en-us/library/issue34118  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://msdn.microsoft.com/en-us/library/issue34118'" tppabs="https://msdn.microsoft.com/en-us/library/ms724847%28VS.85%29.aspx">RegDeleteKeyEx æ–‡æ¡£</a>ã€‚</p>
</div>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> è¿™ä¸ªå­—ç¬¦ä¸²å¿…é¡»æ˜¯ç”± <em>key</em> å‚æ•°æ‰€æŒ‡å®šé”®çš„ä¸€ä¸ªå­é¡¹ã€‚è¯¥å€¼é¡¹ä¸å¯ä»¥æ˜¯ <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼ŒåŒæ—¶é”®ä¹Ÿä¸å¯ä»¥æœ‰å­é¡¹ã€‚</p>
<p><em>reserved</em> æ˜¯ä¸€ä¸ªä¿ç•™çš„è¯ä¹¦ï¼Œå¿…é¡»æ˜¯é›¶ã€‚é»˜è®¤å€¼ä¸ºé›¶ã€‚</p>
<p><em>access</em> ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºç»™é”®çš„é¢„æœŸå®‰å…¨è®¿é—®æŒ‡å®šè®¿é—®æ©ç ã€‚é»˜è®¤å€¼ä¸ºå¸¸é‡ <code class="xref py py-const docutils literal notranslate"><span class="pre">_WOW64_64KEY</span></code> ã€‚å‚é˜… <a class="reference internal" href="#access-rights"><span class="std std-ref">Access Rights</span></a>  äº†è§£å…¶å®ƒå…è®¸å€¼ã€‚</p>
<p><em>è¯¥æ–¹æ³•ä¸èƒ½åˆ é™¤å¸¦æœ‰å­é¡¹çš„é”®ã€‚</em></p>
<p>å¦‚æœæ–¹æ³•æˆåŠŸï¼Œåˆ™æ•´ä¸ªé”®ï¼ŒåŒ…æ‹¬å…¶æ‰€æœ‰å€¼é¡¹éƒ½ä¼šè¢«ç§»é™¤ã€‚å¦‚æœæ–¹æ³•å¤±è´¥ï¼Œåˆ™å¼•å‘ä¸€ä¸ª <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ã€‚</p>
<p>åœ¨ä¸æ”¯æŒçš„ Windows ç‰ˆæœ¬ä¹‹ä¸Šï¼Œå°†ä¼šå¼•å‘ <a class="reference internal" href="exceptions.html#NotImplementedError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> å¼‚å¸¸ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DeleteKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>ã€‚</p>
<div class="versionadded">
<p><span class="versionmodified added">3.2 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.DeleteValue">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">DeleteValue</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DeleteValue" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>ä»æŸä¸ªæ³¨å†Œé”®ä¸­åˆ é™¤ä¸€ä¸ªå‘½åå€¼é¡¹ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>value</em> ä¸ºæ ‡è¯†æ‰€è¦åˆ é™¤å€¼é¡¹çš„å­—ç¬¦ä¸²ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DeleteValue</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.EnumKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">EnumKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">index</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnumKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åˆ—ä¸¾æŸä¸ªå·²ç»æ‰“å¼€æ³¨å†Œè¡¨é”®çš„å­é¡¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>index</em> ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºæ ‡è¯†æ‰€è·å–é”®çš„ç´¢å¼•ã€‚</p>
<p>æ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°éƒ½ä¼šè·å–ä¸€ä¸ªå­é¡¹çš„åå­—ã€‚é€šå¸¸å®ƒä¼šè¢«åå¤è°ƒç”¨ï¼Œç›´åˆ°å¼•å‘ <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ï¼Œè¿™è¯´æ˜å·²ç»æ²¡æœ‰æ›´å¤šçš„å¯ç”¨å€¼äº†ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.EnumKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.EnumValue">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">EnumValue</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">index</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnumValue" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>åˆ—ä¸¾æŸä¸ªå·²ç»æ‰“å¼€æ³¨å†Œè¡¨é”®çš„å€¼é¡¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªå…ƒç»„ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>index</em> ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºæ ‡è¯†è¦è·å–å€¼é¡¹çš„ç´¢å¼•ã€‚</p>
<p>æ¯æ¬¡è°ƒç”¨è¯¥å‡½æ•°éƒ½ä¼šè·å–ä¸€ä¸ªå­é¡¹çš„åå­—ã€‚é€šå¸¸å®ƒä¼šè¢«åå¤è°ƒç”¨ï¼Œç›´åˆ°å¼•å‘ <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> å¼‚å¸¸ï¼Œè¿™è¯´æ˜å·²ç»æ²¡æœ‰æ›´å¤šçš„å¯ç”¨å€¼äº†ã€‚</p>
<p>ç»“æœä¸º3å…ƒç´ çš„å…ƒç»„ã€‚</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ç´¢å¼•</p></th>
<th class="head"><p>æ„ä¹‰</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>ç”¨äºæ ‡è¯†å€¼é¡¹åç§°çš„å­—ç¬¦ä¸²ã€‚</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>ä¿å­˜å€¼é¡¹æ•°æ®çš„å¯¹è±¡ï¼Œå…¶ç±»å‹å–å†³äºèƒŒåçš„æ³¨å†Œè¡¨ç±»å‹ã€‚</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>æ ‡è¯†å€¼é¡¹æ•°æ®ç±»å‹çš„æ•´æ•°ã€‚ï¼ˆè¯·æŸ¥é˜… <a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a> æ–‡æ¡£ä¸­çš„è¡¨æ ¼ï¼‰</p></td>
</tr>
</tbody>
</table>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.EnumValue</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code>ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<span class="target" id="index-0"></span><dl class="function">
<dt id="winreg.ExpandEnvironmentStrings">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">ExpandEnvironmentStrings</code><span class="sig-paren">(</span><em class="sig-param">str</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.ExpandEnvironmentStrings" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Expands environment variable placeholders <code class="docutils literal notranslate"><span class="pre">%NAME%</span></code> in strings like
<a class="reference internal" href="#winreg.REG_EXPAND_SZ" title="winreg.REG_EXPAND_SZ"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_EXPAND_SZ</span></code></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExpandEnvironmentStrings</span><span class="p">(</span><span class="s1">&#39;%windir%&#39;</span><span class="p">)</span>
<span class="go">&#39;C:\\Windows&#39;</span>
</pre></div>
</div>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.ExpandEnvironmentStrings</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">str</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.FlushKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">FlushKey</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.FlushKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å°†æŸä¸ªé”®çš„æ‰€æœ‰å±æ€§å†™å…¥æ³¨å†Œè¡¨ã€‚</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p>It is not necessary to call <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> to change a key. Registry changes are
flushed to disk by the registry using its lazy flusher.  Registry changes are
also flushed to disk at system shutdown.  Unlike <a class="reference internal" href="#winreg.CloseKey" title="winreg.CloseKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CloseKey()</span></code></a>, the
<a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> method returns only when all the data has been written to the
registry. An application should only call <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> if it requires
absolute certainty that registry changes are on disk.</p>
<div class="admonition note">
<p class="admonition-title">æ³¨è§£</p>
<p>If you don't know whether a <a class="reference internal" href="#winreg.FlushKey" title="winreg.FlushKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">FlushKey()</span></code></a> call is required, it probably
isn't.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.LoadKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">LoadKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em>, <em class="sig-param">file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.LoadKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Creates a subkey under the specified key and stores registration information
from a specified file into that subkey.</p>
<p><em>key</em> is a handle returned by <a class="reference internal" href="#winreg.ConnectRegistry" title="winreg.ConnectRegistry"><code class="xref py py-func docutils literal notranslate"><span class="pre">ConnectRegistry()</span></code></a> or one of the constants
<a class="reference internal" href="#winreg.HKEY_USERS" title="winreg.HKEY_USERS"><code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_USERS</span></code></a> or <a class="reference internal" href="#winreg.HKEY_LOCAL_MACHINE" title="winreg.HKEY_LOCAL_MACHINE"><code class="xref py py-const docutils literal notranslate"><span class="pre">HKEY_LOCAL_MACHINE</span></code></a>.</p>
<p><em>sub_key</em> is a string that identifies the subkey to load.</p>
<p><em>file_name</em> is the name of the file to load registry data from. This file must
have been created with the <a class="reference internal" href="#winreg.SaveKey" title="winreg.SaveKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">SaveKey()</span></code></a> function. Under the file allocation
table (FAT) file system, the filename may not have an extension.</p>
<p>A call to <a class="reference internal" href="#winreg.LoadKey" title="winreg.LoadKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">LoadKey()</span></code></a> fails if the calling process does not have the
<code class="xref py py-const docutils literal notranslate"><span class="pre">SE_RESTORE_PRIVILEGE</span></code> privilege.  Note that privileges are different
from permissions -- see the <a class="reference external" href="javascript:if(confirm('https://msdn.microsoft.com/en-us/library/issue38792  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://msdn.microsoft.com/en-us/library/issue38792'" tppabs="https://msdn.microsoft.com/en-us/library/ms724889%28v=VS.85%29.aspx">RegLoadKey documentation</a> for
more details.</p>
<p>If <em>key</em> is a handle returned by <a class="reference internal" href="#winreg.ConnectRegistry" title="winreg.ConnectRegistry"><code class="xref py py-func docutils literal notranslate"><span class="pre">ConnectRegistry()</span></code></a>, then the path
specified in <em>file_name</em> is relative to the remote computer.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.LoadKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">file_name</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.OpenKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">OpenKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em>, <em class="sig-param">reserved=0</em>, <em class="sig-param">access=KEY_READ</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.OpenKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dt id="winreg.OpenKeyEx">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">OpenKeyEx</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em>, <em class="sig-param">reserved=0</em>, <em class="sig-param">access=KEY_READ</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.OpenKeyEx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Opens the specified key, returning a <a class="reference internal" href="#handle-object"><span class="std std-ref">handle object</span></a>.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> is a string that identifies the sub_key to open.</p>
<p><em>reserved</em> is a reserved integer, and must be zero.  The default is zero.</p>
<p><em>access</em> is an integer that specifies an access mask that describes the desired
security access for the key.  Default is <a class="reference internal" href="#winreg.KEY_READ" title="winreg.KEY_READ"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_READ</span></code></a>.  See <a class="reference internal" href="#access-rights"><span class="std std-ref">Access
Rights</span></a> for other allowed values.</p>
<p>The result is a new handle to the specified key.</p>
<p>If the function fails, <a class="reference internal" href="exceptions.html#OSError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> is raised.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>ã€‚</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.OpenKey/result</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.2 ç‰ˆæ›´æ”¹: </span>Allow the use of named arguments.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">åœ¨ 3.3 ç‰ˆæ›´æ”¹: </span>å‚è€ƒ <a class="reference internal" href="#exception-changed"><span class="std std-ref">ä¸Šæ–‡</span></a>ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryInfoKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">QueryInfoKey</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryInfoKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Returns information about a key, as a tuple.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p>ç»“æœä¸º3å…ƒç´ çš„å…ƒç»„ã€‚</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ç´¢å¼•</p></th>
<th class="head"><p>æ„ä¹‰</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>An integer giving the number of sub keys
this key has.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>An integer giving the number of values this
key has.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p>An integer giving when the key was last
modified (if available) as 100's of
nanoseconds since Jan 1, 1601.</p></td>
</tr>
</tbody>
</table>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryInfoKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryValue">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">QueryValue</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryValue" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Retrieves the unnamed value for a key, as a string.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> is a string that holds the name of the subkey with which the value is
associated.  If this parameter is <code class="docutils literal notranslate"><span class="pre">None</span></code> or empty, the function retrieves the
value set by the <a class="reference internal" href="#winreg.SetValue" title="winreg.SetValue"><code class="xref py py-func docutils literal notranslate"><span class="pre">SetValue()</span></code></a> method for the key identified by <em>key</em>.</p>
<p>Values in the registry have name, type, and data components. This method
retrieves the data for a key's first value that has a <code class="docutils literal notranslate"><span class="pre">NULL</span></code> name. But the
underlying API call doesn't return the type, so always use
<a class="reference internal" href="#winreg.QueryValueEx" title="winreg.QueryValueEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">QueryValueEx()</span></code></a> if possible.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryValue</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">value_name</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryValueEx">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">QueryValueEx</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryValueEx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Retrieves the type and data for a specified value name associated with
an open registry key.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>value_name</em> is a string indicating the value to query.</p>
<p>The result is a tuple of 2 items:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ç´¢å¼•</p></th>
<th class="head"><p>æ„ä¹‰</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>The value of the registry item.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>An integer giving the registry type for
this value (see table in docs for
<a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a>)</p></td>
</tr>
</tbody>
</table>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryValue</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">value_name</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SaveKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">SaveKey</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">file_name</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SaveKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Saves the specified key, and all its subkeys to the specified file.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>file_name</em> is the name of the file to save registry data to.  This file
cannot already exist. If this filename includes an extension, it cannot be
used on file allocation table (FAT) file systems by the <a class="reference internal" href="#winreg.LoadKey" title="winreg.LoadKey"><code class="xref py py-meth docutils literal notranslate"><span class="pre">LoadKey()</span></code></a>
method.</p>
<p>If <em>key</em> represents a key on a remote computer, the path described by
<em>file_name</em> is relative to the remote computer. The caller of this method must
possess the <code class="xref py py-const docutils literal notranslate"><span class="pre">SeBackupPrivilege</span></code> security privilege.  Note that
privileges are different than permissions -- see the
<a class="reference external" href="javascript:if(confirm('https://msdn.microsoft.com/en-us/library/issue32989  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://msdn.microsoft.com/en-us/library/issue32989'" tppabs="https://msdn.microsoft.com/en-us/library/ms724878%28v=VS.85%29.aspx">Conflicts Between User Rights and Permissions documentation</a>
for more details.</p>
<p>This function passes <code class="docutils literal notranslate"><span class="pre">NULL</span></code> for <em>security_attributes</em> to the API.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.SaveKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">file_name</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SetValue">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">SetValue</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">sub_key</em>, <em class="sig-param">type</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SetValue" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Associates a value with a specified key.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>sub_key</em> is a string that names the subkey with which the value is associated.</p>
<p><em>type</em> is an integer that specifies the type of the data. Currently this must be
<a class="reference internal" href="#winreg.REG_SZ" title="winreg.REG_SZ"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_SZ</span></code></a>, meaning only strings are supported.  Use the <a class="reference internal" href="#winreg.SetValueEx" title="winreg.SetValueEx"><code class="xref py py-func docutils literal notranslate"><span class="pre">SetValueEx()</span></code></a>
function for support for other data types.</p>
<p><em>value</em> is a string that specifies the new value.</p>
<p>If the key specified by the <em>sub_key</em> parameter does not exist, the SetValue
function creates it.</p>
<p>Value lengths are limited by available memory. Long values (more than 2048
bytes) should be stored as files with the filenames stored in the configuration
registry.  This helps the registry perform efficiently.</p>
<p>The key identified by the <em>key</em> parameter must have been opened with
<a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a> access.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.SetValue</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.SetValueEx">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">SetValueEx</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">value_name</em>, <em class="sig-param">reserved</em>, <em class="sig-param">type</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.SetValueEx" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Stores data in the value field of an open registry key.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p><em>value_name</em> is a string that names the subkey with which the value is
associated.</p>
<p><em>reserved</em> can be anything -- zero is always passed to the API.</p>
<p><em>type</em> is an integer that specifies the type of the data. See
<a class="reference internal" href="#value-types"><span class="std std-ref">Value Types</span></a> for the available types.</p>
<p><em>value</em> is a string that specifies the new value.</p>
<p>This method can also set additional value and type information for the specified
key.  The key identified by the key parameter must have been opened with
<a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a> access.</p>
<p>To open the key, use the <a class="reference internal" href="#winreg.CreateKey" title="winreg.CreateKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CreateKey()</span></code></a> or <a class="reference internal" href="#winreg.OpenKey" title="winreg.OpenKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">OpenKey()</span></code></a> methods.</p>
<p>Value lengths are limited by available memory. Long values (more than 2048
bytes) should be stored as files with the filenames stored in the configuration
registry.  This helps the registry perform efficiently.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.SetValue</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>, <code class="docutils literal notranslate"><span class="pre">sub_key</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.DisableReflectionKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">DisableReflectionKey</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.DisableReflectionKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Disables registry reflection for 32-bit processes running on a 64-bit
operating system.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p>Will generally raise <a class="reference internal" href="exceptions.html#NotImplementedError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> if executed on a 32-bit operating
system.</p>
<p>If the key is not on the reflection list, the function succeeds but has no
effect.  Disabling reflection for a key does not affect reflection of any
subkeys.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.DisableReflectionKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.EnableReflectionKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">EnableReflectionKey</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.EnableReflectionKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Restores registry reflection for the specified disabled key.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p>Will generally raise <a class="reference internal" href="exceptions.html#NotImplementedError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> if executed on a 32-bit operating
system.</p>
<p>Restoring reflection for a key does not affect reflection of any subkeys.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.EnableReflectionKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="winreg.QueryReflectionKey">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">QueryReflectionKey</code><span class="sig-paren">(</span><em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.QueryReflectionKey" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Determines the reflection state for the specified key.</p>
<p><em>key</em> ä¸ºæŸä¸ªå·²ç»æ‰“å¼€çš„é”®ï¼Œæˆ–è€…é¢„å®šä¹‰çš„ <a class="reference internal" href="#hkey-constants"><span class="std std-ref">HKEY_* å¸¸é‡</span></a> ä¹‹ä¸€ã€‚</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if reflection is disabled.</p>
<p>Will generally raise <a class="reference internal" href="exceptions.html#NotImplementedError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> if executed on a 32-bit
operating system.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.QueryReflectionKey</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
</dd></dl>

</div>
<div class="section" id="constants">
<span id="id2"></span><h2>å¸¸æ•°<a class="headerlink" href="#constants" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>The following constants are defined for use in many <code class="xref py py-mod docutils literal notranslate"><span class="pre">_winreg</span></code> functions.</p>
<div class="section" id="hkey-constants">
<span id="id3"></span><h3>HKEY_* Constants<a class="headerlink" href="#hkey-constants" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h3>
<dl class="data">
<dt id="winreg.HKEY_CLASSES_ROOT">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_CLASSES_ROOT</code><a class="headerlink" href="#winreg.HKEY_CLASSES_ROOT" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Registry entries subordinate to this key define types (or classes) of
documents and the properties associated with those types. Shell and
COM applications use the information stored under this key.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_CURRENT_USER">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_CURRENT_USER</code><a class="headerlink" href="#winreg.HKEY_CURRENT_USER" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Registry entries subordinate to this key define the preferences of
the current user. These preferences include the settings of
environment variables, data about program groups, colors, printers,
network connections, and application preferences.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_LOCAL_MACHINE">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_LOCAL_MACHINE</code><a class="headerlink" href="#winreg.HKEY_LOCAL_MACHINE" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Registry entries subordinate to this key define the physical state
of the computer, including data about the bus type, system memory,
and installed hardware and software.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_USERS">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_USERS</code><a class="headerlink" href="#winreg.HKEY_USERS" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Registry entries subordinate to this key define the default user
configuration for new users on the local computer and the user
configuration for the current user.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_PERFORMANCE_DATA">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_PERFORMANCE_DATA</code><a class="headerlink" href="#winreg.HKEY_PERFORMANCE_DATA" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Registry entries subordinate to this key allow you to access
performance data. The data is not actually stored in the registry;
the registry functions cause the system to collect the data from
its source.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_CURRENT_CONFIG">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_CURRENT_CONFIG</code><a class="headerlink" href="#winreg.HKEY_CURRENT_CONFIG" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Contains information about the current hardware profile of the
local computer system.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.HKEY_DYN_DATA">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">HKEY_DYN_DATA</code><a class="headerlink" href="#winreg.HKEY_DYN_DATA" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>This key is not used in versions of Windows after 98.</p>
</dd></dl>

</div>
<div class="section" id="access-rights">
<span id="id4"></span><h3>Access Rights<a class="headerlink" href="#access-rights" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h3>
<p>For more information, see <a class="reference external" href="javascript:if(confirm('https://msdn.microsoft.com/en-us/library/issue32989  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://msdn.microsoft.com/en-us/library/issue32989'" tppabs="https://msdn.microsoft.com/en-us/library/ms724878%28v=VS.85%29.aspx">Registry Key Security and Access</a>.</p>
<dl class="data">
<dt id="winreg.KEY_ALL_ACCESS">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_ALL_ACCESS</code><a class="headerlink" href="#winreg.KEY_ALL_ACCESS" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Combines the STANDARD_RIGHTS_REQUIRED, <a class="reference internal" href="#winreg.KEY_QUERY_VALUE" title="winreg.KEY_QUERY_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_QUERY_VALUE</span></code></a>,
<a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a>, <a class="reference internal" href="#winreg.KEY_CREATE_SUB_KEY" title="winreg.KEY_CREATE_SUB_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_CREATE_SUB_KEY</span></code></a>,
<a class="reference internal" href="#winreg.KEY_ENUMERATE_SUB_KEYS" title="winreg.KEY_ENUMERATE_SUB_KEYS"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_ENUMERATE_SUB_KEYS</span></code></a>, <a class="reference internal" href="#winreg.KEY_NOTIFY" title="winreg.KEY_NOTIFY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_NOTIFY</span></code></a>,
and <a class="reference internal" href="#winreg.KEY_CREATE_LINK" title="winreg.KEY_CREATE_LINK"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_CREATE_LINK</span></code></a> access rights.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_WRITE">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_WRITE</code><a class="headerlink" href="#winreg.KEY_WRITE" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Combines the STANDARD_RIGHTS_WRITE, <a class="reference internal" href="#winreg.KEY_SET_VALUE" title="winreg.KEY_SET_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_SET_VALUE</span></code></a>, and
<a class="reference internal" href="#winreg.KEY_CREATE_SUB_KEY" title="winreg.KEY_CREATE_SUB_KEY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_CREATE_SUB_KEY</span></code></a> access rights.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_READ">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_READ</code><a class="headerlink" href="#winreg.KEY_READ" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Combines the STANDARD_RIGHTS_READ, <a class="reference internal" href="#winreg.KEY_QUERY_VALUE" title="winreg.KEY_QUERY_VALUE"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_QUERY_VALUE</span></code></a>,
<a class="reference internal" href="#winreg.KEY_ENUMERATE_SUB_KEYS" title="winreg.KEY_ENUMERATE_SUB_KEYS"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_ENUMERATE_SUB_KEYS</span></code></a>, and <a class="reference internal" href="#winreg.KEY_NOTIFY" title="winreg.KEY_NOTIFY"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_NOTIFY</span></code></a> values.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_EXECUTE">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_EXECUTE</code><a class="headerlink" href="#winreg.KEY_EXECUTE" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Equivalent to <a class="reference internal" href="#winreg.KEY_READ" title="winreg.KEY_READ"><code class="xref py py-const docutils literal notranslate"><span class="pre">KEY_READ</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_QUERY_VALUE">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_QUERY_VALUE</code><a class="headerlink" href="#winreg.KEY_QUERY_VALUE" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Required to query the values of a registry key.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_SET_VALUE">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_SET_VALUE</code><a class="headerlink" href="#winreg.KEY_SET_VALUE" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Required to create, delete, or set a registry value.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_CREATE_SUB_KEY">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_CREATE_SUB_KEY</code><a class="headerlink" href="#winreg.KEY_CREATE_SUB_KEY" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Required to create a subkey of a registry key.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_ENUMERATE_SUB_KEYS">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_ENUMERATE_SUB_KEYS</code><a class="headerlink" href="#winreg.KEY_ENUMERATE_SUB_KEYS" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Required to enumerate the subkeys of a registry key.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_NOTIFY">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_NOTIFY</code><a class="headerlink" href="#winreg.KEY_NOTIFY" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Required to request change notifications for a registry key or for
subkeys of a registry key.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_CREATE_LINK">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_CREATE_LINK</code><a class="headerlink" href="#winreg.KEY_CREATE_LINK" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Reserved for system use.</p>
</dd></dl>

<div class="section" id="bit-specific">
<span id="bit-access-rights"></span><h4>64-bit Specific<a class="headerlink" href="#bit-specific" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h4>
<p>For more information, see <a class="reference external" href="javascript:if(confirm('https://msdn.microsoft.com/en-us/library/issue39080  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://msdn.microsoft.com/en-us/library/issue39080'" tppabs="https://msdn.microsoft.com/en-us/library/aa384129(v=VS.85).aspx">Accessing an Alternate Registry View</a>.</p>
<dl class="data">
<dt id="winreg.KEY_WOW64_64KEY">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_WOW64_64KEY</code><a class="headerlink" href="#winreg.KEY_WOW64_64KEY" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Indicates that an application on 64-bit Windows should operate on
the 64-bit registry view.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.KEY_WOW64_32KEY">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">KEY_WOW64_32KEY</code><a class="headerlink" href="#winreg.KEY_WOW64_32KEY" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Indicates that an application on 64-bit Windows should operate on
the 32-bit registry view.</p>
</dd></dl>

</div>
</div>
<div class="section" id="value-types">
<span id="id5"></span><h3>Value Types<a class="headerlink" href="#value-types" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h3>
<p>For more information, see <a class="reference external" href="javascript:if(confirm('https://msdn.microsoft.com/en-us/library/issue39031  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://msdn.microsoft.com/en-us/library/issue39031'" tppabs="https://msdn.microsoft.com/en-us/library/ms724884%28v=VS.85%29.aspx">Registry Value Types</a>.</p>
<dl class="data">
<dt id="winreg.REG_BINARY">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_BINARY</code><a class="headerlink" href="#winreg.REG_BINARY" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Binary data in any form.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_DWORD">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_DWORD</code><a class="headerlink" href="#winreg.REG_DWORD" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>32-bit number.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_DWORD_LITTLE_ENDIAN">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_DWORD_LITTLE_ENDIAN</code><a class="headerlink" href="#winreg.REG_DWORD_LITTLE_ENDIAN" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A 32-bit number in little-endian format. Equivalent to <a class="reference internal" href="#winreg.REG_DWORD" title="winreg.REG_DWORD"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_DWORD</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_DWORD_BIG_ENDIAN">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_DWORD_BIG_ENDIAN</code><a class="headerlink" href="#winreg.REG_DWORD_BIG_ENDIAN" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A 32-bit number in big-endian format.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_EXPAND_SZ">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_EXPAND_SZ</code><a class="headerlink" href="#winreg.REG_EXPAND_SZ" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Null-terminated string containing references to environment
variables (<code class="docutils literal notranslate"><span class="pre">%PATH%</span></code>).</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_LINK">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_LINK</code><a class="headerlink" href="#winreg.REG_LINK" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A Unicode symbolic link.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_MULTI_SZ">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_MULTI_SZ</code><a class="headerlink" href="#winreg.REG_MULTI_SZ" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A sequence of null-terminated strings, terminated by two null characters.
(Python handles this termination automatically.)</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_NONE">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_NONE</code><a class="headerlink" href="#winreg.REG_NONE" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>No defined value type.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_QWORD">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_QWORD</code><a class="headerlink" href="#winreg.REG_QWORD" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A 64-bit number.</p>
<div class="versionadded">
<p><span class="versionmodified added">3.6 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_QWORD_LITTLE_ENDIAN">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_QWORD_LITTLE_ENDIAN</code><a class="headerlink" href="#winreg.REG_QWORD_LITTLE_ENDIAN" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A 64-bit number in little-endian format. Equivalent to <a class="reference internal" href="#winreg.REG_QWORD" title="winreg.REG_QWORD"><code class="xref py py-const docutils literal notranslate"><span class="pre">REG_QWORD</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">3.6 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_RESOURCE_LIST">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_RESOURCE_LIST</code><a class="headerlink" href="#winreg.REG_RESOURCE_LIST" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A device-driver resource list.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_FULL_RESOURCE_DESCRIPTOR">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_FULL_RESOURCE_DESCRIPTOR</code><a class="headerlink" href="#winreg.REG_FULL_RESOURCE_DESCRIPTOR" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A hardware setting.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_RESOURCE_REQUIREMENTS_LIST">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_RESOURCE_REQUIREMENTS_LIST</code><a class="headerlink" href="#winreg.REG_RESOURCE_REQUIREMENTS_LIST" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A hardware resource list.</p>
</dd></dl>

<dl class="data">
<dt id="winreg.REG_SZ">
<code class="sig-prename descclassname">winreg.</code><code class="sig-name descname">REG_SZ</code><a class="headerlink" href="#winreg.REG_SZ" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>A null-terminated string.</p>
</dd></dl>

</div>
</div>
<div class="section" id="registry-handle-objects">
<span id="handle-object"></span><h2>Registry Handle Objects<a class="headerlink" href="#registry-handle-objects" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>This object wraps a Windows HKEY object, automatically closing it when the
object is destroyed.  To guarantee cleanup, you can call either the
<a class="reference internal" href="#winreg.PyHKEY.Close" title="winreg.PyHKEY.Close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Close()</span></code></a> method on the object, or the <a class="reference internal" href="#winreg.CloseKey" title="winreg.CloseKey"><code class="xref py py-func docutils literal notranslate"><span class="pre">CloseKey()</span></code></a> function.</p>
<p>All registry functions in this module return one of these objects.</p>
<p>All registry functions in this module which accept a handle object also accept
an integer, however, use of the handle object is encouraged.</p>
<p>Handle objects provide semantics for <a class="reference internal" href="datamodel.html#object.__bool__" tppabs="https://docs.python.org/zh-cn/3/reference/datamodel.html#object.__bool__" title="object.__bool__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__bool__()</span></code></a> -- thus</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">handle</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will print <code class="docutils literal notranslate"><span class="pre">Yes</span></code> if the handle is currently valid (has not been closed or
detached).</p>
<p>The object also support comparison semantics, so handle objects will compare
true if they both reference the same underlying Windows handle value.</p>
<p>Handle objects can be converted to an integer (e.g., using the built-in
<a class="reference internal" href="functions.html#int" tppabs="https://docs.python.org/zh-cn/3/library/functions.html#int" title="int"><code class="xref py py-func docutils literal notranslate"><span class="pre">int()</span></code></a> function), in which case the underlying Windows handle value is
returned.  You can also use the <a class="reference internal" href="#winreg.PyHKEY.Detach" title="winreg.PyHKEY.Detach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detach()</span></code></a> method to return the
integer handle, and also disconnect the Windows handle from the handle object.</p>
<dl class="method">
<dt id="winreg.PyHKEY.Close">
<code class="sig-prename descclassname">PyHKEY.</code><code class="sig-name descname">Close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.Close" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Closes the underlying Windows handle.</p>
<p>If the handle is already closed, no error is raised.</p>
</dd></dl>

<dl class="method">
<dt id="winreg.PyHKEY.Detach">
<code class="sig-prename descclassname">PyHKEY.</code><code class="sig-name descname">Detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.Detach" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>Detaches the Windows handle from the handle object.</p>
<p>The result is an integer that holds the value of the handle before it is
detached.  If the handle is already detached or closed, this will return
zero.</p>
<p>After calling this function, the handle is effectively invalidated, but the
handle is not closed.  You would call this function when you need the
underlying Win32 handle to exist beyond the lifetime of the handle object.</p>
<p class="audit-hook">å¼•å‘ä¸€ä¸ª <a class="reference internal" href="sys.html#auditing" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#auditing"><span class="std std-ref">å®¡è®¡äº‹ä»¶</span></a> <code class="docutils literal notranslate"><span class="pre">winreg.PyHKEY.Detach</span></code>ï¼Œé™„å¸¦å‚æ•° <code class="docutils literal notranslate"><span class="pre">key</span></code>ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="winreg.PyHKEY.__enter__">
<code class="sig-prename descclassname">PyHKEY.</code><code class="sig-name descname">__enter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.__enter__" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dt id="winreg.PyHKEY.__exit__">
<code class="sig-prename descclassname">PyHKEY.</code><code class="sig-name descname">__exit__</code><span class="sig-paren">(</span><em class="sig-param">*exc_info</em><span class="sig-paren">)</span><a class="headerlink" href="#winreg.PyHKEY.__exit__" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>The HKEY object implements <a class="reference internal" href="datamodel.html#object.__enter__" tppabs="https://docs.python.org/zh-cn/3/reference/datamodel.html#object.__enter__" title="object.__enter__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__enter__()</span></code></a> and
<a class="reference internal" href="datamodel.html#object.__exit__" tppabs="https://docs.python.org/zh-cn/3/reference/datamodel.html#object.__exit__" title="object.__exit__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__exit__()</span></code></a> and thus supports the context protocol for the
<a class="reference internal" href="compound_stmts.html#with" tppabs="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> statement:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">OpenKey</span><span class="p">(</span><span class="n">HKEY_LOCAL_MACHINE</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">key</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1"># work with key</span>
</pre></div>
</div>
<p>will automatically close <em>key</em> when control leaves the <a class="reference internal" href="compound_stmts.html#with" tppabs="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> block.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html" tppabs="https://docs.python.org/zh-cn/3/contents.html">ç›®å½•</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">winreg</span></code> --- Windows æ³¨å†Œè¡¨è®¿é—®</a><ul>
<li><a class="reference internal" href="#functions">å‡½æ•°</a></li>
<li><a class="reference internal" href="#constants">å¸¸æ•°</a><ul>
<li><a class="reference internal" href="#hkey-constants">HKEY_* Constants</a></li>
<li><a class="reference internal" href="#access-rights">Access Rights</a><ul>
<li><a class="reference internal" href="#bit-specific">64-bit Specific</a></li>
</ul>
</li>
<li><a class="reference internal" href="#value-types">Value Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#registry-handle-objects">Registry Handle Objects</a></li>
</ul>
</li>
</ul>

  <h4>ä¸Šä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="msvcrt.html" tppabs="https://docs.python.org/zh-cn/3/library/msvcrt.html"
                        title="ä¸Šä¸€ç« "><code class="xref py py-mod docutils literal notranslate"><span class="pre">msvcrt</span></code> --- Useful routines from the MS VC++ runtime</a></p>
  <h4>ä¸‹ä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="winsound.html" tppabs="https://docs.python.org/zh-cn/3/library/winsound.html"
                        title="ä¸‹ä¸€ç« "><code class="xref py py-mod docutils literal notranslate"><span class="pre">winsound</span></code> --- Sound-playing interface for Windows</a></p>
  <div role="note" aria-label="source link">
    <h3>æœ¬é¡µ</h3>
    <ul class="this-page-menu">
      <li><a href="bugs.html" tppabs="https://docs.python.org/zh-cn/3/bugs.html">æäº¤ Bug</a></li>
      <li>
        <a href="javascript:if(confirm('https://github.com/python/cpython/blob/3.8/Doc/library/winreg.rst  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/python/cpython/blob/3.8/Doc/library/winreg.rst'" tppabs="https://github.com/python/cpython/blob/3.8/Doc/library/winreg.rst"
            rel="nofollow">æ˜¾ç¤ºæºä»£ç 
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             >ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="winsound.html" tppabs="https://docs.python.org/zh-cn/3/library/winsound.html" title="winsound --- Sound-playing interface for Windows"
             >ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="msvcrt.html" tppabs="https://docs.python.org/zh-cn/3/library/msvcrt.html" title="msvcrt --- Useful routines from the MS VC++ runtime"
             >ä¸Šä¸€é¡µ</a> |</li>

    <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
             style="vertical-align: middle; margin-top: -1px"/></li>
    <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
    

    <li>
      <span class="language_switcher_placeholder">zh_CN</span>
      <span class="version_switcher_placeholder">3.8.2</span>
      <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index-2.html" tppabs="https://docs.python.org/zh-cn/3/library/index.html" >Python æ ‡å‡†åº“</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="windows-1.html" tppabs="https://docs.python.org/zh-cn/3/library/windows.html" >Windowsç³»ç»Ÿç›¸å…³æ¨¡å—</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="copyright.html" tppabs="https://docs.python.org/zh-cn/3/copyright.html">ç‰ˆæƒæ‰€æœ‰</a> 2001-2020, Python Software Foundation.
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="javascript:if(confirm('https://www.python.org/psf/donations/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/psf/donations/'" tppabs="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    æœ€åæ›´æ–°äº 3æœˆ 26, 2020.
    <a href="javascript:if(confirm('https://docs.python.org/3/bugs.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.python.org/3/bugs.html'" tppabs="https://docs.python.org/3/bugs.html">Found a bug</a>?
    <br />

    Created using <a href="javascript:if(confirm('https://www.sphinx-doc.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.sphinx-doc.org/'" tppabs="https://www.sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>

  </body>
</html>