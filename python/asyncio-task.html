
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>åç¨‹ä¸ä»»åŠ¡ &#8212; Python 3.7.3 æ–‡æ¡£</title>
    <link rel="stylesheet" href="pydoctheme.css" tppabs="https://docs.python.org/zh-cn/3/_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="pygments.css" tppabs="https://docs.python.org/zh-cn/3/_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="documentation_options.js" tppabs="https://docs.python.org/zh-cn/3/_static/documentation_options.js"></script>
    <script type="text/javascript" src="jquery.js" tppabs="https://docs.python.org/zh-cn/3/_static/jquery.js"></script>
    <script type="text/javascript" src="underscore.js" tppabs="https://docs.python.org/zh-cn/3/_static/underscore.js"></script>
    <script type="text/javascript" src="doctools.js" tppabs="https://docs.python.org/zh-cn/3/_static/doctools.js"></script>
    <script type="text/javascript" src="language_data.js" tppabs="https://docs.python.org/zh-cn/3/_static/language_data.js"></script>
    <script type="text/javascript" src="translations.js" tppabs="https://docs.python.org/zh-cn/3/_static/translations.js"></script>
    
    <script type="text/javascript" src="sidebar.js" tppabs="https://docs.python.org/zh-cn/3/_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="åœ¨ Python 3.7.3 æ–‡æ¡£ ä¸­æœç´¢"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="å…³äºè¿™äº›æ–‡æ¡£" href="../about.html" />
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æœç´¢" href="../search.html" />
    <link rel="copyright" title="ç‰ˆæƒæ‰€æœ‰" href="../copyright.html" />
    <link rel="next" title="æµ" href="asyncio-stream.html" />
    <link rel="prev" title="asyncio --- å¼‚æ­¥ I/O" href="asyncio.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <link rel="canonical" href="https://docs.python.org/3/library/asyncio-task.html" />
    
    <script type="text/javascript" src="copybutton.js" tppabs="https://docs.python.org/zh-cn/3/_static/copybutton.js"></script>
    <script type="text/javascript" src="switchers.js" tppabs="https://docs.python.org/zh-cn/3/_static/switchers.js"></script>
    
    
    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
 

  </head><body>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             accesskey="I">ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="asyncio-stream.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-stream.html" title="æµ"
             accesskey="N">ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="asyncio.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio.html" title="asyncio --- å¼‚æ­¥ I/O"
             accesskey="P">ä¸Šä¸€é¡µ</a> |</li>
        <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="language_switcher_placeholder">zh_CN</span>
          <span class="version_switcher_placeholder">3.7.3</span>
          <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index-2.html" tppabs="https://docs.python.org/zh-cn/3/library/index.html" >Python æ ‡å‡†åº“</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ipc.html" tppabs="https://docs.python.org/zh-cn/3/library/ipc.html" >ç½‘ç»œå’Œè¿›ç¨‹é—´é€šä¿¡</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="asyncio.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio.html" accesskey="U"><code class="docutils literal notranslate"><span class="pre">asyncio</span></code> --- å¼‚æ­¥ I/O</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="coroutines-and-tasks">
<h1>åç¨‹ä¸ä»»åŠ¡<a class="headerlink" href="#coroutines-and-tasks" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h1>
<p>æœ¬èŠ‚å°†ç®€è¿°ç”¨äºåç¨‹ä¸ä»»åŠ¡çš„é«˜å±‚çº§ APIã€‚</p>
<div class="contents local topic" id="id1">
<ul class="simple">
<li><a class="reference internal" href="#coroutines" id="id2">åç¨‹</a></li>
<li><a class="reference internal" href="#awaitables" id="id3">å¯ç­‰å¾…å¯¹è±¡</a></li>
<li><a class="reference internal" href="#running-an-asyncio-program" id="id4">è¿è¡Œ asyncio ç¨‹åº</a></li>
<li><a class="reference internal" href="#creating-tasks" id="id5">åˆ›å»ºä»»åŠ¡</a></li>
<li><a class="reference internal" href="#sleeping" id="id6">ä¼‘çœ </a></li>
<li><a class="reference internal" href="#running-tasks-concurrently" id="id7">å¹¶å‘è¿è¡Œä»»åŠ¡</a></li>
<li><a class="reference internal" href="#shielding-from-cancellation" id="id8">å±è”½å–æ¶ˆæ“ä½œ</a></li>
<li><a class="reference internal" href="#timeouts" id="id9">è¶…æ—¶</a></li>
<li><a class="reference internal" href="#waiting-primitives" id="id10">ç®€å•ç­‰å¾…</a></li>
<li><a class="reference internal" href="#scheduling-from-other-threads" id="id11">æ¥è‡ªå…¶ä»–çº¿ç¨‹çš„æ—¥ç¨‹å®‰æ’</a></li>
<li><a class="reference internal" href="#introspection" id="id12">å†…çœ</a></li>
<li><a class="reference internal" href="#task-object" id="id13">Task å¯¹è±¡</a></li>
<li><a class="reference internal" href="#generator-based-coroutines" id="id14">åŸºäºç”Ÿæˆå™¨çš„åç¨‹</a></li>
</ul>
</div>
<div class="section" id="coroutines">
<span id="coroutine"></span><h2><a class="toc-backref" href="#id2">åç¨‹</a><a class="headerlink" href="#coroutines" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>åç¨‹é€šè¿‡ async/await è¯­æ³•è¿›è¡Œå£°æ˜ï¼Œæ˜¯ç¼–å†™å¼‚æ­¥åº”ç”¨çš„æ¨èæ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç æ®µ (éœ€è¦ Python 3.7+) æ‰“å° &quot;hello&quot;ï¼Œç­‰å¾… 1 ç§’ï¼Œç„¶åæ‰“å° &quot;world&quot;:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
<span class="go">hello</span>
<span class="go">world</span>
</pre></div>
</div>
<p>æ³¨æ„ï¼šç®€å•åœ°è°ƒç”¨ä¸€ä¸ªåç¨‹å¹¶ä¸ä¼šå°†å…¶åŠ å…¥æ‰§è¡Œæ—¥ç¨‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">main</span><span class="p">()</span>
<span class="go">&lt;coroutine object main at 0x1053bb7c8&gt;</span>
</pre></div>
</div>
<p>è¦çœŸæ­£è¿è¡Œä¸€ä¸ªåç¨‹ï¼Œasyncio æä¾›äº†ä¸‰ç§ä¸»è¦æœºåˆ¶:</p>
<ul>
<li><p class="first"><a class="reference internal" href="#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a> å‡½æ•°ç”¨æ¥è¿è¡Œæœ€é«˜å±‚çº§çš„å…¥å£ç‚¹ &quot;main()&quot; å‡½æ•° (å‚è§ä¸Šé¢çš„ç¤ºä¾‹ã€‚)</p>
</li>
<li><p class="first">ç­‰å¾…ä¸€ä¸ªåç¨‹ã€‚ä»¥ä¸‹ä»£ç æ®µä¼šåœ¨ç­‰å¾… 1 ç§’åæ‰“å° &quot;hello&quot;ï¼Œç„¶å <em>å†æ¬¡</em> ç­‰å¾… 2 ç§’åæ‰“å° &quot;world&quot;:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">say_after</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="n">what</span><span class="p">):</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;started at {time.strftime(&#39;</span><span class="si">%X</span><span class="s2">&#39;)}&quot;</span><span class="p">)</span>

    <span class="k">await</span> <span class="n">say_after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">say_after</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;finished at {time.strftime(&#39;</span><span class="si">%X</span><span class="s2">&#39;)}&quot;</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<p>é¢„æœŸçš„è¾“å‡º:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">started</span> <span class="n">at</span> <span class="mi">17</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">52</span>
<span class="n">hello</span>
<span class="n">world</span>
<span class="n">finished</span> <span class="n">at</span> <span class="mi">17</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">55</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="#asyncio.create_task" title="asyncio.create_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.create_task()</span></code></a> å‡½æ•°ç”¨æ¥å¹¶å‘è¿è¡Œä½œä¸º asyncio <a class="reference internal" href="#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">ä»»åŠ¡</span></code></a> çš„å¤šä¸ªåç¨‹ã€‚</p>
<p>è®©æˆ‘ä»¬ä¿®æ”¹ä»¥ä¸Šç¤ºä¾‹ï¼Œ<em>å¹¶å‘</em> è¿è¡Œä¸¤ä¸ª <code class="docutils literal notranslate"><span class="pre">say_after</span></code> åç¨‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">task1</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
        <span class="n">say_after</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">))</span>

    <span class="n">task2</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
        <span class="n">say_after</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;started at {time.strftime(&#39;</span><span class="si">%X</span><span class="s2">&#39;)}&quot;</span><span class="p">)</span>

    <span class="c1"># Wait until both tasks are completed (should take</span>
    <span class="c1"># around 2 seconds.)</span>
    <span class="k">await</span> <span class="n">task1</span>
    <span class="k">await</span> <span class="n">task2</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;finished at {time.strftime(&#39;</span><span class="si">%X</span><span class="s2">&#39;)}&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>æ³¨æ„ï¼Œé¢„æœŸçš„è¾“å‡ºæ˜¾ç¤ºä»£ç æ®µçš„è¿è¡Œæ—¶é—´æ¯”ä¹‹å‰å¿«äº† 1 ç§’:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">started</span> <span class="n">at</span> <span class="mi">17</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">32</span>
<span class="n">hello</span>
<span class="n">world</span>
<span class="n">finished</span> <span class="n">at</span> <span class="mi">17</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">34</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="awaitables">
<span id="asyncio-awaitables"></span><h2><a class="toc-backref" href="#id3">å¯ç­‰å¾…å¯¹è±¡</a><a class="headerlink" href="#awaitables" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<p>å¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥åœ¨ <a class="reference internal" href="expressions.html#await" tppabs="https://docs.python.org/zh-cn/3/reference/expressions.html#await"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">await</span></code></a>  è¯­å¥ä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ <strong>å¯ç­‰å¾…</strong> å¯¹è±¡ã€‚è®¸å¤š asyncio API éƒ½è¢«è®¾è®¡ä¸ºæ¥å—å¯ç­‰å¾…å¯¹è±¡ã€‚</p>
<p><em>å¯ç­‰å¾…</em> å¯¹è±¡æœ‰ä¸‰ç§ä¸»è¦ç±»å‹: <strong>åç¨‹</strong>, <strong>ä»»åŠ¡</strong> å’Œ <strong>Future</strong>.</p>
<p class="rubric">åç¨‹</p>
<p>Python åç¨‹å±äº <em>å¯ç­‰å¾…</em> å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥åœ¨å…¶ä»–åç¨‹ä¸­è¢«ç­‰å¾…:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">nested</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">42</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Nothing happens if we just call &quot;nested()&quot;.</span>
    <span class="c1"># A coroutine object is created but not awaited,</span>
    <span class="c1"># so it *won&#39;t run at all*.</span>
    <span class="n">nested</span><span class="p">()</span>

    <span class="c1"># Let&#39;s do it differently now and await it:</span>
    <span class="nb">print</span><span class="p">(</span><span class="k">await</span> <span class="n">nested</span><span class="p">())</span>  <span class="c1"># will print &quot;42&quot;.</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">é‡è¦</p>
<p>åœ¨æœ¬æ–‡æ¡£ä¸­ &quot;åç¨‹&quot; å¯ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªç´§å¯†å…³è”çš„æ¦‚å¿µ:</p>
<ul class="last simple">
<li><em>åç¨‹å‡½æ•°</em>: å®šä¹‰å½¢å¼ä¸º <a class="reference internal" href="compound_stmts.html#async-def" tppabs="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#async-def"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code></a> çš„å‡½æ•°;</li>
<li><em>åç¨‹å¯¹è±¡</em>: è°ƒç”¨ <em>åç¨‹å‡½æ•°</em> æ‰€è¿”å›çš„å¯¹è±¡ã€‚</li>
</ul>
</div>
<p>asyncio ä¹Ÿæ”¯æŒæ—§å¼çš„ <a class="reference internal" href="#asyncio-generator-based-coro"><span class="std std-ref">åŸºäºç”Ÿæˆå™¨çš„</span></a> åç¨‹ã€‚</p>
<p class="rubric">ä»»åŠ¡</p>
<p><em>ä»»åŠ¡</em> è¢«ç”¨æ¥è®¾ç½®æ—¥ç¨‹ä»¥ä¾¿ <em>å¹¶å‘</em> æ‰§è¡Œåç¨‹ã€‚</p>
<p>å½“ä¸€ä¸ªåç¨‹é€šè¿‡ <a class="reference internal" href="#asyncio.create_task" title="asyncio.create_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.create_task()</span></code></a> ç­‰å‡½æ•°è¢«æ‰“åŒ…ä¸ºä¸€ä¸ª <em>ä»»åŠ¡</em>ï¼Œè¯¥åç¨‹å°†è‡ªåŠ¨æ’å…¥æ—¥ç¨‹å‡†å¤‡ç«‹å³è¿è¡Œ:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">nested</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">42</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Schedule nested() to run soon concurrently</span>
    <span class="c1"># with &quot;main()&quot;.</span>
    <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">nested</span><span class="p">())</span>

    <span class="c1"># &quot;task&quot; can now be used to cancel &quot;nested()&quot;, or</span>
    <span class="c1"># can simply be awaited to wait until it is complete:</span>
    <span class="k">await</span> <span class="n">task</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<p class="rubric">Future å¯¹è±¡</p>
<p><a class="reference internal" href="asyncio-future.html#asyncio.Future" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future" title="asyncio.Future"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a> æ˜¯ä¸€ç§ç‰¹æ®Šçš„ <strong>ä½å±‚çº§</strong> å¯ç­‰å¾…å¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ <strong>æœ€ç»ˆç»“æœ</strong>ã€‚</p>
<p>å½“ä¸€ä¸ª Future å¯¹è±¡ <em>è¢«ç­‰å¾…</em>ï¼Œè¿™æ„å‘³ç€åç¨‹å°†ä¿æŒç­‰å¾…ç›´åˆ°è¯¥ Future å¯¹è±¡åœ¨å…¶ä»–åœ°æ–¹æ“ä½œå®Œæ¯•ã€‚</p>
<p>åœ¨ asyncio ä¸­éœ€è¦ Future å¯¹è±¡ä»¥ä¾¿å…è®¸é€šè¿‡ async/await ä½¿ç”¨åŸºäºå›è°ƒçš„ä»£ç ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ <strong>æ²¡æœ‰å¿…è¦</strong> åœ¨åº”ç”¨å±‚çº§çš„ä»£ç ä¸­åˆ›å»º Future å¯¹è±¡ã€‚</p>
<p>Future å¯¹è±¡æœ‰æ—¶ä¼šç”±åº“å’ŒæŸäº› asyncio API æš´éœ²ç»™ç”¨æˆ·ï¼Œç”¨ä½œå¯ç­‰å¾…å¯¹è±¡:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">function_that_returns_a_future_object</span><span class="p">()</span>

    <span class="c1"># this is also valid:</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
        <span class="n">function_that_returns_a_future_object</span><span class="p">(),</span>
        <span class="n">some_python_coroutine</span><span class="p">()</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>ä¸€ä¸ªå¾ˆå¥½çš„è¿”å›å¯¹è±¡çš„ä½å±‚çº§å‡½æ•°çš„ç¤ºä¾‹æ˜¯ <a class="reference internal" href="asyncio-eventloop.html#asyncio.loop.run_in_executor" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.loop.run_in_executor" title="asyncio.loop.run_in_executor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loop.run_in_executor()</span></code></a>ã€‚</p>
</div>
<div class="section" id="running-an-asyncio-program">
<h2><a class="toc-backref" href="#id4">è¿è¡Œ asyncio ç¨‹åº</a><a class="headerlink" href="#running-an-asyncio-program" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.run">
<code class="descclassname">asyncio.</code><code class="descname">run</code><span class="sig-paren">(</span><em>coro</em>, <em>*</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.run" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>æ­¤å‡½æ•°è¿è¡Œä¼ å…¥çš„åç¨‹ï¼Œè´Ÿè´£ç®¡ç† asyncio äº‹ä»¶å¾ªç¯å¹¶ <em>å®Œç»“å¼‚æ­¥ç”Ÿæˆå™¨</em>ã€‚</p>
<p>å½“æœ‰å…¶ä»– asyncio äº‹ä»¶å¾ªç¯åœ¨åŒä¸€çº¿ç¨‹ä¸­è¿è¡Œæ—¶ï¼Œæ­¤å‡½æ•°ä¸èƒ½è¢«è°ƒç”¨ã€‚</p>
<p>å¦‚æœ <em>debug</em> ä¸º <code class="docutils literal notranslate"><span class="pre">True</span></code>ï¼Œäº‹ä»¶å¾ªç¯å°†ä»¥è°ƒè¯•æ¨¡å¼è¿è¡Œã€‚</p>
<p>æ­¤å‡½æ•°æ€»æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯å¹¶åœ¨ç»“æŸæ—¶å…³é—­ä¹‹ã€‚å®ƒåº”å½“è¢«ç”¨ä½œ  asyncio ç¨‹åºçš„ä¸»å…¥å£ç‚¹ï¼Œç†æƒ³æƒ…å†µä¸‹åº”å½“åªè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<div class="versionadded">
<p><span class="versionmodified">3.7 æ–°ç‰ˆåŠŸèƒ½: </span><strong>é‡è¦:</strong> æ­¤å‡½æ•°æ˜¯åœ¨ Python 3.7 ä¸­åŠ å…¥ asyncio æ¨¡å—ï¼Œå¤„äº <a class="reference internal" href="glossary.html#term-provisional-api" tppabs="https://docs.python.org/zh-cn/3/glossary.html#term-provisional-api"><span class="xref std std-term">æš‚å®šåŸºå‡†çŠ¶æ€</span></a>ã€‚</p>
</div>
</dd></dl>

</div>
<div class="section" id="creating-tasks">
<h2><a class="toc-backref" href="#id5">åˆ›å»ºä»»åŠ¡</a><a class="headerlink" href="#creating-tasks" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.create_task">
<code class="descclassname">asyncio.</code><code class="descname">create_task</code><span class="sig-paren">(</span><em>coro</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.create_task" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å°† <em>coro</em> <a class="reference internal" href="#coroutine"><span class="std std-ref">åç¨‹</span></a> æ‰“åŒ…ä¸ºä¸€ä¸ª <a class="reference internal" href="#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> æ’å…¥æ—¥ç¨‹å‡†å¤‡æ‰§è¡Œã€‚è¿”å› Task å¯¹è±¡ã€‚</p>
<p>è¯¥ä»»åŠ¡ä¼šåœ¨ <a class="reference internal" href="asyncio-eventloop.html#asyncio.get_running_loop" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.get_running_loop" title="asyncio.get_running_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_running_loop()</span></code></a> è¿”å›çš„å¾ªç¯ä¸­æ‰§è¡Œï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ²¡æœ‰åœ¨è¿è¡Œçš„å¾ªç¯åˆ™ä¼šå¼•å‘ <a class="reference internal" href="exceptions.html#RuntimeError" tppabs="https://docs.python.org/zh-cn/3/library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>ã€‚</p>
<p>æ­¤å‡½æ•° <strong>åœ¨ Python 3.7 ä¸­è¢«åŠ å…¥</strong>ã€‚åœ¨ Python 3.7 ä¹‹å‰ï¼Œå¯ä»¥æ”¹ç”¨ä½å±‚çº§çš„ <a class="reference internal" href="asyncio-future.html#asyncio.ensure_future" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.ensure_future" title="asyncio.ensure_future"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.ensure_future()</span></code></a> å‡½æ•°ã€‚</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">coro</span><span class="p">():</span>
    <span class="o">...</span>

<span class="c1"># In Python 3.7+</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">coro</span><span class="p">())</span>
<span class="o">...</span>

<span class="c1"># This works in all Python versions but is less readable</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span><span class="p">(</span><span class="n">coro</span><span class="p">())</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">3.7 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="sleeping">
<h2><a class="toc-backref" href="#id6">ä¼‘çœ </a><a class="headerlink" href="#sleeping" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.sleep">
<em class="property">coroutine </em><code class="descclassname">asyncio.</code><code class="descname">sleep</code><span class="sig-paren">(</span><em>delay</em>, <em>result=None</em>, <em>*</em>, <em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.sleep" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>é˜»å¡ <em>delay</em> æŒ‡å®šçš„ç§’æ•°ã€‚</p>
<p>å¦‚æœæŒ‡å®šäº† <em>result</em>ï¼Œåˆ™å½“åç¨‹å®Œæˆæ—¶å°†å…¶è¿”å›ç»™è°ƒç”¨è€…ã€‚</p>
<p><code class="docutils literal notranslate"><span class="pre">sleep()</span></code> æ€»æ˜¯ä¼šæŒ‚èµ·å½“å‰ä»»åŠ¡ï¼Œä»¥å…è®¸å…¶ä»–ä»»åŠ¡è¿è¡Œã€‚</p>
<p><em>loop</em> å‚æ•°å·²å¼ƒç”¨ï¼Œè®¡åˆ’åœ¨ Python 3.10 ä¸­ç§»é™¤ã€‚</p>
<p id="asyncio-example-sleep">ä»¥ä¸‹åç¨‹ç¤ºä¾‹è¿è¡Œ 5 ç§’ï¼Œæ¯ç§’æ˜¾ç¤ºä¸€æ¬¡å½“å‰æ—¥æœŸ:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">display_date</span><span class="p">():</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mf">5.0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">loop</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">display_date</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="running-tasks-concurrently">
<h2><a class="toc-backref" href="#id7">å¹¶å‘è¿è¡Œä»»åŠ¡</a><a class="headerlink" href="#running-tasks-concurrently" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.gather">
<em class="property">awaitable </em><code class="descclassname">asyncio.</code><code class="descname">gather</code><span class="sig-paren">(</span><em>*aws</em>, <em>loop=None</em>, <em>return_exceptions=False</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.gather" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p><em>å¹¶å‘</em> è¿è¡Œ <em>aws</em> åºåˆ—ä¸­çš„ <a class="reference internal" href="#asyncio-awaitables"><span class="std std-ref">å¯ç­‰å¾…å¯¹è±¡</span></a>ã€‚</p>
<p>å¦‚æœ <em>aws</em> ä¸­çš„æŸä¸ªå¯ç­‰å¾…å¯¹è±¡ä¸ºåç¨‹ï¼Œå®ƒå°†è‡ªåŠ¨ä½œä¸ºä¸€ä¸ªä»»åŠ¡åŠ å…¥æ—¥ç¨‹ã€‚</p>
<p>å¦‚æœæ‰€æœ‰å¯ç­‰å¾…å¯¹è±¡éƒ½æˆåŠŸå®Œæˆï¼Œç»“æœå°†æ˜¯ä¸€ä¸ªç”±æ‰€æœ‰è¿”å›å€¼èšåˆè€Œæˆçš„åˆ—è¡¨ã€‚ç»“æœå€¼çš„é¡ºåºä¸ <em>aws</em> ä¸­å¯ç­‰å¾…å¯¹è±¡çš„é¡ºåºä¸€è‡´ã€‚</p>
<p>å¦‚æœ <em>return_exceptions</em> ä¸º <code class="docutils literal notranslate"><span class="pre">False</span></code> (é»˜è®¤)ï¼Œæ‰€å¼•å‘çš„é¦–ä¸ªå¼‚å¸¸ä¼šç«‹å³ä¼ æ’­ç»™ç­‰å¾… <code class="docutils literal notranslate"><span class="pre">gather()</span></code> çš„ä»»åŠ¡ã€‚<em>aws</em> åºåˆ—ä¸­çš„å…¶ä»–å¯ç­‰å¾…å¯¹è±¡ <strong>ä¸ä¼šè¢«å–æ¶ˆ</strong> å¹¶å°†ç»§ç»­è¿è¡Œã€‚</p>
<p>å¦‚æœ <em>return_exceptions</em> ä¸º <code class="docutils literal notranslate"><span class="pre">True</span></code>ï¼Œå¼‚å¸¸ä¼šå’ŒæˆåŠŸçš„ç»“æœä¸€æ ·å¤„ç†ï¼Œå¹¶èšåˆè‡³ç»“æœåˆ—è¡¨ã€‚</p>
<p>å¦‚æœ <code class="docutils literal notranslate"><span class="pre">gather()</span></code> <em>è¢«å–æ¶ˆ</em>ï¼Œæ‰€æœ‰è¢«æäº¤ (å°šæœªå®Œæˆ) çš„å¯ç­‰å¾…å¯¹è±¡ä¹Ÿä¼š <em>è¢«å–æ¶ˆ</em>ã€‚</p>
<p>å¦‚æœ <em>aws</em> åºåˆ—ä¸­çš„ä»»ä¸€ Task æˆ– Future å¯¹è±¡ <em>è¢«å–æ¶ˆ</em>ï¼Œå®ƒå°†è¢«å½“ä½œå¼•å‘äº† <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> ä¸€æ ·å¤„ç† -- åœ¨æ­¤æƒ…å†µä¸‹ <code class="docutils literal notranslate"><span class="pre">gather()</span></code> è°ƒç”¨ <strong>ä¸ä¼š</strong> è¢«å–æ¶ˆã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢ä¸€ä¸ªå·²æäº¤çš„ Task/Future è¢«å–æ¶ˆå¯¼è‡´å…¶ä»– Tasks/Future ä¹Ÿè¢«å–æ¶ˆã€‚</p>
<p id="asyncio-example-gather">ç¤ºä¾‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Task </span><span class="si">{name}</span><span class="s2">: Compute factorial(</span><span class="si">{i}</span><span class="s2">)...&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Task </span><span class="si">{name}</span><span class="s2">: factorial(</span><span class="si">{number}</span><span class="s2">) = </span><span class="si">{f}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Schedule three calls *concurrently*:</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
        <span class="n">factorial</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">factorial</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
        <span class="n">factorial</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>

<span class="c1"># Expected output:</span>
<span class="c1">#</span>
<span class="c1">#     Task A: Compute factorial(2)...</span>
<span class="c1">#     Task B: Compute factorial(2)...</span>
<span class="c1">#     Task C: Compute factorial(2)...</span>
<span class="c1">#     Task A: factorial(2) = 2</span>
<span class="c1">#     Task B: Compute factorial(3)...</span>
<span class="c1">#     Task C: Compute factorial(3)...</span>
<span class="c1">#     Task B: factorial(3) = 6</span>
<span class="c1">#     Task C: Compute factorial(4)...</span>
<span class="c1">#     Task C: factorial(4) = 24</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">åœ¨ 3.7 ç‰ˆæ›´æ”¹: </span>å¦‚æœ <em>gather</em> æœ¬èº«è¢«å–æ¶ˆï¼Œåˆ™æ— è®º <em>return_exceptions</em> å–å€¼ä¸ºä½•ï¼Œæ¶ˆæ¯éƒ½ä¼šè¢«ä¼ æ’­ã€‚</p>
</div>
</dd></dl>

</div>
<div class="section" id="shielding-from-cancellation">
<h2><a class="toc-backref" href="#id8">å±è”½å–æ¶ˆæ“ä½œ</a><a class="headerlink" href="#shielding-from-cancellation" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.shield">
<em class="property">awaitable </em><code class="descclassname">asyncio.</code><code class="descname">shield</code><span class="sig-paren">(</span><em>aw</em>, <em>*</em>, <em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.shield" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>ä¿æŠ¤ä¸€ä¸ª <a class="reference internal" href="#asyncio-awaitables"><span class="std std-ref">å¯ç­‰å¾…å¯¹è±¡</span></a> é˜²æ­¢å…¶è¢« <a class="reference internal" href="#asyncio.Task.cancel" title="asyncio.Task.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">å–æ¶ˆ</span></code></a>ã€‚</p>
<p>å¦‚æœ <em>aw</em> æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒå°†è‡ªåŠ¨ä½œä¸ºä»»åŠ¡åŠ å…¥æ—¥ç¨‹ã€‚</p>
<p>ä»¥ä¸‹è¯­å¥:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">shield</span><span class="p">(</span><span class="n">something</span><span class="p">())</span>
</pre></div>
</div>
<p>ç›¸å½“äº:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">something</span><span class="p">()</span>
</pre></div>
</div>
<p><em>ä¸åŒä¹‹å¤„</em> åœ¨äºå¦‚æœåŒ…å«å®ƒçš„åç¨‹è¢«å–æ¶ˆï¼Œåœ¨ <code class="docutils literal notranslate"><span class="pre">something()</span></code> ä¸­è¿è¡Œçš„ä»»åŠ¡ä¸ä¼šè¢«å–æ¶ˆã€‚ä» <code class="docutils literal notranslate"><span class="pre">something()</span></code> çš„è§’åº¦çœ‹æ¥ï¼Œå–æ¶ˆæ“ä½œå¹¶æ²¡æœ‰å‘ç”Ÿã€‚ç„¶è€Œå…¶è°ƒç”¨è€…å·²è¢«å–æ¶ˆï¼Œå› æ­¤ &quot;await&quot; è¡¨è¾¾å¼ä»ç„¶ä¼šå¼•å‘ <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a>ã€‚</p>
<p>å¦‚æœé€šè¿‡å…¶ä»–æ–¹å¼å–æ¶ˆ <code class="docutils literal notranslate"><span class="pre">something()</span></code> (ä¾‹å¦‚åœ¨å…¶å†…éƒ¨æ“ä½œ) åˆ™ <code class="docutils literal notranslate"><span class="pre">shield()</span></code> ä¹Ÿä¼šå–æ¶ˆã€‚</p>
<p>å¦‚æœå¸Œæœ›å®Œå…¨å¿½ç•¥å–æ¶ˆæ“ä½œ (ä¸æ¨è) åˆ™ <code class="docutils literal notranslate"><span class="pre">shield()</span></code> å‡½æ•°éœ€è¦é…åˆä¸€ä¸ª try/except ä»£ç æ®µï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="n">shield</span><span class="p">(</span><span class="n">something</span><span class="p">())</span>
<span class="k">except</span> <span class="n">CancelledError</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="timeouts">
<h2><a class="toc-backref" href="#id9">è¶…æ—¶</a><a class="headerlink" href="#timeouts" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.wait_for">
<em class="property">coroutine </em><code class="descclassname">asyncio.</code><code class="descname">wait_for</code><span class="sig-paren">(</span><em>aw</em>, <em>timeout</em>, <em>*</em>, <em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.wait_for" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>ç­‰å¾… <em>aw</em> <a class="reference internal" href="#asyncio-awaitables"><span class="std std-ref">å¯ç­‰å¾…å¯¹è±¡</span></a> å®Œæˆï¼ŒæŒ‡å®š timeout ç§’æ•°åè¶…æ—¶ã€‚</p>
<p>å¦‚æœ <em>aw</em> æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒå°†è‡ªåŠ¨ä½œä¸ºä»»åŠ¡åŠ å…¥æ—¥ç¨‹ã€‚</p>
<p><em>timeout</em> å¯ä»¥ä¸º <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼Œä¹Ÿå¯ä»¥ä¸º float æˆ– int å‹æ•°å€¼è¡¨ç¤ºçš„ç­‰å¾…ç§’æ•°ã€‚å¦‚æœ <em>timeout</em> ä¸º <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼Œåˆ™ç­‰å¾…ç›´åˆ°å®Œæˆã€‚</p>
<p>å¦‚æœå‘ç”Ÿè¶…æ—¶ï¼Œä»»åŠ¡å°†å–æ¶ˆå¹¶å¼•å‘ <a class="reference internal" href="asyncio-exceptions.html#asyncio.TimeoutError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.TimeoutError" title="asyncio.TimeoutError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">asyncio.TimeoutError</span></code></a>.</p>
<p>è¦é¿å…ä»»åŠ¡ <a class="reference internal" href="#asyncio.Task.cancel" title="asyncio.Task.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">å–æ¶ˆ</span></code></a>ï¼Œå¯ä»¥åŠ ä¸Š <a class="reference internal" href="#asyncio.shield" title="asyncio.shield"><code class="xref py py-func docutils literal notranslate"><span class="pre">shield()</span></code></a>ã€‚</p>
<p>å‡½æ•°å°†ç­‰å¾…ç›´åˆ°ç›®æ ‡å¯¹è±¡ç¡®å®è¢«å–æ¶ˆï¼Œæ‰€ä»¥æ€»ç­‰å¾…æ—¶é—´å¯èƒ½è¶…è¿‡ <em>timeout</em> æŒ‡å®šçš„ç§’æ•°ã€‚</p>
<p>å¦‚æœç­‰å¾…è¢«å–æ¶ˆï¼Œåˆ™ <em>aw</em> æŒ‡å®šçš„å¯¹è±¡ä¹Ÿä¼šè¢«å–æ¶ˆã€‚</p>
<p><em>loop</em> å‚æ•°å·²å¼ƒç”¨ï¼Œè®¡åˆ’åœ¨ Python 3.10 ä¸­ç§»é™¤ã€‚</p>
<p id="asyncio-example-waitfor">ç¤ºä¾‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">eternity</span><span class="p">():</span>
    <span class="c1"># Sleep for one hour</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;yay!&#39;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Wait for at most 1 second</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">eternity</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;timeout!&#39;</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>

<span class="c1"># Expected output:</span>
<span class="c1">#</span>
<span class="c1">#     timeout!</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">åœ¨ 3.7 ç‰ˆæ›´æ”¹: </span>å½“ <em>aw</em> å› è¶…æ—¶è¢«å–æ¶ˆï¼Œ<code class="docutils literal notranslate"><span class="pre">wait_for</span></code> ä¼šç­‰å¾… <em>aw</em> è¢«å–æ¶ˆã€‚ä¹‹å‰ç‰ˆæœ¬åˆ™å°†ç«‹å³å¼•å‘ <a class="reference internal" href="asyncio-exceptions.html#asyncio.TimeoutError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.TimeoutError" title="asyncio.TimeoutError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">asyncio.TimeoutError</span></code></a>ã€‚</p>
</div>
</dd></dl>

</div>
<div class="section" id="waiting-primitives">
<h2><a class="toc-backref" href="#id10">ç®€å•ç­‰å¾…</a><a class="headerlink" href="#waiting-primitives" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.wait">
<em class="property">coroutine </em><code class="descclassname">asyncio.</code><code class="descname">wait</code><span class="sig-paren">(</span><em>aws</em>, <em>*</em>, <em>loop=None</em>, <em>timeout=None</em>, <em>return_when=ALL_COMPLETED</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.wait" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å¹¶å‘è¿è¡Œ <em>aws</em> æŒ‡å®šçš„ <a class="reference internal" href="#asyncio-awaitables"><span class="std std-ref">å¯ç­‰å¾…å¯¹è±¡</span></a> å¹¶é˜»å¡çº¿ç¨‹ç›´åˆ°æ»¡è¶³ <em>return_when</em> æŒ‡å®šçš„æ¡ä»¶ã€‚</p>
<p>å¦‚æœ <em>aws</em> ä¸­çš„æŸä¸ªå¯ç­‰å¾…å¯¹è±¡ä¸ºåç¨‹ï¼Œå®ƒå°†è‡ªåŠ¨ä½œä¸ºä»»åŠ¡åŠ å…¥æ—¥ç¨‹ã€‚ç›´æ¥å‘ <code class="docutils literal notranslate"><span class="pre">wait()</span></code> ä¼ å…¥åç¨‹å¯¹è±¡å·²å¼ƒç”¨ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´ <a class="reference internal" href="#asyncio-example-wait-coroutine"><span class="std std-ref">ä»¤äººè¿·æƒ‘çš„è¡Œä¸º</span></a>ã€‚</p>
<p>è¿”å›ä¸¤ä¸ª Task/Future é›†åˆ: <code class="docutils literal notranslate"><span class="pre">(done,</span> <span class="pre">pending)</span></code>ã€‚</p>
<p>ç”¨æ³•:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">done</span><span class="p">,</span> <span class="n">pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">aws</span><span class="p">)</span>
</pre></div>
</div>
<p><em>loop</em> å‚æ•°å·²å¼ƒç”¨ï¼Œè®¡åˆ’åœ¨ Python 3.10 ä¸­ç§»é™¤ã€‚</p>
<p>å¦‚æŒ‡å®š <em>timeout</em> (float æˆ– int ç±»å‹) åˆ™å®ƒå°†è¢«ç”¨äºæ§åˆ¶è¿”å›ä¹‹å‰ç­‰å¾…çš„æœ€é•¿ç§’æ•°ã€‚</p>
<p>è¯·æ³¨æ„æ­¤å‡½æ•°ä¸ä¼šå¼•å‘ <a class="reference internal" href="asyncio-exceptions.html#asyncio.TimeoutError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.TimeoutError" title="asyncio.TimeoutError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">asyncio.TimeoutError</span></code></a>ã€‚å½“è¶…æ—¶å‘ç”Ÿæ—¶ï¼Œæœªå®Œæˆçš„ Future æˆ– Task å°†åœ¨æŒ‡å®šç§’æ•°åè¢«è¿”å›ã€‚</p>
<p><em>return_when</em> æŒ‡å®šæ­¤å‡½æ•°åº”åœ¨ä½•æ—¶è¿”å›ã€‚å®ƒå¿…é¡»ä¸ºä»¥ä¸‹å¸¸æ•°ä¹‹ä¸€:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">å¸¸æ•°</th>
<th class="head">æè¿°</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">FIRST_COMPLETED</span></code></td>
<td>å‡½æ•°å°†åœ¨ä»»æ„å¯ç­‰å¾…å¯¹è±¡ç»“æŸæˆ–å–æ¶ˆæ—¶è¿”å›ã€‚</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">FIRST_EXCEPTION</span></code></td>
<td>å‡½æ•°å°†åœ¨ä»»æ„å¯ç­‰å¾…å¯¹è±¡å› å¼•å‘å¼‚å¸¸è€Œç»“æŸæ—¶è¿”å›ã€‚å½“æ²¡æœ‰å¼•å‘ä»»ä½•å¼‚å¸¸æ—¶å®ƒå°±ç›¸å½“äº <code class="xref py py-const docutils literal notranslate"><span class="pre">ALL_COMPLETED</span></code>ã€‚</td>
</tr>
<tr class="row-even"><td><code class="xref py py-const docutils literal notranslate"><span class="pre">ALL_COMPLETED</span></code></td>
<td>å‡½æ•°å°†åœ¨æ‰€æœ‰å¯ç­‰å¾…å¯¹è±¡ç»“æŸæˆ–å–æ¶ˆæ—¶è¿”å›ã€‚</td>
</tr>
</tbody>
</table>
<p>ä¸ <a class="reference internal" href="#asyncio.wait_for" title="asyncio.wait_for"><code class="xref py py-func docutils literal notranslate"><span class="pre">wait_for()</span></code></a> ä¸åŒï¼Œ<code class="docutils literal notranslate"><span class="pre">wait()</span></code> åœ¨è¶…æ—¶å‘ç”Ÿæ—¶ä¸ä¼šå–æ¶ˆå¯ç­‰å¾…å¯¹è±¡ã€‚</p>
<div class="admonition note" id="asyncio-example-wait-coroutine">
<p class="first admonition-title">æ³¨è§£</p>
<p><code class="docutils literal notranslate"><span class="pre">wait()</span></code> ä¼šè‡ªåŠ¨å°†åç¨‹ä½œä¸ºä»»åŠ¡åŠ å…¥æ—¥ç¨‹ï¼Œä»¥åå°†ä»¥ <code class="docutils literal notranslate"><span class="pre">(done,</span> <span class="pre">pending)</span></code> é›†åˆå½¢å¼è¿”å›æ˜¾å¼åˆ›å»ºçš„ä»»åŠ¡å¯¹è±¡ã€‚å› æ­¤ä»¥ä¸‹ä»£ç å¹¶ä¸ä¼šæœ‰é¢„æœŸçš„è¡Œä¸º:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">42</span>

<span class="n">coro</span> <span class="o">=</span> <span class="n">foo</span><span class="p">()</span>
<span class="n">done</span><span class="p">,</span> <span class="n">pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">({</span><span class="n">coro</span><span class="p">})</span>

<span class="k">if</span> <span class="n">coro</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
    <span class="c1"># This branch will never be run!</span>
</pre></div>
</div>
<p>ä»¥ä¸Šä»£ç æ®µçš„ä¿®æ­£æ–¹æ³•å¦‚ä¸‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">42</span>

<span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">foo</span><span class="p">())</span>
<span class="n">done</span><span class="p">,</span> <span class="n">pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">({</span><span class="n">task</span><span class="p">})</span>

<span class="k">if</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
    <span class="c1"># Everything will work as expected now.</span>
</pre></div>
</div>
<p class="last">ç›´æ¥å‘ <code class="docutils literal notranslate"><span class="pre">wait()</span></code> ä¼ å…¥åç¨‹å¯¹è±¡çš„æ–¹å¼å·²å¼ƒç”¨ã€‚</p>
</div>
</dd></dl>

<dl class="function">
<dt id="asyncio.as_completed">
<code class="descclassname">asyncio.</code><code class="descname">as_completed</code><span class="sig-paren">(</span><em>aws</em>, <em>*</em>, <em>loop=None</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.as_completed" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>&nbsp;å¹¶å‘åœ°è¿è¡Œ <em>aws</em> é›†åˆä¸­çš„ <a class="reference internal" href="#asyncio-awaitables"><span class="std std-ref">å¯ç­‰å¾…å¯¹è±¡</span></a>ã€‚è¿”å›ä¸€ä¸ª <a class="reference internal" href="asyncio-future.html#asyncio.Future" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future" title="asyncio.Future"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a> å¯¹è±¡çš„è¿­ä»£å™¨ã€‚è¿”å›çš„æ¯ä¸ª Future å¯¹è±¡ä»£è¡¨æ¥è‡ªå‰©ä½™å¯ç­‰å¾…å¯¹è±¡é›†åˆçš„æœ€æ—©ç»“æœã€‚</p>
<p>å¦‚æœåœ¨æ‰€æœ‰ Future å¯¹è±¡å®Œæˆå‰å‘ç”Ÿè¶…æ—¶åˆ™å°†å¼•å‘ <a class="reference internal" href="asyncio-exceptions.html#asyncio.TimeoutError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.TimeoutError" title="asyncio.TimeoutError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">asyncio.TimeoutError</span></code></a>ã€‚</p>
<p>ç¤ºä¾‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">aws</span><span class="p">):</span>
    <span class="n">earliest_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">f</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="scheduling-from-other-threads">
<h2><a class="toc-backref" href="#id11">æ¥è‡ªå…¶ä»–çº¿ç¨‹çš„æ—¥ç¨‹å®‰æ’</a><a class="headerlink" href="#scheduling-from-other-threads" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.run_coroutine_threadsafe">
<code class="descclassname">asyncio.</code><code class="descname">run_coroutine_threadsafe</code><span class="sig-paren">(</span><em>coro</em>, <em>loop</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.run_coroutine_threadsafe" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å‘æŒ‡å®šäº‹ä»¶å¾ªç¯æäº¤ä¸€ä¸ªåç¨‹ã€‚çº¿ç¨‹å®‰å…¨ã€‚</p>
<p>è¿”å›ä¸€ä¸ª <a class="reference internal" href="concurrent.futures.html#concurrent.futures.Future" tppabs="https://docs.python.org/zh-cn/3/library/concurrent.futures.html#concurrent.futures.Future" title="concurrent.futures.Future"><code class="xref py py-class docutils literal notranslate"><span class="pre">concurrent.futures.Future</span></code></a> ä»¥ç­‰å¾…æ¥è‡ªå…¶ä»– OS çº¿ç¨‹çš„ç»“æœã€‚</p>
<p>æ­¤å‡½æ•°åº”è¯¥ä»å¦ä¸€ä¸ª OS çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œè€Œéäº‹ä»¶å¾ªç¯è¿è¡Œæ‰€åœ¨çº¿ç¨‹ã€‚ç¤ºä¾‹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a coroutine</span>
<span class="n">coro</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Submit the coroutine to a given loop</span>
<span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run_coroutine_threadsafe</span><span class="p">(</span><span class="n">coro</span><span class="p">,</span> <span class="n">loop</span><span class="p">)</span>

<span class="c1"># Wait for the result with an optional timeout argument</span>
<span class="k">assert</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
<p>å¦‚æœåœ¨åç¨‹å†…äº§ç”Ÿäº†å¼‚å¸¸ï¼Œå°†ä¼šé€šçŸ¥è¿”å›çš„ Future å¯¹è±¡ã€‚å®ƒä¹Ÿå¯è¢«ç”¨æ¥å–æ¶ˆäº‹ä»¶å¾ªç¯ä¸­çš„ä»»åŠ¡:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The coroutine took too long, cancelling the task...&#39;</span><span class="p">)</span>
    <span class="n">future</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The coroutine raised an exception: </span><span class="si">{exc!r}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The coroutine returned: </span><span class="si">{result!r}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>æŸ¥çœ‹ <a class="reference internal" href="asyncio-dev.html#asyncio-multithreading" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-dev.html#asyncio-multithreading"><span class="std std-ref">å¹¶å‘å’Œå¤šçº¿ç¨‹</span></a> ç« èŠ‚çš„æ–‡æ¡£ã€‚</p>
<p>ä¸åŒä¸å…¶ä»– asyncio å‡½æ•°ï¼Œæ­¤å‡½æ•°è¦æ±‚æ˜¾å¼åœ°ä¼ å…¥ <em>loop</em> å‚æ•°ã€‚</p>
<div class="versionadded">
<p><span class="versionmodified">3.5.1 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="introspection">
<h2><a class="toc-backref" href="#id12">å†…çœ</a><a class="headerlink" href="#introspection" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="function">
<dt id="asyncio.current_task">
<code class="descclassname">asyncio.</code><code class="descname">current_task</code><span class="sig-paren">(</span><em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.current_task" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å›å½“å‰è¿è¡Œçš„ <a class="reference internal" href="#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡åˆ™è¿”å› <code class="docutils literal notranslate"><span class="pre">None</span></code>ã€‚</p>
<p>å¦‚æœ <em>loop</em> ä¸º <code class="docutils literal notranslate"><span class="pre">None</span></code> åˆ™ä¼šä½¿ç”¨ <a class="reference internal" href="asyncio-eventloop.html#asyncio.get_running_loop" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.get_running_loop" title="asyncio.get_running_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_running_loop()</span></code></a> è·å–å½“å‰äº‹ä»¶å¾ªç¯ã€‚</p>
<div class="versionadded">
<p><span class="versionmodified">3.7 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="asyncio.all_tasks">
<code class="descclassname">asyncio.</code><code class="descname">all_tasks</code><span class="sig-paren">(</span><em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.all_tasks" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å›äº‹ä»¶å¾ªç¯æ‰€è¿è¡Œçš„æœªå®Œæˆçš„ <a class="reference internal" href="#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> å¯¹è±¡çš„é›†åˆã€‚</p>
<p>å¦‚æœ <em>loop</em> ä¸º <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼Œåˆ™ä¼šä½¿ç”¨ <a class="reference internal" href="asyncio-eventloop.html#asyncio.get_running_loop" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.get_running_loop" title="asyncio.get_running_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_running_loop()</span></code></a> è·å–å½“å‰äº‹ä»¶å¾ªç¯ã€‚</p>
<div class="versionadded">
<p><span class="versionmodified">3.7 æ–°ç‰ˆåŠŸèƒ½.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="task-object">
<h2><a class="toc-backref" href="#id13">Task å¯¹è±¡</a><a class="headerlink" href="#task-object" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<dl class="class">
<dt id="asyncio.Task">
<em class="property">class </em><code class="descclassname">asyncio.</code><code class="descname">Task</code><span class="sig-paren">(</span><em>coro</em>, <em>*</em>, <em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>ä¸€ä¸ªä¸ <a class="reference internal" href="asyncio-future.html#asyncio.Future" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future" title="asyncio.Future"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span> <span class="pre">ç±»ä¼¼</span></code></a> çš„å¯¹è±¡ï¼Œå¯è¿è¡Œ Python <a class="reference internal" href="#coroutine"><span class="std std-ref">åç¨‹</span></a>ã€‚éçº¿ç¨‹å®‰å…¨ã€‚</p>
<p>Task å¯¹è±¡è¢«ç”¨æ¥åœ¨äº‹ä»¶å¾ªç¯ä¸­è¿è¡Œåç¨‹ã€‚å¦‚æœä¸€ä¸ªåç¨‹åœ¨ç­‰å¾…ä¸€ä¸ª Future å¯¹è±¡ï¼ŒTask å¯¹è±¡ä¼šæŒ‚èµ·è¯¥åç¨‹çš„æ‰§è¡Œå¹¶ç­‰å¾…è¯¥ Future å¯¹è±¡å®Œæˆã€‚å½“è¯¥ Future å¯¹è±¡ <em>å®Œæˆ</em>ï¼Œè¢«æ‰“åŒ…çš„åç¨‹å°†æ¢å¤æ‰§è¡Œã€‚</p>
<p>äº‹ä»¶å¾ªç¯ä½¿ç”¨ååŒæ—¥ç¨‹è°ƒåº¦: ä¸€ä¸ªäº‹ä»¶å¾ªç¯æ¯æ¬¡è¿è¡Œä¸€ä¸ª Task å¯¹è±¡ã€‚è€Œä¸€ä¸ª Task å¯¹è±¡ä¼šç­‰å¾…ä¸€ä¸ª Future å¯¹è±¡å®Œæˆï¼Œè¯¥äº‹ä»¶å¾ªç¯ä¼šè¿è¡Œå…¶ä»– Taskã€å›è°ƒæˆ–æ‰§è¡Œ IO æ“ä½œã€‚</p>
<p>ä½¿ç”¨é«˜å±‚çº§çš„ <a class="reference internal" href="#asyncio.create_task" title="asyncio.create_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.create_task()</span></code></a> å‡½æ•°æ¥åˆ›å»º Task å¯¹è±¡ï¼Œä¹Ÿå¯ç”¨ä½å±‚çº§çš„ <a class="reference internal" href="asyncio-eventloop.html#asyncio.loop.create_task" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.loop.create_task" title="asyncio.loop.create_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loop.create_task()</span></code></a> æˆ– <a class="reference internal" href="asyncio-future.html#asyncio.ensure_future" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.ensure_future" title="asyncio.ensure_future"><code class="xref py py-func docutils literal notranslate"><span class="pre">ensure_future()</span></code></a> å‡½æ•°ã€‚ä¸å»ºè®®æ‰‹åŠ¨å®ä¾‹åŒ– Task å¯¹è±¡ã€‚</p>
<p>è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ Task å¯¹è±¡å¯ä½¿ç”¨ <a class="reference internal" href="#asyncio.Task.cancel" title="asyncio.Task.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancel()</span></code></a> æ–¹æ³•ã€‚è°ƒç”¨æ­¤æ–¹æ³•å°†ä½¿è¯¥ Task å¯¹è±¡æŠ›å‡ºä¸€ä¸ª <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> å¼‚å¸¸ç»™æ‰“åŒ…çš„åç¨‹ã€‚å¦‚æœå–æ¶ˆæœŸé—´ä¸€ä¸ªåç¨‹æ­£åœ¨ç­‰å¾…ä¸€ä¸ª Future å¯¹è±¡ï¼Œè¯¥ Future å¯¹è±¡ä¹Ÿå°†è¢«å–æ¶ˆã€‚</p>
<p><a class="reference internal" href="#asyncio.Task.cancelled" title="asyncio.Task.cancelled"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancelled()</span></code></a> å¯è¢«ç”¨æ¥æ£€æµ‹ Task å¯¹è±¡æ˜¯å¦è¢«å–æ¶ˆã€‚å¦‚æœæ‰“åŒ…çš„åç¨‹æ²¡æœ‰æŠ‘åˆ¶ <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> å¼‚å¸¸å¹¶ä¸”ç¡®å®è¢«å–æ¶ˆï¼Œè¯¥æ–¹æ³•å°†è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
<p><a class="reference internal" href="#asyncio.Task" title="asyncio.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Task</span></code></a> ä» <a class="reference internal" href="asyncio-future.html#asyncio.Future" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future" title="asyncio.Future"><code class="xref py py-class docutils literal notranslate"><span class="pre">Future</span></code></a> ç»§æ‰¿äº†å…¶é™¤ <a class="reference internal" href="asyncio-future.html#asyncio.Future.set_result" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future.set_result" title="asyncio.Future.set_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Future.set_result()</span></code></a> å’Œ <a class="reference internal" href="asyncio-future.html#asyncio.Future.set_exception" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future.set_exception" title="asyncio.Future.set_exception"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Future.set_exception()</span></code></a> ä»¥å¤–çš„æ‰€æœ‰ APIã€‚</p>
<p>Task å¯¹è±¡æ”¯æŒ <a class="reference internal" href="contextvars.html#module-contextvars" tppabs="https://docs.python.org/zh-cn/3/library/contextvars.html#module-contextvars" title="contextvars: Context Variables"><code class="xref py py-mod docutils literal notranslate"><span class="pre">contextvars</span></code></a> æ¨¡å—ã€‚å½“ä¸€ä¸ª Task å¯¹è±¡è¢«åˆ›å»ºï¼Œå®ƒå°†å¤åˆ¶å½“å‰ä¸Šä¸‹æ–‡ï¼Œç„¶ååœ¨å¤åˆ¶çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œå…¶åç¨‹ã€‚</p>
<div class="versionchanged">
<p><span class="versionmodified">åœ¨ 3.7 ç‰ˆæ›´æ”¹: </span>åŠ å…¥å¯¹ <a class="reference internal" href="contextvars.html#module-contextvars" tppabs="https://docs.python.org/zh-cn/3/library/contextvars.html#module-contextvars" title="contextvars: Context Variables"><code class="xref py py-mod docutils literal notranslate"><span class="pre">contextvars</span></code></a> æ¨¡å—çš„æ”¯æŒã€‚</p>
</div>
<dl class="method">
<dt id="asyncio.Task.cancel">
<code class="descname">cancel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.cancel" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¯·æ±‚å–æ¶ˆ Task å¯¹è±¡ã€‚</p>
<p>è¿™å°†å®‰æ’åœ¨ä¸‹ä¸€è½®äº‹ä»¶å¾ªç¯ä¸­æŠ›å‡ºä¸€ä¸ª <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> å¼‚å¸¸ç»™è¢«å°åŒ…çš„åç¨‹ã€‚</p>
<p>åç¨‹åœ¨ä¹‹åæœ‰æœºä¼šè¿›è¡Œæ¸…ç†ç”šè‡³ä½¿ç”¨ <a class="reference internal" href="compound_stmts.html#try" tppabs="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#try"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">try</span></code></a> ... ... <code class="docutils literal notranslate"><span class="pre">except</span> <span class="pre">CancelledError</span></code> ... <a class="reference internal" href="compound_stmts.html#finally" tppabs="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#finally"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code></a> ä»£ç å—æŠ‘åˆ¶å¼‚å¸¸æ¥æ‹’ç»è¯·æ±‚ã€‚ä¸åŒäº <a class="reference internal" href="asyncio-future.html#asyncio.Future.cancel" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future.cancel" title="asyncio.Future.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Future.cancel()</span></code></a>ï¼Œ<a class="reference internal" href="#asyncio.Task.cancel" title="asyncio.Task.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Task.cancel()</span></code></a> ä¸ä¿è¯ Task ä¼šè¢«å–æ¶ˆï¼Œè™½ç„¶æŠ‘åˆ¶å®Œå…¨å–æ¶ˆå¹¶ä¸å¸¸è§ï¼Œä¹Ÿå¾ˆä¸é¼“åŠ±è¿™æ ·åšã€‚</p>
<p id="asyncio-example-task-cancel">ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†åç¨‹æ˜¯å¦‚ä½•ä¾¦å¬å–æ¶ˆè¯·æ±‚çš„:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">cancel_me</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cancel_me(): before sleep&#39;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Wait for 1 hour</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cancel_me(): cancel sleep&#39;</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cancel_me(): after sleep&#39;</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Create a &quot;cancel_me&quot; Task</span>
    <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">cancel_me</span><span class="p">())</span>

    <span class="c1"># Wait for 1 second</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">task</span>
    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;main(): cancel_me is cancelled now&quot;</span><span class="p">)</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>

<span class="c1"># Expected output:</span>
<span class="c1">#</span>
<span class="c1">#     cancel_me(): before sleep</span>
<span class="c1">#     cancel_me(): cancel sleep</span>
<span class="c1">#     cancel_me(): after sleep</span>
<span class="c1">#     main(): cancel_me is cancelled now</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.cancelled">
<code class="descname">cancelled</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.cancelled" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å¦‚æœ Task å¯¹è±¡ <em>è¢«å–æ¶ˆ</em> åˆ™è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
<p>å½“ä½¿ç”¨ <a class="reference internal" href="#asyncio.Task.cancel" title="asyncio.Task.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancel()</span></code></a> å‘å‡ºå–æ¶ˆè¯·æ±‚æ—¶ Task ä¼šè¢« <em>å–æ¶ˆ</em>ï¼Œå…¶å°åŒ…çš„åç¨‹å°†ä¼ æ’­è¢«æŠ›å…¥çš„ <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> å¼‚å¸¸ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.done">
<code class="descname">done</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.done" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å¦‚æœ Task å¯¹è±¡ <em>å·²å®Œæˆ</em> åˆ™è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
<p>å½“ Task æ‰€å°åŒ…çš„åç¨‹è¿”å›ä¸€ä¸ªå€¼ã€å¼•å‘ä¸€ä¸ªå¼‚å¸¸æˆ– Task æœ¬èº«è¢«å–æ¶ˆæ—¶ï¼Œåˆ™ä¼šè¢«è®¤ä¸º <em>å·²å®Œæˆ</em>ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.result">
<code class="descname">result</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.result" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å› Task çš„ç»“æœã€‚</p>
<p>å¦‚æœ Task å¯¹è±¡ <em>å·²å®Œæˆ</em>ï¼Œå…¶å°åŒ…çš„åç¨‹çš„ç»“æœä¼šè¢«è¿”å› (æˆ–è€…å½“åç¨‹å¼•å‘å¼‚å¸¸æ—¶ï¼Œè¯¥å¼‚å¸¸ä¼šè¢«é‡æ–°å¼•å‘ã€‚)</p>
<p>å¦‚æœ Task å¯¹è±¡ <em>è¢«å–æ¶ˆ</em>ï¼Œæ­¤æ–¹æ³•ä¼šå¼•å‘ä¸€ä¸ª <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> å¼‚å¸¸ã€‚</p>
<p>å¦‚æœ Task å¯¹è±¡çš„ç»“æœè¿˜ä¸å¯ç”¨ï¼Œæ­¤æ–¹æ³•ä¼šå¼•å‘ä¸€ä¸ª <a class="reference internal" href="asyncio-exceptions.html#asyncio.InvalidStateError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.InvalidStateError" title="asyncio.InvalidStateError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidStateError</span></code></a> å¼‚å¸¸ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.exception">
<code class="descname">exception</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.exception" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å› Task å¯¹è±¡çš„å¼‚å¸¸ã€‚</p>
<p>å¦‚æœæ‰€å°åŒ…çš„åç¨‹å¼•å‘äº†ä¸€ä¸ªå¼‚å¸¸ï¼Œè¯¥å¼‚å¸¸å°†è¢«è¿”å›ã€‚å¦‚æœæ‰€å°åŒ…çš„åç¨‹æ­£å¸¸è¿”å›åˆ™è¯¥æ–¹æ³•å°†è¿”å› <code class="docutils literal notranslate"><span class="pre">None</span></code>ã€‚</p>
<p>å¦‚æœ Task å¯¹è±¡ <em>è¢«å–æ¶ˆ</em>ï¼Œæ­¤æ–¹æ³•ä¼šå¼•å‘ä¸€ä¸ª <a class="reference internal" href="asyncio-exceptions.html#asyncio.CancelledError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> å¼‚å¸¸ã€‚</p>
<p>å¦‚æœ Task å¯¹è±¡å°šæœª <em>å®Œæˆ</em>ï¼Œæ­¤æ–¹æ³•å°†å¼•å‘ä¸€ä¸ª <a class="reference internal" href="asyncio-exceptions.html#asyncio.InvalidStateError" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-exceptions.html#asyncio.InvalidStateError" title="asyncio.InvalidStateError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidStateError</span></code></a> å¼‚å¸¸ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.add_done_callback">
<code class="descname">add_done_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>*</em>, <em>context=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.add_done_callback" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>æ·»åŠ ä¸€ä¸ªå›è°ƒï¼Œå°†åœ¨ Task å¯¹è±¡ <em>å®Œæˆ</em> æ—¶è¢«è¿è¡Œã€‚</p>
<p>æ­¤æ–¹æ³•åº”è¯¥ä»…åœ¨ä½å±‚çº§çš„åŸºäºå›è°ƒçš„ä»£ç ä¸­ä½¿ç”¨ã€‚</p>
<p>è¦äº†è§£æ›´å¤šç»†èŠ‚è¯·æŸ¥çœ‹ <a class="reference internal" href="asyncio-future.html#asyncio.Future.add_done_callback" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future.add_done_callback" title="asyncio.Future.add_done_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Future.add_done_callback()</span></code></a> çš„æ–‡æ¡£ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.remove_done_callback">
<code class="descname">remove_done_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.remove_done_callback" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>ä»å›è°ƒåˆ—è¡¨ä¸­ç§»é™¤ <em>callback</em> æŒ‡å®šçš„å›è°ƒã€‚</p>
<p>æ­¤æ–¹æ³•åº”è¯¥ä»…åœ¨ä½å±‚çº§çš„åŸºäºå›è°ƒçš„ä»£ç ä¸­ä½¿ç”¨ã€‚</p>
<p>è¦äº†è§£æ›´å¤šç»†èŠ‚è¯·æŸ¥çœ‹ <a class="reference internal" href="asyncio-future.html#asyncio.Future.remove_done_callback" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-future.html#asyncio.Future.remove_done_callback" title="asyncio.Future.remove_done_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Future.remove_done_callback()</span></code></a> çš„æ–‡æ¡£ã€‚</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.get_stack">
<code class="descname">get_stack</code><span class="sig-paren">(</span><em>*</em>, <em>limit=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.get_stack" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å›æ­¤ Task å¯¹è±¡çš„æ ˆæ¡†æ¶åˆ—è¡¨ã€‚</p>
<p>å¦‚æœæ‰€å°åŒ…çš„åç¨‹æœªå®Œæˆï¼Œè¿™å°†è¿”å›å…¶æŒ‚èµ·æ‰€åœ¨çš„æ ˆã€‚å¦‚æœåç¨‹å·²æˆåŠŸå®Œæˆæˆ–è¢«å–æ¶ˆï¼Œè¿™å°†è¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚å¦‚æœåç¨‹è¢«ä¸€ä¸ªå¼‚å¸¸ç»ˆæ­¢ï¼Œè¿™å°†è¿”å›å›æº¯æ¡†æ¶åˆ—è¡¨ã€‚</p>
<p>æ¡†æ¶æ€»æ˜¯ä»æŒ‰ä»æ—§åˆ°æ–°æ’åºã€‚</p>
<p>æ¯ä¸ªè¢«æŒ‚èµ·çš„åç¨‹åªè¿”å›ä¸€ä¸ªæ ˆæ¡†æ¶ã€‚</p>
<p>å¯é€‰çš„ <em>limit</em> å‚æ•°æŒ‡å®šè¿”å›æ¡†æ¶çš„æ•°é‡ä¸Šé™ï¼›é»˜è®¤è¿”å›æ‰€æœ‰æ¡†æ¶ã€‚è¿”å›åˆ—è¡¨çš„é¡ºåºè¦çœ‹æ˜¯è¿”å›ä¸€ä¸ªæ ˆè¿˜æ˜¯ä¸€ä¸ªå›æº¯ï¼šæ ˆè¿”å›æœ€æ–°çš„æ¡†æ¶ï¼Œå›æº¯è¿”å›æœ€æ—§çš„æ¡†æ¶ã€‚(è¿™ä¸ traceback æ¨¡å—çš„è¡Œä¸ºä¿æŒä¸€è‡´ã€‚)</p>
</dd></dl>

<dl class="method">
<dt id="asyncio.Task.print_stack">
<code class="descname">print_stack</code><span class="sig-paren">(</span><em>*</em>, <em>limit=None</em>, <em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.print_stack" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>æ‰“å°æ­¤ Task å¯¹è±¡çš„æ ˆæˆ–å›æº¯ã€‚</p>
<p>æ­¤æ–¹æ³•äº§ç”Ÿçš„è¾“å‡ºç±»ä¼¼äº traceback æ¨¡å—é€šè¿‡ <a class="reference internal" href="#asyncio.Task.get_stack" title="asyncio.Task.get_stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stack()</span></code></a> æ‰€è·å–çš„æ¡†æ¶ã€‚</p>
<p><em>limit</em> å‚æ•°ä¼šç›´æ¥ä¼ é€’ç»™ <a class="reference internal" href="#asyncio.Task.get_stack" title="asyncio.Task.get_stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_stack()</span></code></a>ã€‚</p>
<p><em>file</em> å‚æ•°æ˜¯è¾“å‡ºæ‰€å†™å…¥çš„ I/O æµï¼›é»˜è®¤æƒ…å†µä¸‹è¾“å‡ºä¼šå†™å…¥ <a class="reference internal" href="sys.html#sys.stderr" tppabs="https://docs.python.org/zh-cn/3/library/sys.html#sys.stderr" title="sys.stderr"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.stderr</span></code></a>ã€‚</p>
</dd></dl>

<dl class="classmethod">
<dt id="asyncio.Task.all_tasks">
<em class="property">classmethod </em><code class="descname">all_tasks</code><span class="sig-paren">(</span><em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.all_tasks" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å›ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­æ‰€æœ‰ä»»åŠ¡çš„é›†åˆã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹å°†è¿”å›å½“å‰äº‹ä»¶å¾ªç¯ä¸­æ‰€æœ‰ä»»åŠ¡ã€‚å¦‚æœ <em>loop</em> ä¸º <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼Œåˆ™ä¼šä½¿ç”¨ <a class="reference internal" href="asyncio-eventloop.html#asyncio.get_event_loop" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.get_event_loop" title="asyncio.get_event_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_event_loop()</span></code></a> å‡½æ•°æ¥è·å–å½“å‰äº‹ä»¶å¾ªç¯ã€‚</p>
<p>æ­¤æ–¹æ³• <strong>å·²å¼ƒç”¨</strong> å¹¶å°†åœ¨ Python 3.9 ä¸­ç§»é™¤ã€‚è¯·æ”¹ç”¨ <a class="reference internal" href="#asyncio.all_tasks" title="asyncio.all_tasks"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.all_tasks()</span></code></a> å‡½æ•°ã€‚</p>
</dd></dl>

<dl class="classmethod">
<dt id="asyncio.Task.current_task">
<em class="property">classmethod </em><code class="descname">current_task</code><span class="sig-paren">(</span><em>loop=None</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.Task.current_task" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>è¿”å›å½“å‰è¿è¡Œä»»åŠ¡æˆ– <code class="docutils literal notranslate"><span class="pre">None</span></code>ã€‚</p>
<p>å¦‚æœ <em>loop</em> ä¸º <code class="docutils literal notranslate"><span class="pre">None</span></code>ï¼Œåˆ™ä¼šä½¿ç”¨ <a class="reference internal" href="asyncio-eventloop.html#asyncio.get_event_loop" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-eventloop.html#asyncio.get_event_loop" title="asyncio.get_event_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_event_loop()</span></code></a> å‡½æ•°æ¥è·å–å½“å‰äº‹ä»¶å¾ªç¯ã€‚</p>
<p>æ­¤æ–¹æ³• <strong>å·²å¼ƒç”¨</strong> å¹¶å°†åœ¨ Python 3.9 ä¸­ç§»é™¤ã€‚è¯·æ”¹ç”¨ <a class="reference internal" href="#asyncio.current_task" title="asyncio.current_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.current_task()</span></code></a> å‡½æ•°ã€‚</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="generator-based-coroutines">
<span id="asyncio-generator-based-coro"></span><h2><a class="toc-backref" href="#id14">åŸºäºç”Ÿæˆå™¨çš„åç¨‹</a><a class="headerlink" href="#generator-based-coroutines" title="æ°¸ä¹…é“¾æ¥è‡³æ ‡é¢˜">Â¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">æ³¨è§£</p>
<p class="last">å¯¹åŸºäºç”Ÿæˆå™¨çš„åç¨‹çš„æ”¯æŒ <strong>å·²å¼ƒç”¨</strong> å¹¶è®¡åˆ’åœ¨ Python 3.10 ä¸­ç§»é™¤ã€‚</p>
</div>
<p>åŸºäºç”Ÿæˆå™¨çš„åç¨‹æ˜¯ async/await è¯­æ³•çš„å‰èº«ã€‚å®ƒä»¬æ˜¯ä½¿ç”¨ <code class="docutils literal notranslate"><span class="pre">yield</span> <span class="pre">from</span></code> è¯­å¥åˆ›å»ºçš„ Python ç”Ÿæˆå™¨ï¼Œå¯ä»¥ç­‰å¾… Future å’Œå…¶ä»–åç¨‹ã€‚</p>
<p>åŸºäºç”Ÿæˆå™¨çš„åç¨‹åº”è¯¥ä½¿ç”¨ <a class="reference internal" href="#asyncio.coroutine" title="asyncio.coroutine"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;asyncio.coroutine</span></code></a> è£…é¥°ï¼Œè™½ç„¶è¿™å¹¶éå¼ºåˆ¶ã€‚</p>
<dl class="function">
<dt id="asyncio.coroutine">
<code class="descclassname">&#64;</code><code class="descclassname">asyncio.</code><code class="descname">coroutine</code><a class="headerlink" href="#asyncio.coroutine" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>ç”¨æ¥æ ‡è®°åŸºäºç”Ÿæˆå™¨çš„åç¨‹çš„è£…é¥°å™¨ã€‚</p>
<p>æ­¤è£…é¥°å™¨ä½¿å¾—æ—§å¼çš„åŸºäºç”Ÿæˆå™¨çš„åç¨‹èƒ½ä¸ async/await ä»£ç ç›¸å…¼å®¹:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@asyncio</span><span class="o">.</span><span class="n">coroutine</span>
<span class="k">def</span> <span class="nf">old_style_coroutine</span><span class="p">():</span>
    <span class="k">yield from</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">old_style_coroutine</span><span class="p">()</span>
</pre></div>
</div>
<p>æ­¤è£…é¥°å™¨ <strong>å·²å¼ƒç”¨</strong> å¹¶è®¡åˆ’è§‰å¾— Python 3.10 ä¸­ç§»é™¤ã€‚</p>
<p>æ­¤è£…é¥°å™¨ä¸åº”è¯¥è¢«ç”¨äº <a class="reference internal" href="compound_stmts.html#async-def" tppabs="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#async-def"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code></a> åç¨‹ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="asyncio.iscoroutine">
<code class="descclassname">asyncio.</code><code class="descname">iscoroutine</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.iscoroutine" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å¦‚æœ <em>obj</em> æ˜¯ä¸€ä¸ª <a class="reference internal" href="#coroutine"><span class="std std-ref">åç¨‹å¯¹è±¡</span></a> åˆ™è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
<p>æ­¤æ–¹æ³•ä¸åŒäº <a class="reference internal" href="inspect.html#inspect.iscoroutine" tppabs="https://docs.python.org/zh-cn/3/library/inspect.html#inspect.iscoroutine" title="inspect.iscoroutine"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.iscoroutine()</span></code></a> å› ä¸ºå®ƒå¯¹åŸºäºç”Ÿæˆå™¨çš„åç¨‹è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
</dd></dl>

<dl class="function">
<dt id="asyncio.iscoroutinefunction">
<code class="descclassname">asyncio.</code><code class="descname">iscoroutinefunction</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#asyncio.iscoroutinefunction" title="æ°¸ä¹…é“¾æ¥è‡³ç›®æ ‡">Â¶</a></dt>
<dd><p>å¦‚æœ <em>func</em> æ˜¯ä¸€ä¸ª <a class="reference internal" href="#coroutine"><span class="std std-ref">åç¨‹å‡½æ•°</span></a> åˆ™è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
<p>æ­¤æ–¹æ³•ä¸åŒäº <a class="reference internal" href="inspect.html#inspect.iscoroutinefunction" tppabs="https://docs.python.org/zh-cn/3/library/inspect.html#inspect.iscoroutinefunction" title="inspect.iscoroutinefunction"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.iscoroutinefunction()</span></code></a> å› ä¸ºå®ƒå¯¹ä»¥ <a class="reference internal" href="#asyncio.coroutine" title="asyncio.coroutine"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;coroutine</span></code></a> è£…é¥°çš„åŸºäºç”Ÿæˆå™¨çš„åç¨‹å‡½æ•°è¿”å› <code class="docutils literal notranslate"><span class="pre">True</span></code>ã€‚</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html" tppabs="https://docs.python.org/zh-cn/3/contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">åç¨‹ä¸ä»»åŠ¡</a><ul>
<li><a class="reference internal" href="#coroutines">åç¨‹</a></li>
<li><a class="reference internal" href="#awaitables">å¯ç­‰å¾…å¯¹è±¡</a></li>
<li><a class="reference internal" href="#running-an-asyncio-program">è¿è¡Œ asyncio ç¨‹åº</a></li>
<li><a class="reference internal" href="#creating-tasks">åˆ›å»ºä»»åŠ¡</a></li>
<li><a class="reference internal" href="#sleeping">ä¼‘çœ </a></li>
<li><a class="reference internal" href="#running-tasks-concurrently">å¹¶å‘è¿è¡Œä»»åŠ¡</a></li>
<li><a class="reference internal" href="#shielding-from-cancellation">å±è”½å–æ¶ˆæ“ä½œ</a></li>
<li><a class="reference internal" href="#timeouts">è¶…æ—¶</a></li>
<li><a class="reference internal" href="#waiting-primitives">ç®€å•ç­‰å¾…</a></li>
<li><a class="reference internal" href="#scheduling-from-other-threads">æ¥è‡ªå…¶ä»–çº¿ç¨‹çš„æ—¥ç¨‹å®‰æ’</a></li>
<li><a class="reference internal" href="#introspection">å†…çœ</a></li>
<li><a class="reference internal" href="#task-object">Task å¯¹è±¡</a></li>
<li><a class="reference internal" href="#generator-based-coroutines">åŸºäºç”Ÿæˆå™¨çš„åç¨‹</a></li>
</ul>
</li>
</ul>

  <h4>ä¸Šä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="asyncio.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio.html"
                        title="ä¸Šä¸€ç« "><code class="docutils literal notranslate"><span class="pre">asyncio</span></code> --- å¼‚æ­¥ I/O</a></p>
  <h4>ä¸‹ä¸€ä¸ªä¸»é¢˜</h4>
  <p class="topless"><a href="asyncio-stream.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-stream.html"
                        title="ä¸‹ä¸€ç« ">æµ</a></p>
  <div role="note" aria-label="source link">
    <h3>æœ¬é¡µ</h3>
    <ul class="this-page-menu">
      <li><a href="bugs.html" tppabs="https://docs.python.org/zh-cn/3/bugs.html">æäº¤ Bug</a></li>
      <li>
        <a href="javascript:if(confirm('https://github.com/python/cpython/blob/3.7/Doc/library/asyncio-task.rst  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/python/cpython/blob/3.7/Doc/library/asyncio-task.rst'" tppabs="https://github.com/python/cpython/blob/3.7/Doc/library/asyncio-task.rst"
            rel="nofollow">æ˜¾ç¤ºæºä»£ç 
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>å¯¼èˆª</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" tppabs="https://docs.python.org/zh-cn/3/genindex.html" title="æ€»ç›®å½•"
             >ç´¢å¼•</a></li>
        <li class="right" >
          <a href="py-modindex.html" tppabs="https://docs.python.org/zh-cn/3/py-modindex.html" title="Python æ¨¡å—ç´¢å¼•"
             >æ¨¡å—</a> |</li>
        <li class="right" >
          <a href="asyncio-stream.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio-stream.html" title="æµ"
             >ä¸‹ä¸€é¡µ</a> |</li>
        <li class="right" >
          <a href="asyncio.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio.html" title="asyncio --- å¼‚æ­¥ I/O"
             >ä¸Šä¸€é¡µ</a> |</li>
        <li><img src="py.png" tppabs="https://docs.python.org/zh-cn/3/_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="javascript:if(confirm('https://www.python.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/'" tppabs="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="language_switcher_placeholder">zh_CN</span>
          <span class="version_switcher_placeholder">3.7.3</span>
          <a href="index-11.html" tppabs="https://docs.python.org/zh-cn/3/index.html">æ–‡æ¡£</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index-2.html" tppabs="https://docs.python.org/zh-cn/3/library/index.html" >Python æ ‡å‡†åº“</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ipc.html" tppabs="https://docs.python.org/zh-cn/3/library/ipc.html" >ç½‘ç»œå’Œè¿›ç¨‹é—´é€šä¿¡</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="asyncio.html" tppabs="https://docs.python.org/zh-cn/3/library/asyncio.html" ><code class="docutils literal notranslate"><span class="pre">asyncio</span></code> --- å¼‚æ­¥ I/O</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="https://docs.python.org/zh-cn/3/search.html" method="get">
          <input placeholder="å¿«é€Ÿæœç´¢" type="text" name="q" />
          <input type="submit" value="è½¬å‘" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="copyright.html" tppabs="https://docs.python.org/zh-cn/3/copyright.html">ç‰ˆæƒæ‰€æœ‰</a> 2001-2019, Python Software Foundation.
    <br />
    Python è½¯ä»¶åŸºé‡‘ä¼šæ˜¯ä¸€ä¸ªéç›ˆåˆ©ç»„ç»‡ã€‚
    <a href="javascript:if(confirm('https://www.python.org/psf/donations/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.python.org/psf/donations/'" tppabs="https://www.python.org/psf/donations/">è¯·æåŠ©ã€‚</a>
    <br />
    æœ€åæ›´æ–°äº 4æœˆ 22, 2019.
    <a href="bugs.html" tppabs="https://docs.python.org/zh-cn/3/bugs.html">å‘ç°äº†é—®é¢˜</a>ï¼Ÿ
    <br />
    ä½¿ç”¨<a href="javascript:if(confirm('http://sphinx.pocoo.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://sphinx.pocoo.org/'" tppabs="http://sphinx.pocoo.org/">Sphinx</a>1.8.4 åˆ›å»ºã€‚
    </div>

  </body>
</html>